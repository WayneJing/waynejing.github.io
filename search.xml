<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Cancel delayed_work/workqueue 的方式</title>
    <url>/2021/01/17/the-fini-sequence-of-delayed-work/</url>
    <content><![CDATA[<h1 id="Cancel-delayed-work-workqueue-的方式"><a href="#Cancel-delayed-work-workqueue-的方式" class="headerlink" title="Cancel delayed_work/workqueue 的方式"></a>Cancel delayed_work/workqueue 的方式</h1><blockquote>
<p>如果要取消某个挂起的工作队列入口项，可以调用：<br>  <code>bool cancel_delay_work(struct work_struct *work)</code><br>如果该入口项在开始执行前被取消，则上述函数返回<code>false</code>。在调用<code>cancel_delayed_work</code>之后，内核会确保不会初始化给定入口项的执行。但是如果<code>cancel_delayed_work</code>返回<code>true</code>，则说明该入口项已经在其他处理器上运行，因此在<code>cancel_delayed_work</code>返回后可能仍然在运行。为了绝对确保在<code>cancel_delayed_work</code>返回<code>true</code>之后，工作函数不会在系统中的任何地方运行，应该随后调用下面的函数：<br><code>void flush_workqueue(struct workqueue_struct *wq);</code><br>在<code>flush_workqueue</code>返回后，任何在该调用之前被提交的工作函数都不会在系统任何地方运行<br>——《Linux 设备驱动程序》</p>
</blockquote>
<p>以上叙述针对<code>delayed_work</code>也有类似的函数<code>flush_delayed_work</code>。</p>
<a id="more"></a>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>在AMD的gpu驱动中，关于sriov下vf2pf下的msg exchange函数就是使用的<code>delayed_work</code>进行数据交换。但是在进行 workqueue fini时，当前的代码使用了这种方式进行cancel：<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">amdgpu_virt_fini_data_exchange</span><span class="params">(struct amdgpu_device *adev)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (adev-&gt;virt.vf2pf_update_interval_ms != <span class="number">0</span>) &#123;</span><br><span class="line">		DRM_INFO(<span class="string">"clean up the vf2pf work item\n"</span>);</span><br><span class="line">		flush_delayed_work(&amp;adev-&gt;virt.vf2pf_work);</span><br><span class="line">		cancel_delayed_work_sync(&amp;adev-&gt;virt.vf2pf_work);</span><br><span class="line">		adev-&gt;virt.vf2pf_update_interval_ms = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>仔细观察就会发现，这里的<code>flush</code>和<code>cancel</code>的调用与上述书中描述并不相符。那么到底是谁错了？</p>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>对于Linux的调用问题当然需要进行源码的分析才能得到最准确的答案。</p>
<h2 id="flush-delayed-work"><a href="#flush-delayed-work" class="headerlink" title="flush_delayed_work"></a><code>flush_delayed_work</code></h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * flush_delayed_work - wait for a dwork to finish executing the last queueing</span></span><br><span class="line"><span class="comment"> * @dwork: the delayed work to flush</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Delayed timer is cancelled and the pending work is queued for</span></span><br><span class="line"><span class="comment"> * immediate execution.  Like flush_work(), this function only</span></span><br><span class="line"><span class="comment"> * considers the last queueing instance of @dwork.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Return:</span></span><br><span class="line"><span class="comment"> * %true if flush_work() waited for the work to finish execution,</span></span><br><span class="line"><span class="comment"> * %false if it was already idle.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">flush_delayed_work</span><span class="params">(struct delayed_work *dwork)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	local_irq_disable();</span><br><span class="line">	<span class="keyword">if</span> (del_timer_sync(&amp;dwork-&gt;timer))</span><br><span class="line">		__queue_work(dwork-&gt;cpu, dwork-&gt;wq, &amp;dwork-&gt;work);</span><br><span class="line">	local_irq_enable();</span><br><span class="line">	<span class="keyword">return</span> flush_work(&amp;dwork-&gt;work);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(flush_delayed_work);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> __flush_work(struct work_struct *work, <span class="keyword">bool</span> from_cancel)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">wq_barrier</span> <span class="title">barr</span>;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (WARN_ON(!wq_online))</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (WARN_ON(!work-&gt;func))</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!from_cancel) &#123;</span><br><span class="line">		lock_map_acquire(&amp;work-&gt;lockdep_map);</span><br><span class="line">		lock_map_release(&amp;work-&gt;lockdep_map);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (start_flush_work(work, &amp;barr, from_cancel)) &#123;</span><br><span class="line">		wait_for_completion(&amp;barr.done);</span><br><span class="line">		destroy_work_on_stack(&amp;barr.work);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">start_flush_work</span><span class="params">(struct work_struct *work, struct wq_barrier *barr,</span></span></span><br><span class="line"><span class="function"><span class="params">			     <span class="keyword">bool</span> from_cancel)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">worker</span> *<span class="title">worker</span> = <span class="title">NULL</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">worker_pool</span> *<span class="title">pool</span>;</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">pool_workqueue</span> *<span class="title">pwq</span>;</span></span><br><span class="line"></span><br><span class="line">	might_sleep();</span><br><span class="line"></span><br><span class="line">	rcu_read_lock();</span><br><span class="line">	pool = get_work_pool(work);</span><br><span class="line">	<span class="keyword">if</span> (!pool) &#123;</span><br><span class="line">		rcu_read_unlock();</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	raw_spin_lock_irq(&amp;pool-&gt;lock);</span><br><span class="line">	<span class="comment">/* see the comment in try_to_grab_pending() with the same code */</span></span><br><span class="line">	pwq = get_work_pwq(work);</span><br><span class="line">	<span class="keyword">if</span> (pwq) &#123;</span><br><span class="line">		<span class="keyword">if</span> (unlikely(pwq-&gt;pool != pool))</span><br><span class="line">			<span class="keyword">goto</span> already_gone;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		worker = find_worker_executing_work(pool, work);</span><br><span class="line">		<span class="keyword">if</span> (!worker)</span><br><span class="line">			<span class="keyword">goto</span> already_gone;</span><br><span class="line">		pwq = worker-&gt;current_pwq;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	check_flush_dependency(pwq-&gt;wq, work);</span><br><span class="line"></span><br><span class="line">	insert_wq_barrier(pwq, barr, work, worker);</span><br><span class="line">	raw_spin_unlock_irq(&amp;pool-&gt;lock);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Force a lock recursion deadlock when using flush_work() inside a</span></span><br><span class="line"><span class="comment">	 * single-threaded or rescuer equipped workqueue.</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * For single threaded workqueues the deadlock happens when the work</span></span><br><span class="line"><span class="comment">	 * is after the work issuing the flush_work(). For rescuer equipped</span></span><br><span class="line"><span class="comment">	 * workqueues the deadlock happens when the rescuer stalls, blocking</span></span><br><span class="line"><span class="comment">	 * forward progress.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">if</span> (!from_cancel &amp;&amp;</span><br><span class="line">	    (pwq-&gt;wq-&gt;saved_max_active == <span class="number">1</span> || pwq-&gt;wq-&gt;rescuer)) &#123;</span><br><span class="line">		lock_map_acquire(&amp;pwq-&gt;wq-&gt;lockdep_map);</span><br><span class="line">		lock_map_release(&amp;pwq-&gt;wq-&gt;lockdep_map);</span><br><span class="line">	&#125;</span><br><span class="line">	rcu_read_unlock();</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">already_gone:</span><br><span class="line">	raw_spin_unlock_irq(&amp;pool-&gt;lock);</span><br><span class="line">	rcu_read_unlock();</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到<code>flush_delayed_work</code>这个函数实际上是只针对某一个特定的<code>delayed_work</code>,在这个<code>delayed_work</code>之后建立barrier，<strong>等待这个特定的<code>delayed_work</code>执行完之后</strong>，将这个barrier销毁。注释中的这句话也证明了这个现象 <strong>_Delayed timer is cancelled and the pending work is queued for immediate execution._</strong></p>
<h2 id="cancel-delayed-work-sync"><a href="#cancel-delayed-work-sync" class="headerlink" title="cancel_delayed_work_sync"></a><code>cancel_delayed_work_sync</code></h2><p>需要注意的是，驱动中调用的是<code>cancel_delayed_work_sync</code>，这个函数是<code>cancel_delayed_work</code>的SMP版本，调用该函数可以避免在SMP系统中的竞态。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * cancel_delayed_work_sync - cancel a delayed work and wait for it to finish</span></span><br><span class="line"><span class="comment"> * @dwork: the delayed work cancel</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This is cancel_work_sync() for delayed works.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Return:</span></span><br><span class="line"><span class="comment"> * %true if @dwork was pending, %false otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cancel_delayed_work_sync</span><span class="params">(struct delayed_work *dwork)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> __cancel_work_timer(&amp;dwork-&gt;work, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">EXPORT_SYMBOL(cancel_delayed_work_sync);</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">bool</span> __cancel_work_timer(struct work_struct *work, <span class="keyword">bool</span> is_dwork)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="title">DECLARE_WAIT_QUEUE_HEAD</span><span class="params">(cancel_waitq)</span></span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> flags;</span><br><span class="line">	<span class="keyword">int</span> ret;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		ret = try_to_grab_pending(work, is_dwork, &amp;flags);</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * If someone else is already canceling, wait for it to</span></span><br><span class="line"><span class="comment">		 * finish.  flush_work() doesn't work for PREEMPT_NONE</span></span><br><span class="line"><span class="comment">		 * because we may get scheduled between @work's completion</span></span><br><span class="line"><span class="comment">		 * and the other canceling task resuming and clearing</span></span><br><span class="line"><span class="comment">		 * CANCELING - flush_work() will return false immediately</span></span><br><span class="line"><span class="comment">		 * as @work is no longer busy, try_to_grab_pending() will</span></span><br><span class="line"><span class="comment">		 * return -ENOENT as @work is still being canceled and the</span></span><br><span class="line"><span class="comment">		 * other canceling task won't be able to clear CANCELING as</span></span><br><span class="line"><span class="comment">		 * we're hogging the CPU.</span></span><br><span class="line"><span class="comment">		 *</span></span><br><span class="line"><span class="comment">		 * Let's wait for completion using a waitqueue.  As this</span></span><br><span class="line"><span class="comment">		 * may lead to the thundering herd problem, use a custom</span></span><br><span class="line"><span class="comment">		 * wake function which matches @work along with exclusive</span></span><br><span class="line"><span class="comment">		 * wait and wakeup.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="keyword">if</span> (unlikely(ret == -ENOENT)) &#123;</span><br><span class="line">			<span class="class"><span class="keyword">struct</span> <span class="title">cwt_wait</span> <span class="title">cwait</span>;</span></span><br><span class="line"></span><br><span class="line">			init_wait(&amp;cwait.wait);</span><br><span class="line">			cwait.wait.func = cwt_wakefn;</span><br><span class="line">			cwait.work = work;</span><br><span class="line"></span><br><span class="line">			prepare_to_wait_exclusive(&amp;cancel_waitq, &amp;cwait.wait,</span><br><span class="line">						  TASK_UNINTERRUPTIBLE);</span><br><span class="line">			<span class="keyword">if</span> (work_is_canceling(work))</span><br><span class="line">				schedule();</span><br><span class="line">			finish_wait(&amp;cancel_waitq, &amp;cwait.wait);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (unlikely(ret &lt; <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* tell other tasks trying to grab @work to back off */</span></span><br><span class="line">	mark_work_canceling(work);</span><br><span class="line">	local_irq_restore(flags);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * This allows canceling during early boot.  We know that @work</span></span><br><span class="line"><span class="comment">	 * isn't executing.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">if</span> (wq_online)</span><br><span class="line">		__flush_work(work, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">	clear_work_data(work);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * Paired with prepare_to_wait() above so that either</span></span><br><span class="line"><span class="comment">	 * waitqueue_active() is visible here or !work_is_canceling() is</span></span><br><span class="line"><span class="comment">	 * visible there.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	smp_mb();</span><br><span class="line">	<span class="keyword">if</span> (waitqueue_active(&amp;cancel_waitq))</span><br><span class="line">		__wake_up(&amp;cancel_waitq, TASK_NORMAL, <span class="number">1</span>, work);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>cancel_delayed_work_sync</code>会等待当前正在执行的dwork执行完，然后取消入口项。如果当前的dwork还没有开始执行，那么入口项会直接被取消。</p>
<p>如果仔细观察就会发现，<code>cancel_delayed_work_sync</code>的实现里，调用了<code>flush_delayed_work</code>的核心函数<code>__flush_work</code>。换言之，实际上如果调用了<code>cancel_delayed_work_sync</code>，那么根本没有必要调用<code>flush_delayed_work</code>。</p>
<h2 id="假设情景"><a href="#假设情景" class="headerlink" title="假设情景"></a>假设情景</h2><p>假设有这么一个sequence发生在amdgpu的驱动中：</p>
<ol>
<li>scheduled delayed_work 1</li>
<li>flush delayed_work 1</li>
<li>executing delayed_work 1</li>
<li>scheduled delayed_work 2 comes</li>
<li><code>cancel_delayed_work_sync</code></li>
<li>then we need to wait for work2 finish </li>
</ol>
<h2 id="进行试验"><a href="#进行试验" class="headerlink" title="进行试验"></a>进行试验</h2><p>设计如下的一个driver</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/kernel.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/module.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/workqueue.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/delay.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">delayed_work</span> <span class="title">dwork</span>;</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> intervals;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> update_version;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">update_work_item</span><span class="params">(struct work_struct *work)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">        printk(KERN_INFO<span class="string">"update_version%5d update work item!!!    %3d\n"</span>, update_version, i);</span><br><span class="line">        msleep(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    schedule_delayed_work(&amp;dwork, intervals);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">my_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    intervals = HZ * <span class="number">5</span>;</span><br><span class="line">    update_version = <span class="number">0</span>;</span><br><span class="line">    INIT_DELAYED_WORK(&amp;dwork, update_work_item);</span><br><span class="line">    schedule_delayed_work(&amp;dwork, intervals);</span><br><span class="line">    printk(KERN_ALERT<span class="string">"work_queue init!!!!!\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">my_exit</span><span class="params">(<span class="keyword">void</span>)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    printk(KERN_ALERT<span class="string">"work_queue begin fini!!!!\n"</span>);</span><br><span class="line">    flush_delayed_work(&amp;dwork);</span><br><span class="line">    printk(KERN_ALERT<span class="string">"work_queue flushed!!!!\n"</span>);</span><br><span class="line">    cancel_delayed_work_sync(&amp;dwork);</span><br><span class="line">    printk(KERN_ALERT<span class="string">"work_queue canceled!!!!\n"</span>);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(my_init);</span><br><span class="line">module_exit(my_exit);</span><br><span class="line">MODULE_LICENSE(<span class="string">"Dual BSD/GPL"</span>);</span><br></pre></td></tr></table></figure>
<p>在work1正在打印时进行rmmod 如果时间凑得比较巧的话就会发生如下的log<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ 1681.460409] update_version    2 update work item!!!      0</span><br><span class="line">[ 1681.662153] update_version    2 update work item!!!      1</span><br><span class="line">[ 1682.179297] update_version    2 update work item!!!      2</span><br><span class="line">[ 1682.192980] update_version    2 update work item!!!      3</span><br><span class="line">[ 1682.665238] update_version    2 update work item!!!      4</span><br><span class="line">[ 1682.675861] update_version    2 update work item!!!      5</span><br><span class="line">[ 1682.687036] update_version    2 update work item!!!      6</span><br><span class="line">[ 1683.297525] work_queue begin fini!!!!</span><br><span class="line">[ 1683.309039] update_version    2 update work item!!!      7</span><br><span class="line">[ 1683.317525] update_version    2 update work item!!!      8</span><br><span class="line">[ 1683.330366] update_version    2 update work item!!!      9</span><br><span class="line">[ 1683.342996] update_version    2 update work item!!!     10</span><br><span class="line">[ 1683.355637] update_version    2 update work item!!!     11</span><br><span class="line">[ 1683.370368] update_version    2 update work item!!!     12</span><br><span class="line">[ 1683.382550] update_version    2 update work item!!!     13</span><br><span class="line">[ 1683.403561] update_version    2 update work item!!!     14</span><br><span class="line">[ 1683.418361] update_version    2 update work item!!!     15</span><br><span class="line">[ 1683.434646] update_version    2 update work item!!!     16</span><br><span class="line">[ 1683.454569] update_version    2 update work item!!!     17</span><br><span class="line">[ 1683.470760] update_version    2 update work item!!!     18</span><br><span class="line">[ 1683.486546] update_version    2 update work item!!!     19</span><br><span class="line">[ 1683.506470] update_version    2 update work item!!!     20</span><br><span class="line">[ 1683.519805] update_version    2 update work item!!!     21</span><br><span class="line">[ 1683.532837] update_version    2 update work item!!!     22</span><br><span class="line">[ 1683.542477] update_version    2 update work item!!!     23</span><br><span class="line">[ 1683.557055] update_version    2 update work item!!!     24</span><br><span class="line">[ 1683.570399] update_version    2 update work item!!!     25</span><br><span class="line">[ 1683.586637] update_version    2 update work item!!!     26</span><br><span class="line">[ 1683.602621] update_version    2 update work item!!!     27</span><br><span class="line">[ 1683.618420] update_version    2 update work item!!!     28</span><br><span class="line">[ 1683.634964] update_version    2 update work item!!!     29</span><br><span class="line">[ 1683.651355] update_version    3 update work item!!!      0</span><br><span class="line">[ 1683.663034] update_version    3 update work item!!!      1</span><br><span class="line">[ 1683.678812] update_version    3 update work item!!!      2</span><br><span class="line">[ 1683.692626] update_version    3 update work item!!!      3</span><br><span class="line">[ 1683.702821] update_version    3 update work item!!!      4</span><br><span class="line">[ 1683.715269] update_version    3 update work item!!!      5</span><br><span class="line">[ 1683.730778] update_version    3 update work item!!!      6</span><br><span class="line">[ 1683.747764] update_version    3 update work item!!!      7</span><br><span class="line">[ 1683.758886] update_version    3 update work item!!!      8</span><br><span class="line">[ 1683.774456] update_version    3 update work item!!!      9</span><br><span class="line">[ 1683.791569] update_version    3 update work item!!!     10</span><br><span class="line">[ 1683.802760] update_version    3 update work item!!!     11</span><br><span class="line">[ 1683.814678] update_version    3 update work item!!!     12</span><br><span class="line">[ 1683.830531] update_version    3 update work item!!!     13</span><br><span class="line">[ 1683.842828] update_version    3 update work item!!!     14</span><br><span class="line">[ 1683.858634] update_version    3 update work item!!!     15</span><br><span class="line">[ 1683.874375] update_version    3 update work item!!!     16</span><br><span class="line">[ 1683.891675] update_version    3 update work item!!!     17</span><br><span class="line">[ 1683.902424] update_version    3 update work item!!!     18</span><br><span class="line">[ 1683.916684] update_version    3 update work item!!!     19</span><br><span class="line">[ 1683.930727] update_version    3 update work item!!!     20</span><br><span class="line">[ 1683.942557] update_version    3 update work item!!!     21</span><br><span class="line">[ 1683.959058] update_version    3 update work item!!!     22</span><br><span class="line">[ 1683.970771] update_version    3 update work item!!!     23</span><br><span class="line">[ 1683.988803] update_version    3 update work item!!!     24</span><br><span class="line">[ 1684.003104] update_version    3 update work item!!!     25</span><br><span class="line">[ 1684.018604] update_version    3 update work item!!!     26</span><br><span class="line">[ 1684.036343] update_version    3 update work item!!!     27</span><br><span class="line">[ 1684.046610] update_version    3 update work item!!!     28</span><br><span class="line">[ 1684.062785] update_version    3 update work item!!!     29</span><br><span class="line">[ 1684.088484] work_queue flushed!!!!</span><br><span class="line">[ 1684.088589] work_queue canceled!!!!</span><br><span class="line">[ 1744.604919] work_queue init!!!!!</span><br></pre></td></tr></table></figure><br>注意到确实work1执行完之后work2在cancel之前就到了，又把work2执行完才能cancel，这无疑会有多余的时间花费在cancel上。</p>
<p>在guest vm中，如果host gpu触发了whole gpu reset时，这种消耗有可能变得很致命。</p>
<p>如果只调用 <code>cancel_delayed_work_sync</code>，那么就会发现只等待work1执行完就可以完全销毁。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ 1946.564262] update_version    0 update work item!!!      0</span><br><span class="line">[ 1946.576020] update_version    1 update work item!!!      1</span><br><span class="line">[ 1946.880125] update_version    2 update work item!!!      2</span><br><span class="line">[ 1946.895878] update_version    3 update work item!!!      3</span><br><span class="line">[ 1946.927176] update_version    4 update work item!!!      4</span><br><span class="line">[ 1946.944666] update_version    5 update work item!!!      5</span><br><span class="line">[ 1946.956052] update_version    6 update work item!!!      6</span><br><span class="line">[ 1946.961105] work_queue begin fini!!!!</span><br><span class="line">[ 1946.985164] update_version    7 update work item!!!      7</span><br><span class="line">[ 1946.998127] update_version    8 update work item!!!      8</span><br><span class="line">[ 1947.010452] update_version    9 update work item!!!      9</span><br><span class="line">[ 1947.880710] update_version   10 update work item!!!     10</span><br><span class="line">[ 1947.896974] update_version   11 update work item!!!     11</span><br><span class="line">[ 1948.394127] update_version   12 update work item!!!     12</span><br><span class="line">[ 1948.405597] update_version   13 update work item!!!     13</span><br><span class="line">[ 1949.882196] update_version   14 update work item!!!     14</span><br><span class="line">[ 1949.892046] update_version   15 update work item!!!     15</span><br><span class="line">[ 1950.614236] update_version   16 update work item!!!     16</span><br><span class="line">[ 1950.628786] update_version   17 update work item!!!     17</span><br><span class="line">[ 1950.639795] update_version   18 update work item!!!     18</span><br><span class="line">[ 1950.652611] update_version   19 update work item!!!     19</span><br><span class="line">[ 1950.883945] update_version   20 update work item!!!     20</span><br><span class="line">[ 1951.882103] update_version   21 update work item!!!     21</span><br><span class="line">[ 1951.892665] update_version   22 update work item!!!     22</span><br><span class="line">[ 1951.932523] update_version   23 update work item!!!     23</span><br><span class="line">[ 1952.540463] update_version   24 update work item!!!     24</span><br><span class="line">[ 1952.883003] update_version   25 update work item!!!     25</span><br><span class="line">[ 1953.205436] update_version   26 update work item!!!     26</span><br><span class="line">[ 1953.216742] update_version   27 update work item!!!     27</span><br><span class="line">[ 1953.227667] update_version   28 update work item!!!     28</span><br><span class="line">[ 1953.240049] update_version   29 update work item!!!     29</span><br><span class="line">[ 1953.251936] work_queue canceled!!!!</span><br></pre></td></tr></table></figure></p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>尽量按照顺序执行，即<code>cancel_delayed_work</code>-&gt;<code>flush_delayed_work</code>。或者只调用<code>cancel_delayed_work_sync</code>。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Kernel</tag>
      </tags>
  </entry>
  <entry>
    <title>Shelll配置与环境</title>
    <url>/2020/06/11/shelll%E9%85%8D%E7%BD%AE%E4%B8%8E%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<h1 id="配置和环境"><a href="#配置和环境" class="headerlink" title="配置和环境"></a>配置和环境</h1><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="环境里储存的是什么"><a href="#环境里储存的是什么" class="headerlink" title="环境里储存的是什么"></a>环境里储存的是什么</h3><p>环境中储存着环境变量和shell变量，除了变量之外，shell还储存了一些编程数据，也就是别名和shell函数</p>
<h4 id="检查环境"><a href="#检查环境" class="headerlink" title="检查环境"></a>检查环境</h4><p>set命令会同时显示shell变量和环境变量，printenv只会显示环境变量</p>
<p>printenv 会打出特定的变量值</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [14:35:56]</span></span><br><span class="line">$ printenv USER</span><br><span class="line">wayne</span><br></pre></td></tr></table></figure>
<p>查看单个环境变量也可以用</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [14:37:21]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$USER</span></span><br><span class="line">wayne</span><br></pre></td></tr></table></figure>
<p>set 和 printenv 不能查看别名，查看别名要用 alias</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [14:38:48]</span></span><br><span class="line">$ <span class="built_in">alias</span></span><br><span class="line">-=<span class="string">'cd -'</span></span><br><span class="line">..=<span class="string">'cd ..'</span></span><br><span class="line">...=../..</span><br><span class="line">....=../../..</span><br><span class="line">.....=../../../..</span><br><span class="line">......=../../../../..</span><br><span class="line">1=<span class="string">'cd -'</span></span><br><span class="line">2=<span class="string">'cd -2'</span></span><br><span class="line">3=<span class="string">'cd -3'</span></span><br><span class="line">4=<span class="string">'cd -4'</span></span><br><span class="line">5=<span class="string">'cd -5'</span></span><br><span class="line">6=<span class="string">'cd -6'</span></span><br><span class="line">7=<span class="string">'cd -7'</span></span><br><span class="line">8=<span class="string">'cd -8'</span></span><br><span class="line">9=<span class="string">'cd -9'</span></span><br><span class="line">_=<span class="string">'sudo '</span></span><br><span class="line">afind=<span class="string">'ack -il'</span></span><br><span class="line">egrep=<span class="string">'egrep --color=auto --exclude-dir=&#123;.bzr,CVS,.git,.hg,.svn,.idea,.tox&#125;'</span></span><br><span class="line">fgrep=<span class="string">'fgrep --color=auto --exclude-dir=&#123;.bzr,CVS,.git,.hg,.svn,.idea,.tox&#125;'</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="环境是如何建立的"><a href="#环境是如何建立的" class="headerlink" title="环境是如何建立的"></a>环境是如何建立的</h3><h4 id="login和non-login-shell"><a href="#login和non-login-shell" class="headerlink" title="login和non-login shell"></a>login和non-login shell</h4><p>shell会话存在两种，分别为login shell和non-login shell会话</p>
<p>login shell会提示用户输入用户名和密码，启动文件 一般是.profile文件</p>
<p>non-login shell不会提示用户输入密码，启动文件一般是 .bashrc</p>
<h4 id="启动文件有什么"><a href="#启动文件有什么" class="headerlink" title="启动文件有什么"></a>启动文件有什么</h4><p>以下是.bashrc的内容</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># ~/.bashrc</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"> </span><br><span class="line">[[ $- != *i* ]] &amp;&amp; <span class="built_in">return</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="title">colors</span></span>() &#123;</span><br><span class="line">        <span class="built_in">local</span> fgc bgc vals seq0</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">printf</span> <span class="string">"Color escapes are %s\n"</span> <span class="string">'\e[$&#123;value&#125;;...;$&#123;value&#125;m'</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">"Values 30..37 are \e[33mforeground colors\e[m\n"</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">"Values 40..47 are \e[43mbackground colors\e[m\n"</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">"Value  1 gives a  \e[1mbold-faced look\e[m\n\n"</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment"># foreground colors</span></span><br><span class="line">        <span class="keyword">for</span> fgc <span class="keyword">in</span> &#123;30..37&#125;; <span class="keyword">do</span></span><br><span class="line">                <span class="comment"># background colors</span></span><br><span class="line">                <span class="keyword">for</span> bgc <span class="keyword">in</span> &#123;40..47&#125;; <span class="keyword">do</span></span><br><span class="line">                        fgc=<span class="variable">$&#123;fgc#37&#125;</span> <span class="comment"># white</span></span><br><span class="line">                        bgc=<span class="variable">$&#123;bgc#40&#125;</span> <span class="comment"># black</span></span><br><span class="line"> </span><br><span class="line">                        vals=<span class="string">"<span class="variable">$&#123;fgc:+$fgc;&#125;</span><span class="variable">$&#123;bgc&#125;</span>"</span></span><br><span class="line">                        vals=<span class="variable">$&#123;vals%%;&#125;</span></span><br><span class="line"> </span><br><span class="line">                        seq0=<span class="string">"<span class="variable">$&#123;vals:+\e[$&#123;vals&#125;</span>m&#125;"</span></span><br><span class="line">                        <span class="built_in">printf</span> <span class="string">"  %-9s"</span> <span class="string">"<span class="variable">$&#123;seq0:-(default)&#125;</span>"</span></span><br><span class="line">                        <span class="built_in">printf</span> <span class="string">" <span class="variable">$&#123;seq0&#125;</span>TEXT\e[m"</span></span><br><span class="line">                        <span class="built_in">printf</span> <span class="string">" \e[<span class="variable">$&#123;vals:+$&#123;vals+$vals;&#125;</span>&#125;1mBOLD\e[m"</span></span><br><span class="line">                <span class="keyword">done</span></span><br><span class="line">                <span class="built_in">echo</span>; <span class="built_in">echo</span></span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">[ -r /usr/share/bash-completion/bash_completion ] &amp;&amp; . /usr/share/bash-completion/bash_completion</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Change the window title of X terminals</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$&#123;TERM&#125;</span> <span class="keyword">in</span></span><br><span class="line">        xterm*|rxvt*|Eterm*|aterm|kterm|gnome*|interix|konsole*)</span><br><span class="line">                PROMPT_COMMAND=<span class="string">'echo -ne "\033]0;$&#123;USER&#125;@$&#123;HOSTNAME%%.*&#125;:$&#123;PWD/#$HOME/\~&#125;\007"'</span></span><br><span class="line">                ;;</span><br><span class="line">        screen*)</span><br><span class="line">                PROMPT_COMMAND=<span class="string">'echo -ne "\033_$&#123;USER&#125;@$&#123;HOSTNAME%%.*&#125;:$&#123;PWD/#$HOME/\~&#125;\033\\"'</span></span><br><span class="line">                ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"> </span><br><span class="line">use_color=<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Set colorful PS1 only on colorful terminals.</span></span><br><span class="line"><span class="comment"># dircolors --print-database uses its own built-in database</span></span><br><span class="line"><span class="comment"># instead of using /etc/DIR_COLORS.  Try to use the external file</span></span><br><span class="line"><span class="comment"># first to take advantage of user additions.  Use internal bash</span></span><br><span class="line"><span class="comment"># globbing instead of external grep binary.</span></span><br><span class="line">safe_term=<span class="variable">$&#123;TERM//[^[:alnum:]]/?&#125;</span>   <span class="comment"># sanitize TERM</span></span><br><span class="line">match_lhs=<span class="string">""</span></span><br><span class="line">[[ -f ~/.dir_colors   ]] &amp;&amp; match_lhs=<span class="string">"<span class="variable">$&#123;match_lhs&#125;</span><span class="variable">$(&lt;~/.dir_colors)</span>"</span></span><br><span class="line">[[ -f /etc/DIR_COLORS ]] &amp;&amp; match_lhs=<span class="string">"<span class="variable">$&#123;match_lhs&#125;</span><span class="variable">$(&lt;/etc/DIR_COLORS)</span>"</span></span><br><span class="line">[[ -z <span class="variable">$&#123;match_lhs&#125;</span>    ]] \</span><br><span class="line">        &amp;&amp; <span class="built_in">type</span> -P dircolors &gt;/dev/null \</span><br><span class="line">        &amp;&amp; match_lhs=$(dircolors --<span class="built_in">print</span>-database)</span><br><span class="line">[[ $<span class="string">'\n'</span><span class="variable">$&#123;match_lhs&#125;</span> == *$<span class="string">'\n'</span><span class="string">"TERM "</span><span class="variable">$&#123;safe_term&#125;</span>* ]] &amp;&amp; use_color=<span class="literal">true</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> <span class="variable">$&#123;use_color&#125;</span> ; <span class="keyword">then</span></span><br><span class="line">        <span class="comment"># Enable colors for ls, etc.  Prefer ~/.dir_colors #64489</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> -P dircolors &gt;/dev/null ; <span class="keyword">then</span></span><br><span class="line">                <span class="keyword">if</span> [[ -f ~/.dir_colors ]] ; <span class="keyword">then</span></span><br><span class="line">                        <span class="built_in">eval</span> $(dircolors -b ~/.dir_colors)</span><br><span class="line">                <span class="keyword">elif</span> [[ -f /etc/DIR_COLORS ]] ; <span class="keyword">then</span></span><br><span class="line">                        <span class="built_in">eval</span> $(dircolors -b /etc/DIR_COLORS)</span><br><span class="line">                <span class="keyword">fi</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> [[ <span class="variable">$&#123;EUID&#125;</span> == 0 ]] ; <span class="keyword">then</span></span><br><span class="line">                PS1=<span class="string">'\[\033[01;31m\][\h\[\033[01;36m\] \W\[\033[01;31m\]]\$\[\033[00m\] '</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                PS1=<span class="string">'\[\033[01;32m\][\u@\h\[\033[01;37m\] \W\[\033[01;32m\]]\$\[\033[00m\] '</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line">        <span class="built_in">alias</span> ls=<span class="string">'ls --color=auto'</span></span><br><span class="line">        <span class="built_in">alias</span> grep=<span class="string">'grep --colour=auto'</span></span><br><span class="line">        <span class="built_in">alias</span> egrep=<span class="string">'egrep --colour=auto'</span></span><br><span class="line">        <span class="built_in">alias</span> fgrep=<span class="string">'fgrep --colour=auto'</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span> [[ <span class="variable">$&#123;EUID&#125;</span> == 0 ]] ; <span class="keyword">then</span></span><br><span class="line">                <span class="comment"># show root@ when we don't have colors</span></span><br><span class="line">                PS1=<span class="string">'\u@\h \W \$ '</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                PS1=<span class="string">'\u@\h \w \$ '</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">unset</span> use_color safe_term match_lhs sh</span><br><span class="line"> </span><br><span class="line"><span class="built_in">alias</span> cp=<span class="string">"cp -i"</span>                          <span class="comment"># confirm before overwriting something</span></span><br><span class="line"><span class="built_in">alias</span> df=<span class="string">'df -h'</span>                          <span class="comment"># human-readable sizes</span></span><br><span class="line"><span class="built_in">alias</span> free=<span class="string">'free -m'</span>                      <span class="comment"># show sizes in MB</span></span><br><span class="line"><span class="built_in">alias</span> np=<span class="string">'nano -w PKGBUILD'</span></span><br><span class="line"><span class="built_in">alias</span> more=less</span><br><span class="line"> </span><br><span class="line">xhost +<span class="built_in">local</span>:root &gt; /dev/null 2&gt;&amp;1</span><br><span class="line"> </span><br><span class="line">complete -cf sudo</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Bash won't get SIGWINCH if another process is in the foreground.</span></span><br><span class="line"><span class="comment"># Enable checkwinsize so that bash will check the terminal size when</span></span><br><span class="line"><span class="comment"># it regains control.  #65623</span></span><br><span class="line"><span class="comment"># http://cnswww.cns.cwru.edu/~chet/bash/FAQ (E11)</span></span><br><span class="line"><span class="built_in">shopt</span> -s checkwinsize</span><br><span class="line"> </span><br><span class="line"><span class="built_in">shopt</span> -s expand_aliases</span><br><span class="line"> </span><br><span class="line"><span class="comment"># export QT_SELECT=4</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Enable history appending instead of overwriting.  #139609</span></span><br><span class="line"><span class="built_in">shopt</span> -s histappend</span><br><span class="line"> </span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # ex - archive extractor</span></span><br><span class="line"><span class="comment"># # usage: ex &lt;file&gt;</span></span><br><span class="line">ex ()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> [ -f <span class="variable">$1</span> ] ; <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">      *.tar.bz2)   tar xjf <span class="variable">$1</span>   ;;</span><br><span class="line">      *.tar.gz)    tar xzf <span class="variable">$1</span>   ;;</span><br><span class="line">      *.bz2)       bunzip2 <span class="variable">$1</span>   ;;</span><br><span class="line">      *.rar)       unrar x <span class="variable">$1</span>     ;;</span><br><span class="line">      *.gz)        gunzip <span class="variable">$1</span>    ;;</span><br><span class="line">      *.tar)       tar xf <span class="variable">$1</span>    ;;</span><br><span class="line">      *.tbz2)      tar xjf <span class="variable">$1</span>   ;;</span><br><span class="line">      *.tgz)       tar xzf <span class="variable">$1</span>   ;;</span><br><span class="line">      *.zip)       unzip <span class="variable">$1</span>     ;;</span><br><span class="line">      *.Z)         uncompress <span class="variable">$1</span>;;</span><br><span class="line">      *.7z)        7z x <span class="variable">$1</span>      ;;</span><br><span class="line">      *)           <span class="built_in">echo</span> <span class="string">"'<span class="variable">$1</span>' cannot be extracted via ex()"</span> ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"'<span class="variable">$1</span>' is not a valid file"</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">[ -f ~/.fzf.bash ] &amp;&amp; <span class="built_in">source</span> ~/.fzf.bash</span><br></pre></td></tr></table></figure>
<h3 id="修改环境"><a href="#修改环境" class="headerlink" title="修改环境"></a>修改环境</h3><h4 id="用户应该修改哪些文件"><a href="#用户应该修改哪些文件" class="headerlink" title="用户应该修改哪些文件"></a>用户应该修改哪些文件</h4><p>一般要修改.bash_profile等效文件</p>
<p><strong>修改提示符，可以修改PS1 变量</strong></p>
<h2 id="软件包管理"><a href="#软件包管理" class="headerlink" title="软件包管理"></a>软件包管理</h2><h3 id="软件包系统"><a href="#软件包系统" class="headerlink" title="软件包系统"></a>软件包系统</h3><p>一般有三种，debian系的.deb，redhat系的.rpm，还有就是压缩包自己编译，此处只讨论前两种</p>
<h3 id="软件包系统的工作方式"><a href="#软件包系统的工作方式" class="headerlink" title="软件包系统的工作方式"></a>软件包系统的工作方式</h3><h4 id="高级和低级软件包工具"><a href="#高级和低级软件包工具" class="headerlink" title="高级和低级软件包工具"></a>高级和低级软件包工具</h4><p>debian系：低级 dpkg，高级apt-get;apt</p>
<p>redhat：低级rpm，高级yum</p>
<h2 id="存储介质"><a href="#存储介质" class="headerlink" title="存储介质"></a>存储介质</h2><h3 id="挂载、卸载存储设备"><a href="#挂载、卸载存储设备" class="headerlink" title="挂载、卸载存储设备"></a>挂载、卸载存储设备</h3><p>储存系统启动时的挂载信息位置是/etc/fstab</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [21:11:19]</span></span><br><span class="line">$ cat /etc/fstab</span><br><span class="line"><span class="comment"># /etc/fstab: static file system information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Use 'blkid' to print the universally unique identifier for a device; this may</span></span><br><span class="line"><span class="comment"># be used with UUID= as a more robust way to name devices that works even if</span></span><br><span class="line"><span class="comment"># disks are added and removed. See fstab(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># &lt;file system&gt;             &lt;mount point&gt;  &lt;type&gt;  &lt;options&gt;  &lt;dump&gt;  &lt;pass&gt;</span></span><br><span class="line">UUID=1550-645D                            /boot/efi      vfat    <span class="built_in">umask</span>=0077 0 2</span><br><span class="line">UUID=98173142-60a1-4818-aaac-559c6adea021 /              ext4    defaults,noatime,discard 0 1</span><br><span class="line">tmpfs                                     /tmp           tmpfs   defaults,noatime,mode=1777 0 0</span><br><span class="line">UUID=DC0CD1C50CD19ABA   /mnt/sdb1 ntfs  defaults 0 0</span><br><span class="line">UUID=9874EB8474EB638A   /mnt/sdb2 ntfs  defaults 0 0</span><br><span class="line">UUID=E6DEF47ADEF443F9   /mnt/sdb3 ntfs  defaults 0 0</span><br></pre></td></tr></table></figure>
<p>mount 查看已挂载的设备</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [21:11:34]</span></span><br><span class="line">$ mount</span><br><span class="line">proc on /proc <span class="built_in">type</span> proc (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">sys on /sys <span class="built_in">type</span> sysfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">dev on /dev <span class="built_in">type</span> devtmpfs (rw,nosuid,relatime,size=8148412k,nr_inodes=2037103,mode=755)</span><br><span class="line">run on /run <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,relatime,mode=755)</span><br><span class="line">efivarfs on /sys/firmware/efi/efivars <span class="built_in">type</span> efivarfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">/dev/sda2 on / <span class="built_in">type</span> ext4 (rw,noatime,discard)</span><br><span class="line">securityfs on /sys/kernel/security <span class="built_in">type</span> securityfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">tmpfs on /dev/shm <span class="built_in">type</span> tmpfs (rw,nosuid,nodev)</span><br><span class="line">devpts on /dev/pts <span class="built_in">type</span> devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)</span><br><span class="line">tmpfs on /sys/fs/cgroup <span class="built_in">type</span> tmpfs (ro,nosuid,nodev,noexec,mode=755)</span><br><span class="line">cgroup2 on /sys/fs/cgroup/unified <span class="built_in">type</span> cgroup2 (rw,nosuid,nodev,noexec,relatime,nsdelegate)</span><br><span class="line">cgroup on /sys/fs/cgroup/systemd <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,xattr,name=systemd)</span><br><span class="line">pstore on /sys/fs/pstore <span class="built_in">type</span> pstore (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">none on /sys/fs/bpf <span class="built_in">type</span> bpf (rw,nosuid,nodev,noexec,relatime,mode=700)</span><br><span class="line">cgroup on /sys/fs/cgroup/cpu,cpuacct <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)</span><br><span class="line">cgroup on /sys/fs/cgroup/devices <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,devices)</span><br><span class="line">cgroup on /sys/fs/cgroup/pids <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,pids)</span><br><span class="line">cgroup on /sys/fs/cgroup/net_cls,net_prio <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)</span><br><span class="line">cgroup on /sys/fs/cgroup/memory <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,memory)</span><br><span class="line">cgroup on /sys/fs/cgroup/blkio <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,blkio)</span><br><span class="line">cgroup on /sys/fs/cgroup/freezer <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,freezer)</span><br><span class="line">cgroup on /sys/fs/cgroup/rdma <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,rdma)</span><br><span class="line">cgroup on /sys/fs/cgroup/perf_event <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)</span><br><span class="line">cgroup on /sys/fs/cgroup/hugetlb <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)</span><br><span class="line">cgroup on /sys/fs/cgroup/cpuset <span class="built_in">type</span> cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)</span><br><span class="line">systemd-1 on /proc/sys/fs/binfmt_misc <span class="built_in">type</span> autofs (rw,relatime,fd=29,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=15619)</span><br><span class="line">mqueue on /dev/mqueue <span class="built_in">type</span> mqueue (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">hugetlbfs on /dev/hugepages <span class="built_in">type</span> hugetlbfs (rw,relatime,pagesize=2M)</span><br><span class="line">debugfs on /sys/kernel/debug <span class="built_in">type</span> debugfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">tracefs on /sys/kernel/tracing <span class="built_in">type</span> tracefs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">binfmt_misc on /proc/sys/fs/binfmt_misc <span class="built_in">type</span> binfmt_misc (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">configfs on /sys/kernel/config <span class="built_in">type</span> configfs (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">tmpfs on /tmp <span class="built_in">type</span> tmpfs (rw,noatime)</span><br><span class="line">fusectl on /sys/fs/fuse/connections <span class="built_in">type</span> fusectl (rw,nosuid,nodev,noexec,relatime)</span><br><span class="line">/dev/sda1 on /boot/efi <span class="built_in">type</span> vfat (rw,relatime,fmask=0077,dmask=0077,codepage=437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro)</span><br><span class="line">/dev/sdb1 on /mnt/sdb1 <span class="built_in">type</span> fuseblk (ro,nosuid,nodev,relatime,user_id=0,group_id=0,allow_other,blksize=4096)</span><br><span class="line">/dev/sdb2 on /mnt/sdb2 <span class="built_in">type</span> fuseblk (ro,nosuid,nodev,relatime,user_id=0,group_id=0,allow_other,blksize=4096)</span><br><span class="line">/dev/sdb3 on /mnt/sdb3 <span class="built_in">type</span> fuseblk (ro,nosuid,nodev,relatime,user_id=0,group_id=0,allow_other,blksize=4096)</span><br><span class="line">tmpfs on /run/user/1000 <span class="built_in">type</span> tmpfs (rw,nosuid,nodev,relatime,size=1631660k,mode=700,uid=1000,gid=1001)</span><br><span class="line">gvfsd-fuse on /run/user/1000/gvfs <span class="built_in">type</span> fuse.gvfsd-fuse (rw,nosuid,nodev,relatime,user_id=1000,group_id=1001)</span><br><span class="line">portal on /run/user/1000/doc <span class="built_in">type</span> fuse.portal (rw,nosuid,nodev,relatime,user_id=1000,group_id=1001)</span><br></pre></td></tr></table></figure>
<p>卸载可以用unmount 加目录名</p>
<p>通过查看/dev 目录可以看到设备信息</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [21:13:03]</span></span><br><span class="line">$ ll /dev</span><br><span class="line">总用量 0</span><br><span class="line">crw-r--r--  1 root root    10,   235  5月 31 10:38 autofs</span><br><span class="line">drwxr-xr-x  2 root root          340  5月 31 10:38 block</span><br><span class="line">drwxr-xr-x  2 root root           80  5月 31 10:38 bsg</span><br><span class="line">crw-------  1 root root    10,   234  5月 31 10:38 btrfs-control</span><br><span class="line">drwxr-xr-x  3 root root           60  5月 31 10:38 bus</span><br><span class="line">drwxr-xr-x  2 root root         3.4K  5月 31 11:25 char</span><br><span class="line">crw-------  1 root root     5,     1  5月 31 10:38 console</span><br><span class="line">lrwxrwxrwx  1 root root           11  5月 31 10:38 core -&gt; /proc/kcore</span><br><span class="line">drwxr-xr-x  2 root root           60  5月 31 10:38 cpu</span><br><span class="line">crw-------  1 root root    10,    60  5月 31 10:38 cpu_dma_latency</span><br><span class="line">crw-------  1 root root    10,   203  5月 31 10:38 cuse</span><br><span class="line">drwxr-xr-x  7 root root          140  5月 31 10:38 disk</span><br><span class="line">drwxr-xr-x  3 root root          140  5月 31 10:38 dri</span><br><span class="line">crw-------  1 root root   240,     0  5月 31 10:38 drm_dp_aux0</span><br><span class="line">crw-rw----  1 root video   29,     0  5月 31 10:38 fb0</span><br><span class="line">lrwxrwxrwx  1 root root           13  5月 31 10:38 fd -&gt; /proc/self/fd</span><br><span class="line">crw-rw-rw-  1 root root     1,     7  5月 31 10:38 full</span><br><span class="line">crw-rw-rw-  1 root root    10,   229  5月 31 10:38 fuse</span><br><span class="line">crw-------  1 root root    10,   228  5月 31 10:38 hpet</span><br><span class="line">drwxr-xr-x  2 root root            0  5月 31 10:38 hugepages</span><br><span class="line">crw-------  1 root root    10,   183  5月 31 10:38 hwrng</span><br><span class="line">lrwxrwxrwx  1 root root           12  5月 31 10:38 initctl -&gt; /run/initctl</span><br><span class="line">drwxr-xr-x  4 root root          480  5月 31 10:38 input</span><br><span class="line">crw-r--r--  1 root root     1,    11  5月 31 10:38 kmsg</span><br><span class="line">crw-rw-rw-  1 root kvm     10,   232  5月 31 10:38 kvm</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Shell</tag>
      </tags>
  </entry>
  <entry>
    <title>Shell命令行大全</title>
    <url>/2020/06/11/Shell%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%A4%A7%E5%85%A8/</url>
    <content><![CDATA[<h1 id="学习Shell"><a href="#学习Shell" class="headerlink" title="学习Shell"></a>学习Shell</h1><h2 id="终端-Terminal"><a href="#终端-Terminal" class="headerlink" title="终端(Terminal)"></a>终端(Terminal)</h2><h3 id="关于配置终端环境——使用-zsh-oh-my-zsh"><a href="#关于配置终端环境——使用-zsh-oh-my-zsh" class="headerlink" title="关于配置终端环境——使用 zsh + oh-my-zsh"></a>关于配置终端环境——使用 zsh + oh-my-zsh</h3><h4 id="什么是Shell"><a href="#什么是Shell" class="headerlink" title="什么是Shell"></a>什么是Shell</h4><p>shell是一个接受由键盘输入的命令，并将其传递给操作系统来执行的程序。一般来说，linux发行版自带的shell——bash是sh的增强版。</p>
<h4 id="查看当前的Shell"><a href="#查看当前的Shell" class="headerlink" title="查看当前的Shell"></a>查看当前的Shell</h4><p>通过以下命令可以查看当前的shell。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br></pre></td></tr></table></figure>
<p>通过以下命令来查看系统中有几种shell</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure>
<p>显示如下</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /etc/shells: valid login shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">/bin/dash</span><br><span class="line">/usr/bin/tmux</span><br><span class="line">/usr/bin/screen</span><br><span class="line">/bin/zsh</span><br></pre></td></tr></table></figure>
<h4 id="安装zsh"><a href="#安装zsh" class="headerlink" title="安装zsh"></a>安装zsh</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo apt-get install zsh <span class="comment">#for Ubuntu</span></span><br><span class="line">sudo yum install zsh <span class="comment">#for Redhat</span></span><br></pre></td></tr></table></figure>
<h4 id="切换默认终端为zsh"><a href="#切换默认终端为zsh" class="headerlink" title="切换默认终端为zsh"></a>切换默认终端为zsh</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<h4 id="安装oh-my-zsh"><a href="#安装oh-my-zsh" class="headerlink" title="安装oh-my-zsh"></a>安装oh-my-zsh</h4><ol>
<li><p>安装 oh-my-zsh项目:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Via Curl</span></span><br><span class="line">sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> Via wget</span></span><br><span class="line">sh -c "$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)"</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>将其中的主题切换至自己喜欢的主题：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ZSH_THEME="ys"</span><br></pre></td></tr></table></figure>
</li>
<li><p>推荐插件</p>
<ul>
<li><p>zsh-autosuggestions</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git://github.com/zsh-users/zsh-autosuggestions</span><br></pre></td></tr></table></figure>
</li>
<li><p>zsh-syntax-highlighting</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>修改配置文件</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">plugins=(git zsh-syntax-highlighting zsh-autosuggestions)</span><br></pre></td></tr></table></figure>
<p>让配置生效</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<a id="more"></a>
<h3 id="第一次键盘输入"><a href="#第一次键盘输入" class="headerlink" title="第一次键盘输入"></a>第一次键盘输入</h3><p>打开终端后如下所示</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:07:05]</span></span><br><span class="line"><span class="meta">$</span></span><br></pre></td></tr></table></figure>
<p>这称为shell 提示符，提示符随发行版不同有可能会变化，但是通常包括username@machinename 气候是当前工作目录和一个 $</p>
<p>如果shell提示符的最后一个字符是#，而不是一个$，那么终端是享有root权限的。则或者我们以root用户登录，或者terminal提供了root权限</p>
<h4 id="命令历史记录"><a href="#命令历史记录" class="headerlink" title="命令历史记录"></a>命令历史记录</h4><p>按方向键 ↑，会看到先前的命令，按方向键↓，命令会消失</p>
<h4 id="光标移动"><a href="#光标移动" class="headerlink" title="光标移动"></a>光标移动</h4><p>向左向右的方向键可以移动光标。</p>
<p>如果紧按鼠标左键选中一些文本并拖动鼠标，或者双击选中一个词，该文本就会被复制到缓冲区。按下鼠标中键或者右键就可以粘贴。</p>
<p>不要使用Ctrl-C和Ctrl-V来复制粘贴。</p>
<p>窗口焦点跟随鼠标，当鼠标经过窗口时窗口就会获得焦点。</p>
<h3 id="几个简单的命令"><a href="#几个简单的命令" class="headerlink" title="几个简单的命令"></a>几个简单的命令</h3><p>首先是<code>date</code>命令，该命令显示当前系统的时间和日期</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:07:05]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> date</span></span><br><span class="line">Mon Apr 13 22:28:14 CST 2020</span><br></pre></td></tr></table></figure>
<p>与之相关的一个命令是<code>cal</code>， 在默认情况下<code>cal</code>显示当月的月历</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:28:14]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cal</span></span><br><span class="line">April 2020</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">1  2  3  4</span><br><span class="line">5  6  7  8  9 10 11</span><br><span class="line">12 13 14 15 16 17 18</span><br><span class="line">19 20 21 22 23 24 25</span><br><span class="line">26 27 28 29 30</span><br></pre></td></tr></table></figure>
<p>如果想要查看磁盘驱动当前的可用空间，可以使用<code>df</code> 命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:30:33]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> df</span></span><br><span class="line">df: /mnt/j: Invalid argument</span><br><span class="line">Filesystem     1K-blocks      Used Available Use% Mounted on</span><br><span class="line">rootfs         248839948 173147664  75692284  70% /</span><br><span class="line">none           248839948 173147664  75692284  70% /dev</span><br><span class="line">none           248839948 173147664  75692284  70% /run</span><br><span class="line">none           248839948 173147664  75692284  70% /run/lock</span><br><span class="line">none           248839948 173147664  75692284  70% /run/shm</span><br><span class="line">none           248839948 173147664  75692284  70% /run/user</span><br><span class="line">cgroup         248839948 173147664  75692284  70% /sys/fs/cgroup</span><br><span class="line">C:\            248839948 173147664  75692284  70% /mnt/c</span><br><span class="line">D:\            976744444 513842572 462901872  53% /mnt/d</span><br><span class="line">E:\            488372220  63592328 424779892  14% /mnt/e</span><br><span class="line">F:\            488372220  55592648 432779572  12% /mnt/f</span><br></pre></td></tr></table></figure>
<p>同样，要是用可用内存可以使用<code>free</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:34:48] C:1</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> free</span></span><br><span class="line">total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:       16715312     8775420     7710540       17720      229352     7806160</span><br><span class="line">Swap:      31104992      503280    30601712</span><br></pre></td></tr></table></figure>
<h3 id="结束终端会话"><a href="#结束终端会话" class="headerlink" title="结束终端会话"></a>结束终端会话</h3><p>直接关闭终端窗口或者输入<code>exit</code>命令即可以结束终端会话。</p>
<blockquote>
<p>幕后的控制台，即使没有运行terminal simulator， 有些回话会在后台运行。可以通过Ctrl-Alt-F1~F6访问到大多数的后台虚拟控制台。Alt-F1 ~ F6可以在虚拟控制台间切换，Alt-F7返回GUI图形桌面</p>
</blockquote>
<h2 id="导航"><a href="#导航" class="headerlink" title="导航"></a>导航</h2><h3 id="理解文件系统树"><a href="#理解文件系统树" class="headerlink" title="理解文件系统树"></a>理解文件系统树</h3><p>在Windows系统中，每个存储设备都有一个独立的文件系统树，而在类Unix系统中，如Linux，无论多少驱动器或者存储设备与计算机连接，通常只有一个文件系统树。存储设备会挂载到文件系统树的不同位置。</p>
<h3 id="当前工作目录"><a href="#当前工作目录" class="headerlink" title="当前工作目录"></a>当前工作目录</h3><p>使用<code>pwd</code>可以显示当前的工作目录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /mnt/c/Users/User [22:52:02]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/mnt/c/Users/User</span><br></pre></td></tr></table></figure>
<p>第一次登录系统时，当前工作目录会被设成主目录。作为普通用户操作时，这是唯一一个允许用户写文件的地方。</p>
<h3 id="列出目录内容"><a href="#列出目录内容" class="headerlink" title="列出目录内容"></a>列出目录内容</h3><p><code>ls</code>来列出当前工作目录的文件和目录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> ~ [23:02:33]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos  fonts  thinclient_drives</span><br></pre></td></tr></table></figure>
<p>实际上<code>ls</code>可以用来列出任何目录的内容</p>
<h3 id="更改当前工作目录"><a href="#更改当前工作目录" class="headerlink" title="更改当前工作目录"></a>更改当前工作目录</h3><p>使用<code>cd</code>来更改工作目录</p>
<h4 id="绝对路径名"><a href="#绝对路径名" class="headerlink" title="绝对路径名"></a>绝对路径名</h4><p>绝对路径名从根目录开始，直到目标文件或者目录为止</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:05:31]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /usr/bin <span class="comment">#绝对路径</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:06:02]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:06:04]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">2to3-2.7                             import                                ptar</span><br><span class="line">....</span><br></pre></td></tr></table></figure>
<p>通常来说当前工作目录会显示在shell 提示符前</p>
<h4 id="相对路径名"><a href="#相对路径名" class="headerlink" title="相对路径名"></a>相对路径名</h4><p><code>.</code>代表工作目录，<code>..</code>代表工作目录的父目录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:06:07]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr [23:09:15]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr [23:09:16]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ./bin</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:09:23]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:09:29]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr [23:09:41]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> bin</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [23:09:45]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">pwd</span></span></span><br><span class="line">/usr/bin</span><br></pre></td></tr></table></figure>
<h4 id="一些有用的快捷方式"><a href="#一些有用的快捷方式" class="headerlink" title="一些有用的快捷方式"></a>一些有用的快捷方式</h4><ul>
<li><code>cd</code> —— 将工作目录改变为主目录</li>
<li><code>cd-</code> —— 将工作目录改变为先前的工作目录</li>
<li><code>cd~&lt;username&gt;</code>——将工作目录改变为username的主目录</li>
</ul>
<h2 id="Linux系统"><a href="#Linux系统" class="headerlink" title="Linux系统"></a>Linux系统</h2><h3 id="ls命令的乐趣"><a href="#ls命令的乐趣" class="headerlink" title="ls命令的乐趣"></a>ls命令的乐趣</h3><p>ls可以指定要显示的目录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [20:09:52]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls /usr</span></span><br><span class="line">bin  games  include  lib  local  sbin  share  src</span><br></pre></td></tr></table></figure>
<p>我们甚至可以指定多个目录，以下显示了<code>/usr</code>和<code>/home</code>的目录内容</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> /usr/bin [21:48:46]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls /usr /home</span></span><br><span class="line">/home:</span><br><span class="line">waynejing</span><br><span class="line"> </span><br><span class="line">/usr:</span><br><span class="line">bin  games  include  lib  local  sbin  share  src</span><br></pre></td></tr></table></figure>
<p>我们也可以改变输出格式来得到更多的细节</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> ~ [21:57:33]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -l</span></span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Desktop</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Documents</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Downloads</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Music</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Pictures</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Public</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Templates</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Videos</span><br><span class="line">drwxrwxr-x 1 waynejing waynejing 4096 Apr  1 23:36 fonts</span><br><span class="line">drwxrwxr-t 1 waynejing waynejing 4096 Apr  1 22:14 thinclient_drives</span><br></pre></td></tr></table></figure>
<p>在命令后面加<code>-l</code>可以将输出以长格式显示</p>
<h4 id="选项和参数"><a href="#选项和参数" class="headerlink" title="选项和参数"></a>选项和参数</h4><p>大部分命令看来是这样的</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">command -options arguments</span><br></pre></td></tr></table></figure>
<p>很多命令支持多个短选项串在一起使用，如<code>ls</code>中，<code>l</code>选项产生长格式输出，而<code>t</code>选项则表示以文件修改时间的先后将结果排序</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> waynejing @ waynejing <span class="keyword">in</span> ~ [21:57:37]                             </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls -lt                                                            </span></span><br><span class="line">total 0                                                             </span><br><span class="line">drwxrwxr-x 1 waynejing waynejing 4096 Apr  1 23:36 fonts            </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Pictures         </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Videos           </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Documents        </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Music            </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Public           </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Desktop          </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Downloads        </span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Templates        </span><br><span class="line">drwxrwxr-t 1 waynejing waynejing 4096 Apr  1 22:14 thinclient_drives</span><br></pre></td></tr></table></figure>
<p>加上长选项<code>--reverse</code>，则结果会以相反的顺序输出：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in ~ [22:05:03]</span></span><br><span class="line">$ ls -lt --reverse</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-t 1 waynejing waynejing 4096 Apr  1 22:14 thinclient_drives</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Templates</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Downloads</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Desktop</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Public</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Music</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Documents</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Videos</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Pictures</span><br><span class="line">drwxrwxr-x 1 waynejing waynejing 4096 Apr  1 23:36 fonts</span><br></pre></td></tr></table></figure>
<p>ls命令有大量可用的选项，</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in ~ [22:07:11]</span></span><br><span class="line">$ ls --<span class="built_in">help</span></span><br><span class="line">Usage: ls [OPTION]... [FILE]...</span><br><span class="line">List information about the FILEs (the current directory by default).</span><br><span class="line">Sort entries alphabetically <span class="keyword">if</span> none of -cftuvSUX nor --sort is specified.</span><br><span class="line"> </span><br><span class="line">Mandatory arguments to long options are mandatory <span class="keyword">for</span> short options too.</span><br><span class="line">  -a, --all                  <span class="keyword">do</span> not ignore entries starting with .</span><br><span class="line">  -A, --almost-all           <span class="keyword">do</span> not list implied . and ..</span><br><span class="line">      --author               with -l, <span class="built_in">print</span> the author of each file</span><br><span class="line">  -b, --escape               <span class="built_in">print</span> C-style escapes <span class="keyword">for</span> nongraphic characters</span><br><span class="line">      --block-size=SIZE      scale sizes by SIZE before printing them; e.g.,</span><br><span class="line">                               <span class="string">'--block-size=M'</span> prints sizes <span class="keyword">in</span> units of</span><br><span class="line">                               1,048,576 bytes; see SIZE format below</span><br><span class="line">  -B, --ignore-backups       <span class="keyword">do</span> not list implied entries ending with ~</span><br><span class="line">  -c                         with -lt: sort by, and show, ctime (time of last</span><br><span class="line">                               modification of file status information);</span><br><span class="line">                               with -l: show ctime and sort by name;</span><br><span class="line">                               otherwise: sort by ctime, newest first</span><br><span class="line">  -C                         list entries by columns</span><br><span class="line">      --color[=WHEN]         colorize the output; WHEN can be <span class="string">'always'</span> (default</span><br><span class="line">                               <span class="keyword">if</span> omitted), <span class="string">'auto'</span>, or <span class="string">'never'</span>; more info below</span><br><span class="line">  -d, --directory            list directories themselves, not their contents</span><br><span class="line">  -D, --dired                generate output designed <span class="keyword">for</span> Emacs<span class="string">' dired mode</span></span><br><span class="line"><span class="string">  -f                         do not sort, enable -aU, disable -ls --color</span></span><br><span class="line"><span class="string">  -F, --classify             append indicator (one of */=&gt;@|) to entries</span></span><br><span class="line"><span class="string">      --file-type            likewise, except do not append '</span>*<span class="string">'</span></span><br><span class="line"><span class="string">      --format=WORD          across -x, commas -m, horizontal -x, long -l,</span></span><br><span class="line"><span class="string">                               single-column -1, verbose -l, vertical -C</span></span><br><span class="line"><span class="string">      --full-time            like -l --time-style=full-iso</span></span><br><span class="line"><span class="string">  -g                         like -l, but do not list owner</span></span><br><span class="line"><span class="string">      --group-directories-first</span></span><br><span class="line"><span class="string">                             group directories before files;</span></span><br><span class="line"><span class="string">                               can be augmented with a --sort option, but any</span></span><br><span class="line"><span class="string">                               use of --sort=none (-U) disables grouping</span></span><br><span class="line"><span class="string">  -G, --no-group             in a long listing, don'</span>t <span class="built_in">print</span> group names</span><br><span class="line">  -h, --human-readable       with -l and/or -s, <span class="built_in">print</span> human readable sizes</span><br><span class="line">                               (e.g., 1K 234M 2G)</span><br><span class="line">      --si                   likewise, but use powers of 1000 not 1024</span><br><span class="line">  -H, --dereference-command-line</span><br><span class="line">                             follow symbolic links listed on the <span class="built_in">command</span> line</span><br><span class="line">      --dereference-command-line-symlink-to-dir</span><br><span class="line">                             follow each <span class="built_in">command</span> line symbolic link</span><br><span class="line">                               that points to a directory</span><br><span class="line">      --hide=PATTERN         <span class="keyword">do</span> not list implied entries matching shell PATTERN</span><br><span class="line">                               (overridden by -a or -A)</span><br><span class="line">      --hyperlink[=WHEN]     hyperlink file names; WHEN can be <span class="string">'always'</span></span><br><span class="line">                               (default <span class="keyword">if</span> omitted), <span class="string">'auto'</span>, or <span class="string">'never'</span></span><br><span class="line">      --indicator-style=WORD  append indicator with style WORD to entry names:</span><br><span class="line">                               none (default), slash (-p),</span><br><span class="line">                               file-type (--file-type), classify (-F)</span><br><span class="line">  -i, --inode                <span class="built_in">print</span> the index number of each file</span><br><span class="line">  -I, --ignore=PATTERN       <span class="keyword">do</span> not list implied entries matching shell PATTERN</span><br><span class="line">  -k, --kibibytes            default to 1024-byte blocks <span class="keyword">for</span> disk usage</span><br><span class="line">  -l                         use a long listing format</span><br><span class="line">  -L, --dereference          when showing file information <span class="keyword">for</span> a symbolic</span><br><span class="line">                               link, show information <span class="keyword">for</span> the file the link</span><br><span class="line">                               references rather than <span class="keyword">for</span> the link itself</span><br><span class="line">  -m                         fill width with a comma separated list of entries</span><br><span class="line">  -n, --numeric-uid-gid      like -l, but list numeric user and group IDs</span><br><span class="line">  -N, --literal              <span class="built_in">print</span> entry names without quoting</span><br><span class="line">  -o                         like -l, but <span class="keyword">do</span> not list group information</span><br><span class="line">  -p, --indicator-style=slash</span><br><span class="line">                             append / indicator to directories</span><br><span class="line">  -q, --hide-control-chars   <span class="built_in">print</span> ? instead of nongraphic characters</span><br><span class="line">      --show-control-chars   show nongraphic characters as-is (the default,</span><br><span class="line">                               unless program is <span class="string">'ls'</span> and output is a terminal)</span><br><span class="line">  -Q, --quote-name           enclose entry names <span class="keyword">in</span> double quotes</span><br><span class="line">      --quoting-style=WORD   use quoting style WORD <span class="keyword">for</span> entry names:</span><br><span class="line">                               literal, locale, shell, shell-always,</span><br><span class="line">                               shell-escape, shell-escape-always, c, escape</span><br><span class="line">  -r, --reverse              reverse order <span class="keyword">while</span> sorting</span><br><span class="line">  -R, --recursive            list subdirectories recursively</span><br><span class="line">  -s, --size                 <span class="built_in">print</span> the allocated size of each file, <span class="keyword">in</span> blocks</span><br><span class="line">  -S                         sort by file size, largest first</span><br><span class="line">      --sort=WORD            sort by WORD instead of name: none (-U), size (-S),</span><br><span class="line">                               time (-t), version (-v), extension (-X)</span><br><span class="line">      --time=WORD            with -l, show time as WORD instead of default</span><br><span class="line">                               modification time: atime or access or use (-u);</span><br><span class="line">                               ctime or status (-c); also use specified time</span><br><span class="line">                               as sort key <span class="keyword">if</span> --sort=time (newest first)</span><br><span class="line">      --time-style=STYLE     with -l, show <span class="built_in">times</span> using style STYLE:</span><br><span class="line">                               full-iso, long-iso, iso, locale, or +FORMAT;</span><br><span class="line">                               FORMAT is interpreted like <span class="keyword">in</span> <span class="string">'date'</span>; <span class="keyword">if</span> FORMAT</span><br><span class="line">                               is FORMAT1&lt;newline&gt;FORMAT2, <span class="keyword">then</span> FORMAT1 applies</span><br><span class="line">                               to non-recent files and FORMAT2 to recent files;</span><br><span class="line">                               <span class="keyword">if</span> STYLE is prefixed with <span class="string">'posix-'</span>, STYLE</span><br><span class="line">                               takes effect only outside the POSIX locale</span><br><span class="line">  -t                         sort by modification time, newest first</span><br><span class="line">  -T, --tabsize=COLS         assume tab stops at each COLS instead of 8</span><br><span class="line">  -u                         with -lt: sort by, and show, access time;</span><br><span class="line">                               with -l: show access time and sort by name;</span><br><span class="line">                               otherwise: sort by access time, newest first</span><br><span class="line">  -U                         <span class="keyword">do</span> not sort; list entries <span class="keyword">in</span> directory order</span><br><span class="line">  -v                         natural sort of (version) numbers within text</span><br><span class="line">  -w, --width=COLS           <span class="built_in">set</span> output width to COLS.  0 means no <span class="built_in">limit</span></span><br><span class="line">  -x                         list entries by lines instead of by columns</span><br><span class="line">  -X                         sort alphabetically by entry extension</span><br><span class="line">  -Z, --context              <span class="built_in">print</span> any security context of each file</span><br><span class="line">  -1                         list one file per line.  Avoid <span class="string">'\n'</span> with -q or -b</span><br><span class="line">      --<span class="built_in">help</span>     display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">      --version  output version information and <span class="built_in">exit</span></span><br><span class="line"> </span><br><span class="line">The SIZE argument is an <span class="built_in">integer</span> and optional unit (example: 10K is 10*1024).</span><br><span class="line">Units are K,M,G,T,P,E,Z,Y (powers of 1024) or KB,MB,... (powers of 1000).</span><br><span class="line"> </span><br><span class="line">Using color to distinguish file types is disabled both by default and</span><br><span class="line">with --color=never.  With --color=auto, ls emits color codes only when</span><br><span class="line">standard output is connected to a terminal.  The LS_COLORS environment</span><br><span class="line">variable can change the settings.  Use the dircolors <span class="built_in">command</span> to <span class="built_in">set</span> it.</span><br><span class="line"> </span><br><span class="line">Exit status:</span><br><span class="line"> 0  <span class="keyword">if</span> OK,</span><br><span class="line"> 1  <span class="keyword">if</span> minor problems (e.g., cannot access subdirectory),</span><br><span class="line"> 2  <span class="keyword">if</span> serious trouble (e.g., cannot access <span class="built_in">command</span>-line argument).</span><br><span class="line"> </span><br><span class="line">GNU coreutils online <span class="built_in">help</span>: &lt;http://www.gnu.org/software/coreutils/&gt;</span><br><span class="line">Report ls translation bugs to &lt;http://translationproject.org/team/&gt;</span><br><span class="line">Full documentation at: &lt;http://www.gnu.org/software/coreutils/ls&gt;</span><br><span class="line">or available locally via: info <span class="string">'(coreutils) ls invocation'</span></span><br></pre></td></tr></table></figure>
<h4 id="进一步了解长列表格式"><a href="#进一步了解长列表格式" class="headerlink" title="进一步了解长列表格式"></a>进一步了解长列表格式</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Desktop</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Documents</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Downloads</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Music</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Pictures</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Public</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Templates</span><br><span class="line">drwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 Videos</span><br><span class="line">drwxrwxr-x 1 waynejing waynejing 4096 Apr  1 23:36 fonts</span><br><span class="line">drwxrwxr-t 1 waynejing waynejing 4096 Apr  1 22:14 thinclient_drives</span><br></pre></td></tr></table></figure>
<p>这些字段的含义如下</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字段</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>-rw-r-r-</td>
<td>对文件的访问权限。第一个字符表示文件的类型，在不同类型之间，开头的’-‘表示该文件是一个普通文件，d表示目录。紧接着的三个字符表示文件所有者的访问权限，在空额总金额的三个字符标识文件所属组中成员的访问权限，最后三个字符标识其他所有人的访问权限</td>
</tr>
<tr>
<td>1</td>
<td>文件硬链接数</td>
</tr>
<tr>
<td>waynejing</td>
<td>文件所有者的用户名</td>
</tr>
<tr>
<td>waynejing</td>
<td>文件所属用户组的名称</td>
</tr>
<tr>
<td>4096</td>
<td>以字节数表示的文件大小</td>
</tr>
<tr>
<td>Apr  1 23:36</td>
<td>上次修改文件的日期和时间</td>
</tr>
<tr>
<td>fonts</td>
<td>文件名</td>
</tr>
</tbody>
</table>
</div>
<h3 id="使用file确定文件类型"><a href="#使用file确定文件类型" class="headerlink" title="使用file确定文件类型"></a>使用file确定文件类型</h3><p>linux中的文件拓展名并不能反映文件的内容。</p>
<p>使用file指令可以展示文件内容的简短说明。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User/Pictures [22:16:58]</span></span><br><span class="line">$ file test.jpg</span><br><span class="line">test.jpg: JPEG image data, JFIF standard 1.01, resolution (DPI), density 96x96, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=6], baseline, precision 8, 1871x784, frames 3</span><br></pre></td></tr></table></figure>
<h3 id="使用less命令查看文件内容"><a href="#使用less命令查看文件内容" class="headerlink" title="使用less命令查看文件内容"></a>使用less命令查看文件内容</h3><p>less指令是一个查看文本文件的指令</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:58:44] C:1</span></span><br><span class="line">$ less inittk.ini</span><br></pre></td></tr></table></figure>
<p>一旦运行起来，我们就可以查看文件内容，如果文件不止一页，可以上下滚动文件。按q可以退出less</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>b</td>
<td>向后翻一页</td>
</tr>
<tr>
<td>spacebar</td>
<td>向前翻一页</td>
</tr>
<tr>
<td>↑</td>
<td>向上一行</td>
</tr>
<tr>
<td>↓</td>
<td>向下一行</td>
</tr>
<tr>
<td>G</td>
<td>调到文件末尾</td>
</tr>
<tr>
<td>g</td>
<td>调到文件开头</td>
</tr>
<tr>
<td>/characters</td>
<td>向前查找指定字符</td>
</tr>
<tr>
<td>n</td>
<td>向前查找下一个出现的字符</td>
</tr>
<tr>
<td>h</td>
<td>显示帮助</td>
</tr>
</tbody>
</table>
</div>
<h3 id="快速浏览"><a href="#快速浏览" class="headerlink" title="快速浏览"></a>快速浏览</h3><h3 id="符号链接"><a href="#符号链接" class="headerlink" title="符号链接"></a>符号链接</h3><p>在浏览过程中，我们可能会看到带有如下条目的目录信息</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">lrwxr-xr-x 1 waynejing waynejing 4096 Apr  1 22:14 libc.so.6 -&gt; libc-2.6.so</span><br></pre></td></tr></table></figure>
<p>注意，该条目信息的第一个字母是l，而且看起来像是有两个文件名，这种特殊的文件叫做符号链接。</p>
<h2 id="操作文件与目录"><a href="#操作文件与目录" class="headerlink" title="操作文件与目录"></a>操作文件与目录</h2><p>因为文件在目标目录中不存在或者存在旧的版本，就将所有HTML文件从一个目录复制到目标目录</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cp -u *.html destination</span><br></pre></td></tr></table></figure>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h3><p>通配符允许用户依据字符模式选择文件名</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>通配符</th>
<th>匹配项</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>匹配任意多个字符</td>
</tr>
<tr>
<td>?</td>
<td>匹配任一单个字符</td>
</tr>
<tr>
<td>[characters]</td>
<td>匹配任意一个属于字符集中的字符</td>
</tr>
<tr>
<td>[!characters]</td>
<td>匹配任意一个不属于字符集中的字符</td>
</tr>
<tr>
<td>[[:class:]]</td>
<td>匹配任意一个属于指定字符类中的字符</td>
</tr>
</tbody>
</table>
</div>
<p>下表中列出的常用的字符类</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>字符类</th>
<th>匹配项</th>
</tr>
</thead>
<tbody>
<tr>
<td>[:alnum:]</td>
<td>匹配任意一个字母或数字</td>
</tr>
<tr>
<td>[:alpha:]</td>
<td>匹配任意一个字母</td>
</tr>
<tr>
<td>[:digit:]</td>
<td>匹配任意一个数字</td>
</tr>
<tr>
<td>[:lower:]</td>
<td>匹配任意一个小写字母</td>
</tr>
<tr>
<td>[:upper:]</td>
<td>匹配任意一个大写字母</td>
</tr>
</tbody>
</table>
</div>
<h3 id="mkdir-创建目录"><a href="#mkdir-创建目录" class="headerlink" title="mkdir 创建目录"></a>mkdir 创建目录</h3><p>mkdir是用来创建目录的</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir dir...</span><br></pre></td></tr></table></figure>
<p><strong>注意表示法</strong>：此笔记中的<code>…</code>表示参数重复即</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mkdir dir1 dir2 dir3</span><br></pre></td></tr></table></figure>
<p>可以创建3个目录</p>
<h3 id="cp-复制文件和目录"><a href="#cp-复制文件和目录" class="headerlink" title="cp 复制文件和目录"></a>cp 复制文件和目录</h3><p>cp有两种使用方式：</p>
<p>将单个文件或者目录复制到文件或者目录中</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cp &lt;src&gt; &lt;des&gt;</span><br></pre></td></tr></table></figure>
<p>将多个项目复制进一个目录</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cp &lt;src&gt;... &lt;des&gt;</span><br></pre></td></tr></table></figure>
<p>cp常用选项</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>选项</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>复制文件和目录及其属性，包括所有权限</td>
</tr>
<tr>
<td>-i</td>
<td>覆盖文件前要求用户确认</td>
</tr>
<tr>
<td>-r</td>
<td>递归的复制目录及其内容</td>
</tr>
<tr>
<td>-u</td>
<td>将文件从一个目录复制到另一个目录时，只复制目标中不存在的或者版本更新的文件</td>
</tr>
<tr>
<td>-v</td>
<td>复制文件时，显示详细信息</td>
</tr>
</tbody>
</table>
</div>
<h3 id="mv-移除和重命名文件"><a href="#mv-移除和重命名文件" class="headerlink" title="mv 移除和重命名文件"></a>mv 移除和重命名文件</h3><p>mv命令可以执行文件移动和文件重命名操作。在这两种情况下，原来的文件将不存在</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mv &lt;src&gt; &lt;des&gt;</span><br></pre></td></tr></table></figure>
<p>将文件或者目录移动或命名为des</p>
<p>或者是</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">mv &lt;src&gt;... &lt;des&gt;</span><br></pre></td></tr></table></figure>
<p>将多个条目从一个目录移动到另一个目录</p>
<p>mv的很多选项是跟cp共享的</p>
<h3 id="rm-删除文件和目录"><a href="#rm-删除文件和目录" class="headerlink" title="rm 删除文件和目录"></a>rm 删除文件和目录</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">rm item...</span><br></pre></td></tr></table></figure>
<p>rm用来删除一个或者多个条目</p>
<p><strong>==使用rm和通配符时，要注意有没有多打空格，可以先用ls试一下==</strong></p>
<p>rm相比cp，有一个选项不一样</p>
<p>-f， 忽略不存在的文件并无需提示确认</p>
<h3 id="ln-创建链接"><a href="#ln-创建链接" class="headerlink" title="ln 创建链接"></a>ln 创建链接</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ln file link</span><br></pre></td></tr></table></figure>
<p>用来创建硬链接</p>
<p>而</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">ln -s file link</span><br></pre></td></tr></table></figure>
<p>用来创建软链接</p>
<h2 id="命令的使用"><a href="#命令的使用" class="headerlink" title="命令的使用"></a>命令的使用</h2><h3 id="什么是命令"><a href="#什么是命令" class="headerlink" title="什么是命令"></a>什么是命令</h3><p>一条命令不外乎以下四种情况</p>
<ul>
<li>可执行程序</li>
<li>shell内置脚本</li>
<li>shell函数——shell函数是合并到环境变量中的小型shell脚本</li>
<li>alias命令——在其他命令的基础上自定义命令</li>
</ul>
<h3 id="识别命令"><a href="#识别命令" class="headerlink" title="识别命令"></a>识别命令</h3><h4 id="type-显示命令的类型"><a href="#type-显示命令的类型" class="headerlink" title="type 显示命令的类型"></a>type 显示命令的类型</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">type command</span><br></pre></td></tr></table></figure>
<p>实例如下</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:59:04]</span></span><br><span class="line">$ <span class="built_in">type</span> <span class="built_in">type</span></span><br><span class="line"><span class="built_in">type</span> is a shell <span class="built_in">builtin</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:16:20]</span></span><br><span class="line">$ <span class="built_in">type</span> ls</span><br><span class="line">ls is an <span class="built_in">alias</span> <span class="keyword">for</span> ls --color=tty</span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:16:25]</span></span><br><span class="line">$ <span class="built_in">type</span> cp</span><br><span class="line">cp is /bin/cp</span><br></pre></td></tr></table></figure>
<h4 id="which-显示可执行程序的位置"><a href="#which-显示可执行程序的位置" class="headerlink" title="which 显示可执行程序的位置"></a>which 显示可执行程序的位置</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">User@waynejing ~</span><br><span class="line">λ <span class="built_in">which</span> ls</span><br><span class="line">/usr/bin/ls</span><br><span class="line"> </span><br><span class="line">User@waynejing ~</span><br><span class="line">λ <span class="built_in">which</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">which</span>: no <span class="built_in">cd</span> <span class="keyword">in</span> (/c/Users/User/bin:/f/cmder/bin:/f/cmder/vendor/bin:/c/Program Files/Git/bin:/mingw64/bin:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/mingw64/bin:/usr/bin:/c/Users/User/bin:/f/cmder/vendor/conemu-maximus5/ConEmu/Scripts:/f/cmder/vendor/conemu-maximus5:/f/cmder/vendor/conemu-maximus5/ConEmu:/c/Python37/Scripts:/c/Python37:/c/Program Files (x86)/NetSarang/Xshell 6:/c/Program Files (x86)/Common Files/Oracle/Java/javapath:/c/WINDOWS/system32:/c/WINDOWS:/c/WINDOWS/System32/Wbem:/c/WINDOWS/System32/WindowsPowerShell/v1.0:/c/WINDOWS/System32/OpenSSH:/c/Program Files/NVIDIA Corporation/NVIDIA NvDLISR:/c/Program Files/Microsoft SQL Server/130/Tools/Binn:/c/Program Files/dotnet:/e/Program Files/Java/jdk1.8.0_201/bin:/e/Program Files/Java/jdk1.8.0_201/jre/bin:/c/Program Files/NVIDIA Corporation/NVIDIA NGX:/c/Program Files (x86)/NVIDIA Corporation/PhysX/Common:/c/Program Files/PuTTY:/c/WINDOWS/system32:/c/WINDOWS:/c/WINDOWS/System32/Wbem:/c/WINDOWS/System32/WindowsPowerShell/v1.0:/c/WINDOWS/System32/OpenSSH:/f/cmder:/c/Program Files/Microsoft Network Monitor 3:/c/Program Files/nodejs:/c/ProgramData/chocolatey/bin:/c/Program Files/Git/cmd:/f/Scoop/shims:/c/Users/User/AppData/Local/Microsoft/WindowsApps:/c/Users/User/AppData/Local/Programs/Microsoft VS Code/bin:/f/PyCharm Community Edition 2019.2.3/bin:/c/Users/User/AppData/Roaming/npm:/c/Users/User/AppData/Local/GitHubDesktop/bin:/c/Users/User/.babun:/f/cmder:/usr/bin/vendor_perl:/usr/bin/core_perl)</span><br></pre></td></tr></table></figure>
<p>只能对可执行程序用，对shell内置程序用会报错</p>
<h3 id="获得命令文档"><a href="#获得命令文档" class="headerlink" title="获得命令文档"></a>获得命令文档</h3><h4 id="help-获得shell内置命令的帮助文档"><a href="#help-获得shell内置命令的帮助文档" class="headerlink" title="help 获得shell内置命令的帮助文档"></a>help 获得shell内置命令的帮助文档</h4><p>bash给shell内置命令提供了一个内置帮助工具。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">User@waynejing ~</span><br><span class="line">λ <span class="built_in">help</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">cd</span>: <span class="built_in">cd</span> [-L|[-P [-e]] [-@]] [dir]</span><br><span class="line">    Change the shell working directory.</span><br><span class="line"> </span><br><span class="line">    Change the current directory to DIR.  The default DIR is the value of the</span><br><span class="line">    HOME shell variable.</span><br><span class="line"> </span><br><span class="line">    The variable CDPATH defines the search path <span class="keyword">for</span> the directory containing</span><br><span class="line">    DIR.  Alternative directory names <span class="keyword">in</span> CDPATH are separated by a colon (:).</span><br><span class="line">    A null directory name is the same as the current directory.  If DIR begins</span><br><span class="line">    with a slash (/), <span class="keyword">then</span> CDPATH is not used.</span><br><span class="line"> </span><br><span class="line">    If the directory is not found, and the shell option `cdable_vars<span class="string">' is set,</span></span><br><span class="line"><span class="string">    the word is assumed to be  a variable name.  If that variable has a value,</span></span><br><span class="line"><span class="string">    its value is used for DIR.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    Options:</span></span><br><span class="line"><span class="string">      -L        force symbolic links to be followed: resolve symbolic</span></span><br><span class="line"><span class="string">                links in DIR after processing instances of `..'</span></span><br><span class="line">      -P        use the physical directory structure without following</span><br><span class="line">                symbolic links: resolve symbolic links <span class="keyword">in</span> DIR before</span><br><span class="line">                processing instances of `..<span class="string">'</span></span><br><span class="line"><span class="string">      -e        if the -P option is supplied, and the current working</span></span><br><span class="line"><span class="string">                directory cannot be determined successfully, exit with</span></span><br><span class="line"><span class="string">                a non-zero status</span></span><br><span class="line"><span class="string">      -@        on systems that support it, present a file with extended</span></span><br><span class="line"><span class="string">                attributes as a directory containing the file attributes</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    The default is to follow symbolic links, as if `-L'</span> were specified.</span><br><span class="line">    `..<span class="string">' is processed by removing the immediately previous pathname component</span></span><br><span class="line"><span class="string">    back to a slash or the beginning of DIR.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    Exit Status:</span></span><br><span class="line"><span class="string">    Returns 0 if the directory is changed, and if $PWD is set successfully when</span></span><br><span class="line"><span class="string">    -P is used; non-zero otherwise.</span></span><br></pre></td></tr></table></figure>
<h4 id="—help-显示命令的使用信息"><a href="#—help-显示命令的使用信息" class="headerlink" title="—help 显示命令的使用信息"></a>—help 显示命令的使用信息</h4><p>很多可执行程序都支持<code>--help</code>选项</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:22:04] C:126</span></span><br><span class="line">$ mkdir --<span class="built_in">help</span></span><br><span class="line">Usage: mkdir [OPTION]... DIRECTORY...</span><br><span class="line">Create the DIRECTORY(ies), <span class="keyword">if</span> they <span class="keyword">do</span> not already exist.</span><br><span class="line"> </span><br><span class="line">Mandatory arguments to long options are mandatory <span class="keyword">for</span> short options too.</span><br><span class="line">  -m, --mode=MODE   <span class="built_in">set</span> file mode (as <span class="keyword">in</span> chmod), not a=rwx - <span class="built_in">umask</span></span><br><span class="line">  -p, --parents     no error <span class="keyword">if</span> existing, make parent directories as needed</span><br><span class="line">  -v, --verbose     <span class="built_in">print</span> a message <span class="keyword">for</span> each created directory</span><br><span class="line">  -Z                   <span class="built_in">set</span> SELinux security context of each created directory</span><br><span class="line">                         to the default <span class="built_in">type</span></span><br><span class="line">      --context[=CTX]  like -Z, or <span class="keyword">if</span> CTX is specified <span class="keyword">then</span> <span class="built_in">set</span> the SELinux</span><br><span class="line">                         or SMACK security context to CTX</span><br><span class="line">      --<span class="built_in">help</span>     display this <span class="built_in">help</span> and <span class="built_in">exit</span></span><br><span class="line">      --version  output version information and <span class="built_in">exit</span></span><br><span class="line"> </span><br><span class="line">GNU coreutils online <span class="built_in">help</span>: &lt;http://www.gnu.org/software/coreutils/&gt;</span><br><span class="line">Report mkdir translation bugs to &lt;http://translationproject.org/team/&gt;</span><br><span class="line">Full documentation at: &lt;http://www.gnu.org/software/coreutils/mkdir&gt;</span><br><span class="line">or available locally via: info <span class="string">'(coreutils) mkdir invocation'</span></span><br></pre></td></tr></table></figure>
<h4 id="man-显示程序的手册页"><a href="#man-显示程序的手册页" class="headerlink" title="man 显示程序的手册页"></a>man 显示程序的手册页</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">man ls</span><br></pre></td></tr></table></figure>
<p>man命令显示的手册文档被分成多个部分，不仅包括用户命令，也包括系统管理命令、程序接口和文件格式</p>
<h4 id="apropos-显示合适的命令"><a href="#apropos-显示合适的命令" class="headerlink" title="apropos 显示合适的命令"></a>apropos 显示合适的命令</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:36:03]</span></span><br><span class="line">$ apropos floppy</span><br><span class="line">fdformat (8)         - low-level format a floppy disk</span><br></pre></td></tr></table></figure>
<p>注意<code>man -k cmd</code>基本与此命令一样</p>
<h4 id="whatis-显示命令的简要描述"><a href="#whatis-显示命令的简要描述" class="headerlink" title="whatis 显示命令的简要描述"></a>whatis 显示命令的简要描述</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:39:08]</span></span><br><span class="line">$ whatis ls</span><br><span class="line">ls (1)               - list directory contents</span><br></pre></td></tr></table></figure>
<h4 id="info显示程序的info条目"><a href="#info显示程序的info条目" class="headerlink" title="info显示程序的info条目"></a>info显示程序的info条目</h4><p>我们平时讨论的大部分命令行程序都是GNU项目coreutils的一部分</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:49:32]</span></span><br><span class="line">$ info coreutils</span><br></pre></td></tr></table></figure>
<h4 id="README和其他程序文档文件"><a href="#README和其他程序文档文件" class="headerlink" title="README和其他程序文档文件"></a>README和其他程序文档文件</h4><p>一般存在<code>/usr/share/doc</code>目录中，其中大部分文档文件是以纯文本格式存储的。</p>
<h3 id="使用别名创建自己的命令"><a href="#使用别名创建自己的命令" class="headerlink" title="使用别名创建自己的命令"></a>使用别名创建自己的命令</h3><p>在开始之前，需要展示一个命令行的小技巧，使用封号来分割多条命令，就可以将多条命令输在一行</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">command1;command2;command3...</span><br></pre></td></tr></table></figure>
<p>比如</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [23:58:19]</span></span><br><span class="line">$ <span class="built_in">cd</span> /usr;ls;<span class="built_in">cd</span> -</span><br><span class="line">bin  games  include  lib  <span class="built_in">local</span>  sbin  share  src</span><br><span class="line">/mnt/c/Users/User</span><br></pre></td></tr></table></figure>
<p>现在我们通过<code>alias</code>命令将以上命令整合成一条新的命令。首先，给自定义的命令取一个名字。</p>
<p>通过<code>type</code>可以测试该命令名字是否用过，假设取名为test</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:36:54]</span></span><br><span class="line">$ <span class="built_in">type</span> <span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span> is a shell <span class="built_in">builtin</span></span><br></pre></td></tr></table></figure>
<p>可以看出，test这个名字已经被用过了，那么取另外一个名字 foo</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:39:09]</span></span><br><span class="line">$ <span class="built_in">type</span> foo</span><br><span class="line">foo not found</span><br></pre></td></tr></table></figure>
<p>接着，创建命令</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:39:56] C:1</span></span><br><span class="line">$ <span class="built_in">alias</span> foo=<span class="string">'cd /usr;ls;cd -'</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:41:10]</span></span><br><span class="line">$ foo</span><br><span class="line">bin  games  include  lib  <span class="built_in">local</span>  sbin  share  src</span><br><span class="line">/mnt/c/Users/User</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:41:20] </span></span><br><span class="line">$ <span class="built_in">type</span> foo                                              </span><br><span class="line">foo is an <span class="built_in">alias</span> <span class="keyword">for</span> <span class="built_in">cd</span> /usr;ls;<span class="built_in">cd</span> -                     </span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:42:22] </span></span><br><span class="line">$ <span class="built_in">unalias</span> foo                                           </span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:42:34] C:1</span></span><br><span class="line">$ <span class="built_in">type</span> foo                                              </span><br><span class="line">foo not found</span><br></pre></td></tr></table></figure>
<p>可以在shell的rc文件中自定义一些命令然后可以直接使用。</p>
<h2 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h2><h3 id="标准输入、标准输出和标准错误"><a href="#标准输入、标准输出和标准错误" class="headerlink" title="标准输入、标准输出和标准错误"></a>标准输入、标准输出和标准错误</h3><h4 id="标准输出重定向"><a href="#标准输出重定向" class="headerlink" title="标准输出重定向"></a>标准输出重定向</h4><p>使用重定向操作符 &gt; 后面接文件名，就可以将命令的输出内容保存到一个文件。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:50:22]</span></span><br><span class="line">$ ls -l /usr &gt; ls-output.txt</span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:50:30]</span></span><br><span class="line">$ cat ls-output.txt</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 bin</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr  1 21:56 games</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 include</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 lib</span><br><span class="line">drwxr-xr-x 1 root root 4096 Jul 25  2018 <span class="built_in">local</span></span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr  1 22:11 sbin</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 share</span><br><span class="line">drwxr-xr-x 1 root root 4096 Jul 25  2018 src</span><br></pre></td></tr></table></figure>
<p>‘&gt;’ 只会重定向标准输出，不会重定向标准错误，如果命令执行发生错误，实际上会清空 文件。</p>
<p>当然可以用&gt;&gt;来实现从文件的尾部进行添加</p>
<h4 id="标准错误重定向"><a href="#标准错误重定向" class="headerlink" title="标准错误重定向"></a>标准错误重定向</h4><p>一个程序可以将生成的输出内容发送到任意文件流中。将这些文件流的前三个分别对应标准输入文件、标准输出文件、标准错误文件，那么shell在内部用文件描述符分别索引他们为0,1,2. 因此可以用这种方式来重定向错误。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:50:57]</span></span><br><span class="line">$ ls -l /bin/usr 2&gt; ls-error.txt</span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:57:43] C:2</span></span><br><span class="line">$ cat ls-error.txt</span><br><span class="line">ls: cannot access <span class="string">'/bin/usr'</span>: No such file or directory</span><br></pre></td></tr></table></figure>
<h4 id="将标准输出和标准错误重定向到同一个文件"><a href="#将标准输出和标准错误重定向到同一个文件" class="headerlink" title="将标准输出和标准错误重定向到同一个文件"></a>将标准输出和标准错误重定向到同一个文件</h4><p>使用&amp;&gt;可以将标准输出和标准错误重定向到同一个文件</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:57:50]</span></span><br><span class="line">$ ls -l /bin/usr &amp;&gt; ls-error.txt</span><br></pre></td></tr></table></figure>
<h4 id="处理不想要的输出"><a href="#处理不想要的输出" class="headerlink" title="处理不想要的输出"></a>处理不想要的输出</h4><p>有些命令我们执行之后不希望得到输出，那么可以将其输出重定向到/dev/null来实现</p>
<p>称之为位桶(bit bucket)</p>
<h4 id="标准输入重定向"><a href="#标准输入重定向" class="headerlink" title="标准输入重定向"></a>标准输入重定向</h4><p>首先介绍一个命令，cat——合并文件</p>
<p>cat 命令读取一个或多个文件，并把他们复制到标准输出文件中，格式如下：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">cat [file...]</span><br></pre></td></tr></table></figure>
<p>如果我们直接输入cat会怎么样呢</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [23:00:45] C:2</span></span><br><span class="line">$ cat</span><br></pre></td></tr></table></figure>
<p>没有任何现象，只是停在那里不动，但是世界上，他正在从标准输入读取内容，由于标准输入在默认情况下</p>
<p>试一下以下输入</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [23:00:45] C:2</span></span><br><span class="line">$ cat</span><br><span class="line"><span class="built_in">test</span> message</span><br></pre></td></tr></table></figure>
<p>按下Ctrl - D告诉cat命令，已经到达了标准输入的文件尾(EOF)</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [23:00:45] C:2</span></span><br><span class="line">$ cat</span><br><span class="line"><span class="built_in">test</span> message</span><br><span class="line"><span class="built_in">test</span> message</span><br></pre></td></tr></table></figure>
<p>如果要将输入重定向，可以如下</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:25:05]</span></span><br><span class="line">$ cat &gt; test_msg.txt                                 </span><br><span class="line"><span class="built_in">test</span> message</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:25:32]</span></span><br><span class="line">$ cat test_msg.txt</span><br><span class="line"><span class="built_in">test</span> message</span><br></pre></td></tr></table></figure>
<p>使用&lt;可以将输入源变成test_msg.txt</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:26:30]</span></span><br><span class="line">$ cat &lt; test_msg.txt</span><br><span class="line"><span class="built_in">test</span> message</span><br></pre></td></tr></table></figure>
<h3 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h3><p>使用管道操作<code>|</code> 可以将一个命令的标准输出传送到另一个命令的标准输入中</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">command1 | command2</span><br></pre></td></tr></table></figure>
<p>使用less来进行演示</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:27:28]</span></span><br><span class="line">$ ls -lt /usr/bin | less</span><br></pre></td></tr></table></figure>
<h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h4><p>管道功能经常用来对数据进行复杂的操作，也可以吧多条命令合在一起构成一个管道。这种方式中用到的命令通常被称为过滤器(filter)</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:34:07]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | less</span><br></pre></td></tr></table></figure>
<h4 id="uniq-——报告或者忽略文件中重复的行"><a href="#uniq-——报告或者忽略文件中重复的行" class="headerlink" title="uniq ——报告或者忽略文件中重复的行"></a>uniq ——报告或者忽略文件中重复的行</h4><p>默认情况下，uniq会删除列表中的所有重复行</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:38:47]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | uniq | less</span><br></pre></td></tr></table></figure>
<p>如果想要查看重复行，在uniq后加-d</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:38:47]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | uniq -d | less</span><br></pre></td></tr></table></figure>
<h4 id="wc-——-打印行数、字数和字节数-word-count"><a href="#wc-——-打印行数、字数和字节数-word-count" class="headerlink" title="wc —— 打印行数、字数和字节数(word count)"></a>wc —— 打印行数、字数和字节数(word count)</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:38:47]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | uniq | wc</span><br><span class="line">   1932    1931   20123</span><br></pre></td></tr></table></figure>
<p>加-l可以只打印行数</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:41:41]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | uniq | wc -l</span><br><span class="line">1932</span><br></pre></td></tr></table></figure>
<h4 id="grep-——-打印匹配行"><a href="#grep-——-打印匹配行" class="headerlink" title="grep —— 打印匹配行"></a>grep —— 打印匹配行</h4><p>grep可以在文件中查找匹配文本</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">grep pattern [file...]</span><br></pre></td></tr></table></figure>
<p>在这里我们只关注简单的文本匹配</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:42:24]</span></span><br><span class="line">$ ls /bin /usr/bin | sort | uniq | grep zip           </span><br><span class="line">bunzip2                                               </span><br><span class="line">bzip2                                                 </span><br><span class="line">bzip2recover                                          </span><br><span class="line">funzip                                                </span><br><span class="line">gpg-zip                                               </span><br><span class="line">gunzip                                                </span><br><span class="line">gzip                                                  </span><br><span class="line">p7zip                                                 </span><br><span class="line">preunzip                                              </span><br><span class="line">prezip                                                </span><br><span class="line">prezip-bin                                            </span><br><span class="line">unzip                                                 </span><br><span class="line">unzipsfx                                              </span><br><span class="line">zip                                                   </span><br><span class="line">zipcloak                                              </span><br><span class="line">zipdetails                                            </span><br><span class="line">zipgrep                                               </span><br><span class="line">zipinfo                                               </span><br><span class="line">zipnote                                               </span><br><span class="line">zipsplit</span><br></pre></td></tr></table></figure>
<p>grep存在一对方便地选项 ：-i该选项可使grep在搜索时忽略大小写；-v，可以使grep只输出和模式不匹配的行</p>
<h4 id="head-tail-——打印文件的开头部分-结尾部分"><a href="#head-tail-——打印文件的开头部分-结尾部分" class="headerlink" title="head/tail ——打印文件的开头部分/结尾部分"></a>head/tail ——打印文件的开头部分/结尾部分</h4><p>默认情况下，head/tail将打印文件开头/结尾的10行，可以通过-n来控制行数</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:47:04] C:1</span></span><br><span class="line">$ head -n 5 ls-output.txt</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 bin</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr  1 21:56 games</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 include</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 lib</span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:47:16]</span></span><br><span class="line">$ tail -n 5 ls-output.txt</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 lib</span><br><span class="line">drwxr-xr-x 1 root root 4096 Jul 25  2018 <span class="built_in">local</span></span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr  1 22:11 sbin</span><br><span class="line">drwxr-xr-x 1 root root 4096 Apr 14 19:49 share</span><br><span class="line">drwxr-xr-x 1 root root 4096 Jul 25  2018 src</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:47:50]</span></span><br><span class="line">$ ls /usr/bin | tail -n 5                          </span><br><span class="line">zipnote                                            </span><br><span class="line">zipsplit                                           </span><br><span class="line">zjsdecode                                          </span><br><span class="line">zlib-flate                                         </span><br><span class="line">zsh</span><br></pre></td></tr></table></figure>
<p>tail有一个选项可以用来实时查看正在被写入的日志文件，假设我们要看/var/log/kern.log</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:48:42]</span></span><br><span class="line">$ tail -f /var/<span class="built_in">log</span>/kern.log</span><br></pre></td></tr></table></figure>
<h4 id="tee-——从stdin读取数据，并同时输出到stdout和文件"><a href="#tee-——从stdin读取数据，并同时输出到stdout和文件" class="headerlink" title="tee ——从stdin读取数据，并同时输出到stdout和文件"></a>tee ——从stdin读取数据，并同时输出到stdout和文件</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:51:57]          </span></span><br><span class="line">$ ls /usr/bin | grep zip |tee ls.txt                             </span><br><span class="line">funzip                                                           </span><br><span class="line">gpg-zip                                                          </span><br><span class="line">p7zip                                                            </span><br><span class="line">preunzip                                                         </span><br><span class="line">prezip                                                           </span><br><span class="line">prezip-bin                                                       </span><br><span class="line">unzip                                                            </span><br><span class="line">unzipsfx                                                         </span><br><span class="line">zip                                                              </span><br><span class="line">zipcloak                                                         </span><br><span class="line">zipdetails                                                       </span><br><span class="line">zipgrep                                                          </span><br><span class="line">zipinfo                                                          </span><br><span class="line">zipnote                                                          </span><br><span class="line">zipsplit                                                         </span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:52:20]          </span></span><br><span class="line">$ cat ls.txt                                                     </span><br><span class="line">funzip                                                           </span><br><span class="line">gpg-zip                                                          </span><br><span class="line">p7zip                                                            </span><br><span class="line">preunzip                                                         </span><br><span class="line">prezip                                                           </span><br><span class="line">prezip-bin                                                       </span><br><span class="line">unzip                                                            </span><br><span class="line">unzipsfx                                                         </span><br><span class="line">zip                                                              </span><br><span class="line">zipcloak                                                         </span><br><span class="line">zipdetails                                                       </span><br><span class="line">zipgrep                                                          </span><br><span class="line">zipinfo                                                          </span><br><span class="line">zipnote                                                          </span><br><span class="line">zipsplit</span><br></pre></td></tr></table></figure>
<h2 id="透过shell看世界"><a href="#透过shell看世界" class="headerlink" title="透过shell看世界"></a>透过shell看世界</h2><h3 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><p>每次输入命令行按下enter时， bash都会在执行命令之前对文本进行多重处理。产生这个结果的处理过程称作拓展。</p>
<p>有了拓展功能，在输入内容之后，这些内容将在shell对其执行之前被拓展成其他内容。以echo为例</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~/Desktop/jingwen_dev [21:41:04] C:127</span></span><br><span class="line">$ <span class="built_in">echo</span> this is a <span class="built_in">test</span></span><br><span class="line">this is a <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>这个例子相当简单，所有传给echo的输入都被输出</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~/Desktop/jingwen_dev [21:50:27]</span></span><br><span class="line">$ <span class="built_in">echo</span> *</span><br><span class="line">change.sh install.sh 学习Shell.md</span><br></pre></td></tr></table></figure>
<p>为什么这里echo不是输出“*”呢？</p>
<p>因为shell会在执行echo之前先把<code>*</code>字符拓展为所有符合的字符</p>
<h4 id="路径名拓展"><a href="#路径名拓展" class="headerlink" title="路径名拓展"></a>路径名拓展</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [21:54:04]</span></span><br><span class="line">$ ls</span><br><span class="line">Applications                  Documents                     Movies                        Public                        fama-french regression1.ipynb</span><br><span class="line">Applications (Parallels)      Downloads                     Music                         Untitled.ipynb                iCloud 云盘（归档）</span><br><span class="line">Desktop                       Library                       Pictures                      Untitled1.ipynb</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [21:54:10]</span></span><br><span class="line">$ <span class="built_in">echo</span> D*</span><br><span class="line">Desktop Documents Downloads</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [21:54:20]</span></span><br><span class="line">$ <span class="built_in">echo</span> *s</span><br><span class="line">Applications Documents Downloads Movies Pictures</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [21:54:28]</span></span><br><span class="line">$ <span class="built_in">echo</span> [[:upper:]]*</span><br><span class="line">Applications Applications (Parallels) Desktop Documents Downloads Library Movies Music Pictures Public Untitled.ipynb Untitled1.ipynb</span><br></pre></td></tr></table></figure>
<p>查看除了主目录之外的目录</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [21:54:43]</span></span><br><span class="line">$ <span class="built_in">echo</span> /usr/*/share</span><br><span class="line">/usr/<span class="built_in">local</span>/share</span><br></pre></td></tr></table></figure>
<p><strong>隐藏文件的路径名拓展</strong></p>
<p>众所周知，以<code>.</code>开头的文件都将被隐藏。这么理解的话似乎使用<code>echo .*</code>就可以显示出隐藏文件。但是实际上文件名<code>.</code>和<code>..</code>也被显示了出来，分别表示当前目录和父目录，此时要执行以下命令</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:02:35] C:1</span></span><br><span class="line">$ ls -d .[^.]*</span><br><span class="line">.CFUserTextEncoding                 .bash_sessions                      .gem                                .oracle_jre_usage</span><br><span class="line">.DS_Store                           .bashrc                             .ipynb_checkpoints                  .viminfo</span><br><span class="line">.ShadowsocksX-NG                    .conda                              .ipython                            .vscode</span><br><span class="line">.Trash                              .condarc                            .jupyter                            .zcompdump-Jerrie的MacBook Air-5.3</span><br><span class="line">.anaconda                           .cups                               .lesshst                            .zcompdump-Jerrie的MacBook Air-5.8</span><br><span class="line">.bash_history                       .fzf.bash                           .matplotlib                         .zsh_history</span><br><span class="line">.bash_profile                       .fzf.zsh                            .oh-my-zsh                          .zshrc</span><br></pre></td></tr></table></figure>
<h4 id="波浪线拓展"><a href="#波浪线拓展" class="headerlink" title="波浪线拓展"></a>波浪线拓展</h4><p>回顾前面的介绍，你会发现波浪线字符<code>~</code>具有特殊的含义。如果将其放在一个单词的开头，那么他拓展为对应的用户的主目录</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:02:42]</span></span><br><span class="line">$ <span class="built_in">echo</span> ~jerriechen</span><br><span class="line">/Users/jerriechen</span><br></pre></td></tr></table></figure>
<h4 id="算数拓展"><a href="#算数拓展" class="headerlink" title="算数拓展"></a>算数拓展</h4><p>shell支持将拓展用来运行算术表达式</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:07:12]</span></span><br><span class="line">$ <span class="built_in">echo</span> $((2+2))</span><br><span class="line">4</span><br></pre></td></tr></table></figure>
<p>算术拓展格式如下(只支持<strong><em>整数</em></strong>)</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$((expression))</span><br></pre></td></tr></table></figure>
<p>空格在算术表达式中是没有意义的</p>
<h4 id="花括号拓展"><a href="#花括号拓展" class="headerlink" title="花括号拓展"></a>花括号拓展</h4><p>用于花括号拓展的模式信息可以包含一个称为前导字符(preamble)的开头部分和一个称为附言(postscript)的结尾部分。花括号表达式本身可以包含一系列逗号分隔的字符串，也可以包含一系列整数或者单个字符。示例如下：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:07:19]</span></span><br><span class="line">$ <span class="built_in">echo</span> Front-&#123;A,B,C&#125;-Back</span><br><span class="line">Front-A-Back Front-B-Back Front-C-Back</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:15:02]</span></span><br><span class="line">$ <span class="built_in">echo</span> Num_&#123;1..5&#125;</span><br><span class="line">Num_1 Num_2 Num_3 Num_4 Num_5</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:15:14]</span></span><br><span class="line">$ <span class="built_in">echo</span> &#123;Z..A&#125;</span><br><span class="line">Z Y X W V U T S R Q P O N M L K J I H G F E D C B A</span><br><span class="line"> </span><br><span class="line"><span class="comment"># jerriechen @ 192 in ~ [22:15:27]</span></span><br><span class="line">$ <span class="built_in">echo</span> a&#123;A&#123;1..5&#125;,B&#123;1..5&#125;&#125;b</span><br><span class="line">aA1b aA2b aA3b aA4b aA5b aB1b aB2b aB3b aB4b aB5b</span><br></pre></td></tr></table></figure>
<h4 id="参数拓展"><a href="#参数拓展" class="headerlink" title="参数拓展"></a>参数拓展</h4><p>很多系统内的变量可以用来进行拓展</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:22:04]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$USER</span></span><br><span class="line">waynejing</span><br></pre></td></tr></table></figure>
<p>想查看可用的变量列表可以用以下指令</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:33:13]</span></span><br><span class="line">$ printenv | less</span><br></pre></td></tr></table></figure>
<p>对其他的拓展类型来说，如果你误输入了一个模式，就不会发生拓展，这时echo命令将知识显示这些误输入的模式信息。但是对于参数拓展来说，如果变量名拼写错误，仍然会进行拓展，只不过结果是输出一个空字符而已。</p>
<h4 id="命令替换"><a href="#命令替换" class="headerlink" title="命令替换"></a>命令替换</h4><p>命令替换可以把一个命令的输出作为一个拓展模式来使用。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in ~ [22:38:23]</span></span><br><span class="line">$ <span class="built_in">echo</span> $(ls)                   </span><br><span class="line">Desktop Documents Downloads Music OpratingSystemCode Pictures Public Templates Videos fonts thinclient_drives</span><br></pre></td></tr></table></figure>
<p>一个比较常用的方式是</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in ~ [22:38:25]</span></span><br><span class="line">$ ls -l $(<span class="built_in">which</span> cp)</span><br><span class="line">-rwxr-xr-x 1 root root 141528 Jan 18  2018 /bin/cp</span><br></pre></td></tr></table></figure>
<p>将which cp的运行结果作为ls的一个参数。</p>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><h4 id="双引号"><a href="#双引号" class="headerlink" title="双引号"></a>双引号</h4><p>将文本放在双引号中，那么shell使用的所有特殊字符都将失去他们的特殊含义，会被看做普通字符。字符<code>$\&#39;</code>除外。 意味着单词分割、路径名拓展、波浪线拓展和花括号拓展将失效，但是参数拓展、算术拓展仍然生效。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:31:58]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$USER</span> <span class="variable">$((2+2)</span>) <span class="variable">$(cal)</span>"</span>                     </span><br><span class="line">waynejing 4       May 2020                         </span><br><span class="line">Su Mo Tu We Th Fr Sa                               </span><br><span class="line">                1  2                               </span><br><span class="line"> 3  4  5  6  7  8  9                               </span><br><span class="line">10 11 12 13 14 15 16                               </span><br><span class="line">17 18 19 20 21 22 23                               </span><br><span class="line">24 25 26 27 28 29 30                               </span><br><span class="line">31</span><br></pre></td></tr></table></figure>
<p>加上双引号之后，单词分割功能将会失效，嵌入的空格将不再被当成界定符，而是被当成参数的一部分。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:33:17]                           </span></span><br><span class="line">$ <span class="built_in">echo</span> $(cal)</span><br><span class="line">May 2020 Su Mo Tu We Th Fr Sa 1 2  3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31</span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:36:24]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$(cal)</span>"</span>          </span><br><span class="line">      May 2020            </span><br><span class="line">Su Mo Tu We Th Fr Sa      </span><br><span class="line">                1  2     </span><br><span class="line"> 3  4  5  6  7  8  9      </span><br><span class="line">10 11 12 13 14 15 16       </span><br><span class="line">17 18 19 20 21 22 23      </span><br><span class="line">24 25 26 27 28 29 30      </span><br><span class="line">31</span><br></pre></td></tr></table></figure>
<h4 id="单引号"><a href="#单引号" class="headerlink" title="单引号"></a>单引号</h4><p>如果要抑制所有拓展的话就使用单引号。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:36:34]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$USER</span>                                       </span><br><span class="line">waynejing                                          </span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:41:22]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'$USER'</span>                                     </span><br><span class="line"><span class="variable">$USER</span></span><br></pre></td></tr></table></figure>
<h4 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h4><p>有时候只是要引用单个字符，此时可以在字符前加上反斜杠。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:43:34]</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"\$5.000 <span class="variable">$USER</span>"</span></span><br><span class="line"><span class="variable">$5</span>.000 waynejing</span><br></pre></td></tr></table></figure>
<p>转义字符也常用来消除文件名中某个字符的特殊含义。字符包括 <code>$!&amp;</code> 空格等。</p>
<h2 id="高级键盘技巧"><a href="#高级键盘技巧" class="headerlink" title="高级键盘技巧"></a>高级键盘技巧</h2><h3 id="编辑命令行"><a href="#编辑命令行" class="headerlink" title="编辑命令行"></a>编辑命令行</h3><h4 id="光标移动-1"><a href="#光标移动-1" class="headerlink" title="光标移动"></a>光标移动</h4><div class="table-container">
<table>
<thead>
<tr>
<th>组合键</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ctrl+A</td>
<td>移动光标到行首</td>
</tr>
<tr>
<td>Ctrl+E</td>
<td>移动光标到行尾</td>
</tr>
<tr>
<td>Ctrl+F</td>
<td>光标向前移动一个字符</td>
</tr>
<tr>
<td>Ctrl+B</td>
<td>光标向后移动一个字符</td>
</tr>
<tr>
<td>Alt+F</td>
<td>光标向前移动一个字</td>
</tr>
<tr>
<td>Alt+B</td>
<td>光标向后移动一个字</td>
</tr>
<tr>
<td>Ctrl+L</td>
<td>清屏并把光标移到左上角；clear可以完成相同的工作</td>
</tr>
</tbody>
</table>
</div>
<h4 id="剪切和粘贴"><a href="#剪切和粘贴" class="headerlink" title="剪切和粘贴"></a>剪切和粘贴</h4><div class="table-container">
<table>
<thead>
<tr>
<th>组合键</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ctrl+K</td>
<td>剪切从光标到行位的文本</td>
</tr>
<tr>
<td>Ctrl+U</td>
<td>剪切从光标到行首的文本</td>
</tr>
<tr>
<td>Alt+D</td>
<td>剪切从光标到当前词尾的文本</td>
</tr>
<tr>
<td>Alt+Backspace</td>
<td>剪切从光标到词头的文本，如果光标在一个单词的开头，则剪切前一个单词</td>
</tr>
<tr>
<td>Ctrl+Y</td>
<td>将kill-ring缓冲区的文本粘贴到光标位置</td>
</tr>
</tbody>
</table>
</div>
<p><strong>元键（meta-Key）</strong>  一般来说是ALT</p>
<h3 id="自动补齐功能"><a href="#自动补齐功能" class="headerlink" title="自动补齐功能"></a>自动补齐功能</h3><p>tab 自动补齐</p>
<h3 id="使用历史命令"><a href="#使用历史命令" class="headerlink" title="使用历史命令"></a>使用历史命令</h3><p>偏向于使用 fzf配合快捷键Ctrl+R来。</p>
<h2 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h2><h3 id="所有者-组成员和其他所有用户"><a href="#所有者-组成员和其他所有用户" class="headerlink" title="所有者 组成员和其他所有用户"></a>所有者 组成员和其他所有用户</h3><p>当试图查看类似/etc/shadow的文件时，会遇到以下的问题</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [15:43:46]</span></span><br><span class="line">$ file /etc/shadow</span><br><span class="line">/etc/shadow: regular file, no <span class="built_in">read</span> permission</span><br></pre></td></tr></table></figure>
<p>产生这种错误信息的原因是，作为一个普通用户，没有读取这个文件的权限。</p>
<p>在unix术语中，所有用户是指整个世界(world)。使用id命令可以获得用户身份标识的相关信息</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:11:42]</span></span><br><span class="line">$ id</span><br><span class="line">uid=1000(waynejing) gid=1000(waynejing) groups=1000(waynejing),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),108(lxd),114(netdev)</span><br></pre></td></tr></table></figure>
<p>再创建用户账户的时候，用户将被分配到一个uid，为了符合人们的使用习惯，uid和用户名一一对应，同时用户将被分配一个有效的primary group id(gid) 而且该用户也可以归属于其他组</p>
<p>在ubuntu中uid从1000开始，而fedora中，用户从500开始</p>
<p>用户账户定义在文件/etc/passwd中，而用户组定义在/etc/group文件中。在创建用户账户和群组时，这些文件随着文件/etc/shadow的变动而改变，文件/etc/shadow中保存了用户的密码信息。</p>
<h3 id="读取、写入和执行"><a href="#读取、写入和执行" class="headerlink" title="读取、写入和执行"></a>读取、写入和执行</h3><p>对文件和目录的访问权限是按照读访问、写访问以及执行访问来定义的。当我们查看ls命令的输出结果时，可以得到一些线索。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:25:56] C:130</span></span><br><span class="line">$ <span class="built_in">echo</span> &gt; foo.txt</span><br><span class="line"> </span><br><span class="line"><span class="comment"># waynejing @ waynejing in /mnt/c/Users/User [22:25:59]</span></span><br><span class="line">$ ls -l foo.txt</span><br><span class="line">-rwxrwxrwx 1 waynejing waynejing 1 May  7 22:25 foo.txt</span><br></pre></td></tr></table></figure>
<p>输出结果的前10个字符表示的是文件属性，详见<a href="#进一步了解长列表格式">进一步了解长列表格式</a></p>
<h4 id="chmod-——更改文件模式"><a href="#chmod-——更改文件模式" class="headerlink" title="chmod ——更改文件模式"></a>chmod ——更改文件模式</h4><p>我们可以用chmod命令来更改文件或者目录的权限</p>
<p>chmod支持用两种不同的方式改变文件模式——八进制数字表示法和符号表示法</p>
<p>常用的八进制改文件模式为7(rwx)、6(rw-)、5(r-x)、4(r–)、0(—)</p>
<p>符号表示法则有u(文件或者目录的所有者)、g(文件所属的群组)、o(others其他所有用户)、a(all)，默认是a</p>
<p>+表示添加一种权限，-表示删掉一种权限，=表示只有指定的权限可用其他权限都被删除</p>
<h4 id="umask-——设置默认权限"><a href="#umask-——设置默认权限" class="headerlink" title="umask ——设置默认权限"></a>umask ——设置默认权限</h4><h3 id="更改身份"><a href="#更改身份" class="headerlink" title="更改身份"></a>更改身份</h3><h4 id="su——以其他用户和组id来运行shell"><a href="#su——以其他用户和组id来运行shell" class="headerlink" title="su——以其他用户和组id来运行shell"></a>su——以其他用户和组id来运行shell</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">su [user]</span><br></pre></td></tr></table></figure>
<p>也可以用su -c来执行单个命令</p>
<h4 id="sudo-——-以另一个用户身份执行命令"><a href="#sudo-——-以另一个用户身份执行命令" class="headerlink" title="sudo —— 以另一个用户身份执行命令"></a>sudo —— 以另一个用户身份执行命令</h4><h4 id="chown-更改文件所有者和所属群组"><a href="#chown-更改文件所有者和所属群组" class="headerlink" title="chown 更改文件所有者和所属群组"></a>chown 更改文件所有者和所属群组</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">chown [owner][:[group]] file ...</span><br></pre></td></tr></table></figure>
<h4 id="chgrp-——更改文件所属的群组"><a href="#chgrp-——更改文件所属的群组" class="headerlink" title="chgrp ——更改文件所属的群组"></a>chgrp ——更改文件所属的群组</h4><h3 id="更改用户的密码"><a href="#更改用户的密码" class="headerlink" title="更改用户的密码"></a>更改用户的密码</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">passwd [user]</span><br></pre></td></tr></table></figure>
<h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><h3 id="进程如何工作"><a href="#进程如何工作" class="headerlink" title="进程如何工作"></a>进程如何工作</h3><p>系统启动时，内核先把他的一些程序初始化为进程，然后运行一个称为init的程序。init程序将依次运行一系列称为init script的脚本(放在/etc目录下)这些脚本将会启动所有的系统服务。其中的很多服务都是通过守护进程(daemon program)来实现的。一个程序的运行会触发另一个程序，称为父进程创建子进程。init的进程ID<strong>始终为1</strong>。</p>
<h4 id="使用ps命令来查看进程信息"><a href="#使用ps命令来查看进程信息" class="headerlink" title="使用ps命令来查看进程信息"></a>使用ps命令来查看进程信息</h4><p>最简单的使用格式如下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> wayne @ wayne <span class="keyword">in</span> ~ [17:35:55]</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ps</span></span><br><span class="line">    PID TTY          TIME CMD</span><br><span class="line">   4245 pts/3    00:00:00 zsh</span><br><span class="line">   4273 pts/3    00:00:00 ps</span><br></pre></td></tr></table></figure>
<p>TTY 表示进程的控制终端，UNIX表示了进程的运行时间，TIME字段表示进程消耗的CPU时间总和。</p>
<p>使用x选项，可以看到更多信息</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:35:57]</span></span><br><span class="line">$ ps x</span><br><span class="line">    PID TTY      STAT   TIME COMMAND</span><br><span class="line">   1170 ?        Ss     0:00 /usr/lib/systemd/systemd --user</span><br><span class="line">   1171 ?        S      0:00 (sd-pam)</span><br><span class="line">   1183 ?        Sl     0:00 /usr/bin/kwalletd5 --pam-login 7 3</span><br><span class="line">   1184 ?        Sl     0:00 /usr/bin/startplasma-x11</span><br><span class="line">   1192 ?        Ss     0:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only</span><br><span class="line">   1204 ?        S      0:00 /usr/lib/kf5/start_kdeinit --kded +kcminit_startup</span><br><span class="line">   1205 ?        Ss     0:00 kdeinit5: Running...</span><br><span class="line">   1207 ?        Sl     0:00 /usr/lib/kf5/klauncher --fd=9</span><br><span class="line">   1211 ?        Sl     0:02 kded5</span><br><span class="line">   1229 ?        Sl     0:01 /usr/bin/kaccess</span><br><span class="line">   1239 ?        Sl     0:00 /usr/bin/plasma_session</span><br><span class="line">   1246 ?        Sl     0:01 /usr/bin/ksmserver</span><br><span class="line">   1248 ?        Sl     0:00 /usr/bin/kglobalaccel5</span><br><span class="line">   1258 ?        Sl     0:00 /usr/lib/dconf-service</span><br><span class="line">   1265 ?        Sl     2:06 /usr/bin/kwin_x11</span><br><span class="line">   1267 ?        SNl    0:00 /usr/bin/baloo_file</span><br><span class="line">   1269 ?        Sl     1:23 /usr/bin/plasmashell</span><br><span class="line">   1271 ?        Sl     0:00 /usr/bin/xembedsniproxy</span><br><span class="line">   1275 ?        Sl     0:00 /usr/lib/polkit-kde-authentication-agent-1</span><br><span class="line">   1307 ?        Sl     0:01 /usr/lib/kdeconnectd</span><br><span class="line">   1309 ?        Sl     1:37 /usr/bin/latte-dock</span><br><span class="line">   1315 ?        Sl     0:00 /usr/bin/gmenudbusmenuproxy</span><br><span class="line">   1316 ?        S&lt;sl   0:44 /usr/bin/pulseaudio --daemonize=no</span><br><span class="line">   1320 ?        Sl     0:04 /usr/bin/yakuake</span><br></pre></td></tr></table></figure>
<p>x 告诉 ps 去显示所有的进程，而不关注是由哪个终端所控制的。 ？就表示没有控制终端，是后台程序</p>
<p>STAT显示的是进程的运行状态</p>
<p>另一个常用组合是</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:39:11]</span></span><br><span class="line">$ ps aux</span><br><span class="line">USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root           1  0.0  0.0 173808 11140 ?        Ss   16:21   0:00 /sbin/init</span><br><span class="line">root           2  0.0  0.0      0     0 ?        S    16:21   0:00 [kthreadd]</span><br><span class="line">root           3  0.0  0.0      0     0 ?        I&lt;   16:21   0:00 [rcu_gp]</span><br><span class="line">root           4  0.0  0.0      0     0 ?        I&lt;   16:21   0:00 [rcu_par_gp]</span><br><span class="line">root           6  0.0  0.0      0     0 ?        I&lt;   16:21   0:00 [kworker/0:0H-kblockd]</span><br><span class="line">root           8  0.0  0.0      0     0 ?        I&lt;   16:21   0:00 [mm_percpu_wq]</span><br><span class="line">root           9  0.0  0.0      0     0 ?        S    16:21   0:00 [ksoftirqd/0]</span><br><span class="line">root          10  0.0  0.0      0     0 ?        S    16:21   0:00 [rcuc/0]</span><br><span class="line">root          11  0.0  0.0      0     0 ?        I    16:21   0:02 [rcu_preempt]</span><br><span class="line">root          12  0.0  0.0      0     0 ?        S    16:21   0:00 [rcub/0]</span><br><span class="line">root          13  0.0  0.0      0     0 ?        S    16:21   0:00 [migration/0]</span><br><span class="line">root          14  0.0  0.0      0     0 ?        S    16:21   0:00 [idle_inject/0]</span><br><span class="line">root          15  0.0  0.0      0     0 ?        I    16:21   0:00 [kworker/0:1-events]</span><br><span class="line">root          16  0.0  0.0      0     0 ?        S    16:21   0:00 [cpuhp/0]</span><br><span class="line">root          17  0.0  0.0      0     0 ?        S    16:21   0:00 [cpuhp/1]</span><br><span class="line">root          18  0.0  0.0      0     0 ?        S    16:21   0:00 [idle_inject/1]</span><br></pre></td></tr></table></figure>
<h4 id="使用top命令动态查看进程信息"><a href="#使用top命令动态查看进程信息" class="headerlink" title="使用top命令动态查看进程信息"></a>使用top命令动态查看进程信息</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:43:50]</span></span><br><span class="line">$ top</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">op - 17:44:24 up  1:22,  5 users,  load average: 0.18, 0.12, 0.21</span><br><span class="line">任务: 226 total,   1 running, 225 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu(s):  5.4 us,  1.8 sy,  0.0 ni, 92.4 id,  0.0 wa,  0.2 hi,  0.1 si,  0.0 st</span><br><span class="line">MiB Mem :  15934.2 total,  11850.4 free,   1857.4 used,   2226.4 buff/cache</span><br><span class="line">MiB Swap:      0.0 total,      0.0 free,      0.0 used.  13200.3 avail Mem</span><br><span class="line"> </span><br><span class="line"> 进程号 USER      PR  NI    VIRT    RES    SHR    %CPU  %MEM     TIME+ COMMAND                                                       </span><br><span class="line">   1896 wayne      0 -20   12.0g 344520 256012 S  32.2   2.1  10:23.15 nxnode.bin                                                    </span><br><span class="line">   4237 wayne     20   0  746652 113088  83668 S  10.3   0.7   0:03.66 konsole                                                       </span><br><span class="line">   2237 wayne      0 -20 2239112  92948  24540 S   8.6   0.6   1:05.64 nxnode.bin                                                    </span><br><span class="line">    857 root      20   0 1020388 224860 170844 S   7.0   1.4   3:01.83 Xorg                                                          </span><br><span class="line">   1265 wayne     20   0 3477284 198200 140680 S   6.0   1.2   2:08.58 kwin_x11                                                      </span><br><span class="line">   1316 wayne      9 -11 1101908  14372  10688 S   1.7   0.1   0:47.90 pulseaudio                                                    </span><br><span class="line">    475 root     -51   0       0      0      0 S   1.3   0.0   0:12.18 irq/129-iwlwifi                                               </span><br><span class="line">   1346 wayne     20   0  292504  47300  40140 S   0.3   0.3   0:01.64 msm_kde_notifie                                               </span><br><span class="line">      1 root      20   0  173808  11140   8368 S   0.0   0.1   0:00.84 systemd                                                       </span><br><span class="line">      2 root      20   0       0      0      0 S   0.0   0.0   0:00.00 kthreadd                                                      </span><br><span class="line">      3 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_gp                                                        </span><br><span class="line">      4 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 rcu_par_gp                                                    </span><br><span class="line">      6 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 kworker/0:0H-kblockd                                          </span><br><span class="line">      8 root       0 -20       0      0      0 I   0.0   0.0   0:00.00 mm_percpu_wq                                                  </span><br><span class="line">      9 root      20   0       0      0      0 S   0.0   0.0   0:00.15 ksoftirqd/0                                                   </span><br><span class="line">     10 root      -2   0       0      0      0 S   0.0   0.0   0:00.00 rcuc/0</span><br></pre></td></tr></table></figure>
<h3 id="控制进程"><a href="#控制进程" class="headerlink" title="控制进程"></a>控制进程</h3><p>使用xlogo小程序作为实验对象</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:46:32]</span></span><br><span class="line">$ xlogo</span><br></pre></td></tr></table></figure>
<h4 id="中断进程"><a href="#中断进程" class="headerlink" title="中断进程"></a>中断进程</h4><p>使用ctrl-C xlogo将会关闭，<strong>但是不是所有的命令行程序都可以用这个方式来实现中断</strong></p>
<h4 id="使进程在后台运行"><a href="#使进程在后台运行" class="headerlink" title="使进程在后台运行"></a>使进程在后台运行</h4><p>可以在运次那个程序时命令后面加上&amp;来实现</p>
<p>此时使用ps就会看见</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:51:22]</span></span><br><span class="line">$ ps</span><br><span class="line">    PID TTY          TIME CMD</span><br><span class="line">   4245 pts/3    00:00:00 zsh</span><br><span class="line">   5280 pts/3    00:00:00 xlogo</span><br><span class="line">   5288 pts/3    00:00:00 ps</span><br></pre></td></tr></table></figure>
<p>使用 jobs 命令也能看见<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:51:32]</span></span><br><span class="line">$ <span class="built_in">jobs</span></span><br><span class="line">[1]  + running    xlogo</span><br></pre></td></tr></table></figure></p>
<h4 id="进程回到前台运行"><a href="#进程回到前台运行" class="headerlink" title="进程回到前台运行"></a>进程回到前台运行</h4><p>后台运行的进程不会受到任何键盘输入的影响，Ctrl-C也没用，要让他回到前台运行可以使用 fg<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:51:32]</span></span><br><span class="line">$ <span class="built_in">jobs</span></span><br><span class="line">[1]  + running    xlogo</span><br><span class="line"> </span><br><span class="line"><span class="comment"># wayne @ wayne in ~ [17:52:35]</span></span><br><span class="line">$ <span class="built_in">fg</span> %1</span><br><span class="line">[1]  + 5280 running    xlogo</span><br></pre></td></tr></table></figure></p>
<p>通过在fg 后面加上jobs的job编号 使程序回到前台，此时ctrl-c可以终止命令</p>
<h4 id="暂停进程"><a href="#暂停进程" class="headerlink" title="暂停进程"></a>暂停进程</h4><p>暂停前台进程 使用 Ctrl- Z</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:55:12] C:130</span></span><br><span class="line">$ xlogo</span><br><span class="line">Warning: Cannot convert string <span class="string">"xlogo32"</span> to <span class="built_in">type</span> Pixmap</span><br><span class="line">^Z</span><br><span class="line">[1]  + 18857 suspended  xlogo</span><br></pre></td></tr></table></figure>
<p>这个时候，我们可以使用fg让进程在前台恢复运行，或者用 bg 使进程转到后台运行</p>
<h3 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h3><p>kill 命令 通常用来终止 进程<br><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [17:59:57] C:130</span></span><br><span class="line">$ xlogo &amp;</span><br><span class="line">[1] 18926</span><br><span class="line">Warning: Cannot convert string <span class="string">"xlogo32"</span> to <span class="built_in">type</span> Pixmap                                                                              </span><br><span class="line"> </span><br><span class="line"><span class="comment"># wayne @ wayne in ~ [18:00:01]</span></span><br><span class="line">$ <span class="built_in">kill</span> 18926</span><br><span class="line">[1]  + 18926 terminated  xlogo</span><br></pre></td></tr></table></figure><br>可以用PID来指定进程，也可以用job编号来指定</p>
<p>实际上kill 命令并不是“杀死”了进程，而是给进程发送中断信号，程序接到中断信号之后终止</p>
<h4 id="使用kill命令发送信号到进程"><a href="#使用kill命令发送信号到进程" class="headerlink" title="使用kill命令发送信号到进程"></a>使用kill命令发送信号到进程</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">kill</span> -(signal) PID</span><br></pre></td></tr></table></figure>
<p>signal 的 种类如下</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [18:10:22] C:1</span></span><br><span class="line">$ <span class="built_in">kill</span> -l</span><br><span class="line">HUP INT QUIT ILL TRAP ABRT BUS FPE KILL USR1 SEGV USR2 PIPE ALRM TERM STKFLT CHLD CONT STOP TSTP TTIN TTOU URG XCPU XFSZ VTALRM PROF WINCH POLL PWR SYS</span><br></pre></td></tr></table></figure>
<h4 id="使用killall发送命令给多个进程"><a href="#使用killall发送命令给多个进程" class="headerlink" title="使用killall发送命令给多个进程"></a>使用killall发送命令给多个进程</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">killall [-u user] [-signal] name</span><br></pre></td></tr></table></figure>
<p>可以先启动两个后台的xlogo</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [18:10:26]</span></span><br><span class="line">$ xlogo &amp;</span><br><span class="line">[1] 19146</span><br><span class="line">Warning: Cannot convert string <span class="string">"xlogo32"</span> to <span class="built_in">type</span> Pixmap                                                                              </span><br><span class="line"> </span><br><span class="line"><span class="comment"># wayne @ wayne in ~ [18:12:01]</span></span><br><span class="line">$ xlogo &amp;</span><br><span class="line">[2] 19155</span><br><span class="line">Warning: Cannot convert string <span class="string">"xlogo32"</span> to <span class="built_in">type</span> Pixmap                                                                              </span><br><span class="line"> </span><br><span class="line"><span class="comment"># wayne @ wayne in ~ [18:12:08]</span></span><br><span class="line">$ killall xlogo</span><br><span class="line">[1]  - 19146 terminated  xlogo                                                                                                       </span><br><span class="line">[2]  + 19155 terminated  xlogo</span><br></pre></td></tr></table></figure>
<p>和kill一样，必须就有root权限才能给不是自己的进程发送信号。</p>
<h3 id="其他和进程有关的命令"><a href="#其他和进程有关的命令" class="headerlink" title="其他和进程有关的命令"></a>其他和进程有关的命令</h3><div class="table-container">
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>pstree</td>
<td>以树状的模式输出进程列表，该模式显示了进程间父子关系</td>
</tr>
<tr>
<td>vmstat</td>
<td>输出系统资源使用情况的快照</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># wayne @ wayne in ~ [18:14:13] C:1</span></span><br><span class="line">$ pstree</span><br><span class="line">systemd─┬─ModemManager───2*[&#123;ModemManager&#125;]</span><br><span class="line">        ├─NetworkManager───2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─TeamViewer───24*[&#123;TeamViewer&#125;]</span><br><span class="line">        ├─agent───2*[&#123;agent&#125;]</span><br><span class="line">        ├─avahi-daemon───avahi-daemon</span><br><span class="line">        ├─baloo_file───2*[&#123;baloo_file&#125;]</span><br><span class="line">        ├─bluetoothd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─cupsd</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─gmenudbusmenupr───2*[&#123;gmenudbusmenupr&#125;]</span><br><span class="line">        ├─kdeconnectd───3*[&#123;kdeconnectd&#125;]</span><br><span class="line">        ├─kdeinit5─┬─file.so</span><br><span class="line">        │          ├─kaccess───2*[&#123;kaccess&#125;]</span><br><span class="line">        │          ├─kded5───6*[&#123;kded5&#125;]</span><br><span class="line">        │          └─klauncher───2*[&#123;klauncher&#125;]</span><br><span class="line">        ├─kio_http_cache_───&#123;kio_http_cache_&#125;</span><br><span class="line">        ├─ksmserver─┬─kwin_x11───10*[&#123;kwin_x11&#125;]</span><br><span class="line">        │           └─2*[&#123;ksmserver&#125;]</span><br><span class="line">        ├─kwalletd5───2*[&#123;kwalletd5&#125;]</span><br><span class="line">        ├─latte-dock─┬─konsole─┬─zsh───pstree</span><br><span class="line">        │            │         └─6*[&#123;konsole&#125;]</span><br><span class="line">        │            └─14*[&#123;latte-dock&#125;]</span><br><span class="line">        ├─lvmetad</span><br><span class="line">        ├─3*[mount.ntfs]</span><br><span class="line">        ├─msm_kde_notifie───2*[&#123;msm_kde_notifie&#125;]</span><br><span class="line">        ├─nxserver.bin─┬─nxd─┬─nxserver.bin─┬─nxexec───nxnode.bin───25*[&#123;nxnode.bin&#125;]</span><br><span class="line">        │              │     │              └─3*[&#123;nxserver.bin&#125;]</span><br><span class="line">        │              │     └─6*[&#123;nxd&#125;]</span><br><span class="line">        │              ├─nxexec───nxnode.bin─┬─nxclient.bin───11*[&#123;nxclient.bin&#125;]</span><br><span class="line">        │              │                     ├─nxcodec.bin</span><br><span class="line">        │              │                     └─48*[&#123;nxnode.bin&#125;]</span><br><span class="line">        │              └─5*[&#123;nxserver.bin&#125;]</span><br><span class="line">        ├─org_kde_powerde───4*[&#123;org_kde_powerde&#125;]</span><br><span class="line">        ├─pamac-tray-appi───6*[&#123;pamac-tray-appi&#125;]</span><br><span class="line">        ├─plasmashell───13*[&#123;plasmashell&#125;]</span><br><span class="line">        ├─polkit-kde-auth───4*[&#123;polkit-kde-auth&#125;]</span><br><span class="line">        ├─polkitd───11*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rtkit-daemon───2*[&#123;rtkit-daemon&#125;]</span><br><span class="line">        ├─sddm─┬─Xorg───8*[&#123;Xorg&#125;]</span><br><span class="line">        │      ├─sddm-helper───startplasma-x11─┬─plasma_session───&#123;plasma_session&#125;</span><br><span class="line">        │      │                               └─&#123;startplasma-x11&#125;</span><br><span class="line">        │      └─&#123;sddm&#125;</span><br><span class="line">        ├─sshd</span><br><span class="line">        ├─start_kdeinit</span><br><span class="line">        ├─systemd─┬─(sd-pam)</span><br><span class="line">        │         ├─at-spi-bus-laun─┬─dbus-daemon</span><br><span class="line">        │         │                 └─3*[&#123;at-spi-bus-laun&#125;]</span><br><span class="line">        │         ├─at-spi2-registr───2*[&#123;at-spi2-registr&#125;]</span><br><span class="line">        │         ├─dbus-daemon</span><br><span class="line">        │         ├─dconf-service───2*[&#123;dconf-service&#125;]</span><br><span class="line">        │         ├─dirmngr───&#123;dirmngr&#125;</span><br><span class="line">        │         ├─gpg-agent</span><br><span class="line">        │         ├─gvfsd───2*[&#123;gvfsd&#125;]</span><br><span class="line">        │         ├─gvfsd-fuse───6*[&#123;gvfsd-fuse&#125;]</span><br><span class="line">        │         ├─kactivitymanage───5*[&#123;kactivitymanage&#125;]</span><br><span class="line">        │         ├─kglobalaccel5───2*[&#123;kglobalaccel5&#125;]</span><br><span class="line">        │         ├─kscreen_backend───2*[&#123;kscreen_backend&#125;]</span><br><span class="line">        │         ├─obexd</span><br><span class="line">        │         ├─pipewire─┬─pipewire-media-───&#123;pipewire-media-&#125;</span><br><span class="line">        │         │          └─&#123;pipewire&#125;</span><br><span class="line">        │         ├─pulseaudio─┬─gsettings-helpe───3*[&#123;gsettings-helpe&#125;]</span><br><span class="line">        │         │            └─3*[&#123;pulseaudio&#125;]</span><br><span class="line">        │         ├─xdg-desktop-por───4*[&#123;xdg-desktop-por&#125;]</span><br><span class="line">        │         ├─xdg-desktop-por───18*[&#123;xdg-desktop-por&#125;]</span><br><span class="line">        │         ├─xdg-document-po─┬─fusermount</span><br><span class="line">        │         │                 └─5*[&#123;xdg-document-po&#125;]</span><br><span class="line">        │         └─xdg-permission-───2*[&#123;xdg-permission-&#125;]</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─teamviewerd───19*[&#123;teamviewerd&#125;]</span><br><span class="line">        ├─udisksd───4*[&#123;udisksd&#125;]</span><br><span class="line">        ├─upowerd───2*[&#123;upowerd&#125;]</span><br><span class="line">        ├─wpa_supplicant</span><br><span class="line">        ├─xembedsniproxy───2*[&#123;xembedsniproxy&#125;]</span><br><span class="line">        └─yakuake─┬─2*[zsh]</span><br><span class="line">                  └─6*[&#123;yakuake&#125;]</span><br><span class="line"> </span><br><span class="line"><span class="comment"># wayne @ wayne in ~ [18:14:40]</span></span><br><span class="line">$ vmstat</span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b 交换 空闲 缓冲 缓存   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line"> 0  0      0 12093644  98460 2298672    0    0    28     5  250  362  3  1 96  0  0</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Shell</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux 内核学习——Chapter 1 绪论</title>
    <url>/2020/03/17/Linux-%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0%E2%80%94%E2%80%94Chapter-1-%E7%BB%AA%E8%AE%BA/</url>
    <content><![CDATA[<h1 id="关于linux的硬件的依赖性"><a href="#关于linux的硬件的依赖性" class="headerlink" title="关于linux的硬件的依赖性"></a>关于linux的硬件的依赖性</h1><p>linux 试图在与硬件无关的源代码与硬件相关的源代码之间保持清晰地界限。因此，在linux系统的<code>arch</code>和<code>include</code>文件夹下包含了23个子目录，以对应Linux所支持的不同硬件平台。</p>
<ul>
<li>alpha</li>
<li>arm, arm26</li>
<li>cris</li>
<li>frv</li>
<li>h8300</li>
<li>i386</li>
<li>ia64</li>
<li>m32r</li>
<li>m68k, m68knommu</li>
<li>mips</li>
<li>parisc</li>
<li>ppc, ppc64</li>
<li>s390</li>
<li>sh, sh64</li>
<li>sparc, sparc64</li>
<li>um</li>
<li>v850</li>
<li>x86_64</li>
</ul>
<h1 id="操作系统的基本概念"><a href="#操作系统的基本概念" class="headerlink" title="操作系统的基本概念"></a>操作系统的基本概念</h1><p>任何计算机系统都包含一个名为操作系统的结伴程序集合。<strong>在这个集合中，最重要的程序被称为内核(kernel)。</strong> 当操作系统运行是，内核被装入到RAM，内核中包含了系统运行必不可少的很多核心过程(procedure)。<br>内核也为系统中所有的事情提供了主要功能，并决定高层软件的很多特性，因此经常使用术语“操作系统”来指代“内核”。</p>
<p>操作系统必须完成两个主要目标：</p>
<ul>
<li>与硬件部分进行交互， 为包含在硬件平台上的所有底层可编程部件提供服务</li>
<li>为运行在计算机系统上的应用程序（即所谓用户程序）提供执行环境</li>
</ul>
<p>一些操作系统允许所有的用户程序都直接与硬件部分进行交互（经典的例子就是DOS系统），而<strong>类Unix</strong>系统把计算机无力组织相关的所有低层细节都对用户运行的程序隐藏起来。当程序想要使用硬件资源时，必须向操作系统发送请求，经过内核对该请求评估允许之后，内核会代表应用程序与相关的硬件部分进行交互。</p>
<p>为了实施这种机制，现代操作系统依靠了特殊的硬件特性来禁止用户程序直接与低层硬件进行交互。特别的，硬件为CPU引入了至少两种不同的执行模式：<strong>用户程序的非特权模式和内核的特权模式</strong>。 Unix把它们分别称为用户态(user mode)和内核态(kernel mode)。</p>
<h2 id="多用户系统"><a href="#多用户系统" class="headerlink" title="多用户系统"></a>多用户系统</h2><p>多用户系统(multiuser system)是指一台能并发和独立的执行分别属于两个或多个用户的若干应用程序的计算机。</p>
<blockquote>
<ul>
<li><strong>并发(concurrently)</strong>——意味着几个应用程序能同时处于活动状态并竞争各种资源，如CPU、内存、硬盘等</li>
<li><strong>独立(independently)</strong>——意味着每个应用程序能够执行自己的任务，而无需考虑其他用户的应用程序在干些什么。</li>
</ul>
</blockquote>
<p>多用户的操作系统必须包含以下几个特点：</p>
<ul>
<li>核实用户身份的认证机制</li>
<li>防止有错误的用户程序妨碍其他应用程序在系统运行的保护机制</li>
<li>防止有恶意的用户程序干涉或窥视其它用户的活动的保护机制</li>
<li>限制分配给每个用户的资源数的记账机制</li>
</ul>
<p>为了实现以上的安全保护机制，操作系统必须利用与CPU特权模式相关的硬件保护机制。</p>
<h2 id="用户和组"><a href="#用户和组" class="headerlink" title="用户和组"></a>用户和组</h2><p>在多用户系统中，每个用户在机器上都有私有空间。<strong>操作系统必须保证用户空间的私有部分仅仅对其拥有者是可见的。</strong> 特别是必须保证，没有用户能够开发一个用于侵犯其它用户私有空间的应用程序。</p>
<p>所有的用户有一个唯一的数字来标识，成为用户标识符(UserID, UID)。</p>
<p>为了和其他用户有选择的共享资料，每一个用户是一个或者多个用户组的一名成员，组由唯一的用户组标识符(user group ID)来标识，每个文件也恰好与一个组相对应。拥有文件的用户对文件具有读写权限，同组用户仅有只读权限，其他用户没有访问权限。</p>
<p>任何的类Unix系统中都有一个特殊的用户，叫做root，即超级用户(superuser)。root用户几乎无所不能，因为操作系统对它不使用通常的保护机制，因此它能访问系统中的每一个文件，能干涉每一个正在实行的用户程序活动。</p>
<h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><p>所有的操作系统都是用一种基本的抽象：进程(process)。在传统的操作系统中，一个进程在地址空间中执行一个单独的指令序列。</p>
<blockquote>
<p>进程：程序执行时的一个实例，或者一个运行程序的“执行上下文”</p>
<p>地址空间： 允许进程引用的内存地址的集合</p>
</blockquote>
<p>现代操作系统允许具有多个执行流的进程，即，相同的地址空间可执行多个指令序列。</p>
<p>多用户系统必须支持一种执行环境，在这种执行环境里，几个进程能并发活动并能竞争系统资源。允许进程并发活佛那个的系统称为multiprogramming或者multiprocessing</p>
<p>注意区分程序和进程：几个进程能并发的执行同一程序，而同一个进程能顺序的执行几个程序</p>
<p>一般的来说，CPU的个数总是有限的，因此只有少数几个进程能同时执行，操作系统通过调度程序(scheduler)决定哪个进程能执行。 </p>
<p>多用户系统中的进程必须是抢占式的(preemptable)；操作系统记录下每个进程占有的CPU时间，并周期性的激活调度程序。</p>
<p>而非抢占式的系统只有当进程自愿放弃CPU时，调度程序才被调用。</p>
<p>类unix系统采用进程/内核模式。每个进程都自以为它是系统中唯一的进程，可以独占操作系统所提供的服务。当进城发出系统调用，硬件会把特权模式从user mode变成kernel mode，然后进程以非常有限的目的开始一个内核过程的执行。一旦这个请求完全得到满足，内核过程将迫使硬件返回user mode</p>
<a id="more"></a>
<h2 id="内核体系结构"><a href="#内核体系结构" class="headerlink" title="内核体系结构"></a>内核体系结构</h2><p>不甚理解</p>
<h1 id="Unix文件系统概述"><a href="#Unix文件系统概述" class="headerlink" title="Unix文件系统概述"></a>Unix文件系统概述</h1><h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>从用户的观点来看，文件被组织在一个树结构的命名空间中，</p>
<p><img src="\images\image-20200317213808105.png" alt="image-20200317213808105"></p>
<h2 id="硬链接和软链接"><a href="#硬链接和软链接" class="headerlink" title="硬链接和软链接"></a>硬链接和软链接</h2><p>包含在目录中的文件名就是一个文件的硬链接。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln P1 P2</span><br></pre></td></tr></table></figure>
<p>通过以上命令来创建一个新的硬链接，即为由路径<code>P1</code>表示的文件创建一个路径名为<code>P2</code>的硬链接。</p>
<p>但是硬链接有两个方面的限制：</p>
<ul>
<li>不允许用户给目录创建硬链接。应为这可能把目录树变为环形图，从而不可能通过名字定位一个文件。</li>
<li>只有在同一文件系统中的文件之间才能创建链接。这带来比较大的限制，因为现代Unix系统可能包含了多种文件系统，这些文件系统位于不同的磁盘和/或分区，用户也许无法知道它们之间的物理划分。</li>
</ul>
<p>为了克服这些限制，引入了软链接(soft link)也被称作符号链接。符号链接是短文件，这些文件包含有另一个文件的任意一个路径名。路径名可以指向位于任意一个文件系统的任意文件或目录，甚至可以指向一个不存在的文件。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ln -s P1 P2</span><br></pre></td></tr></table></figure>
<p>创建一个路径名为<code>P2</code>的新软链接，P2指向路径名为P1。任何对P2的因勇斗可以被自动转换成指向P1的一个引用。</p>
<h2 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h2><p>Unix文件可以是下列类型之一：</p>
<ul>
<li>普通文件</li>
<li>目录</li>
<li>符号链接</li>
<li>面向块的设备文件(block-oriented device file)</li>
<li>面向字符的设备文件(character-oriented device file)</li>
<li>管道(pipe)和命名管道(named pipe)也叫 FIFO</li>
<li>套接字(socket)</li>
</ul>
<p>前三种文件类型是所有Unix文件系统的基本类型。</p>
<p>设备文件与与集成到内核中的设备驱动程序相关。</p>
<h2 id="文件描述符与索引节点"><a href="#文件描述符与索引节点" class="headerlink" title="文件描述符与索引节点"></a>文件描述符与索引节点</h2><p>Unix对 <strong>文件的内容</strong> 和 <strong>描述文件的信息</strong>给出了清楚的区分。除了设备文件和特殊文件系统文件外，每个文件都有字符序列组成。文件内容不包含任何<strong>控制信息</strong>，如文件长度或文件结束符(EOF)。</p>
<p>文件系统处理文件需要的所有信息包含在一个名为索引节点(inode)的数据结构中。每个文件都有自己的索引节点，文件系统用索引节点来标识文件。</p>
<p>每个索引节点可能随着Unix系统不同其内容有所差异，但是至少满足POSIX标准中如下属性：</p>
<ul>
<li>文件类型</li>
<li>与文件相关的硬链接个数</li>
<li>以字节为单位的文件长度</li>
<li>设备标识符</li>
<li>在文件系统中标识文件的索引节点号</li>
<li>文件拥有者的UID</li>
<li>文件的用户组ID</li>
<li>几个时间戳，表示索引节点状态改变的时间、最后访问时间及最后修改时间。</li>
<li>访问权限和文件模式</li>
</ul>
<h2 id="访问权限和文件模式"><a href="#访问权限和文件模式" class="headerlink" title="访问权限和文件模式"></a>访问权限和文件模式</h2><p>文件的潜在用户分为三种类型：</p>
<ul>
<li>作为文件所有者的用户</li>
<li>同组用户，不包括所有者</li>
<li>其他</li>
</ul>
<p>而访问权限有三种读、写、执行，因此文件访问权限就用九种不同的二进制来标记。还有两种附加的标记即suid(set user ID), sgid(set group id)。</p>
<h2 id="文件操作的系统调用"><a href="#文件操作的系统调用" class="headerlink" title="文件操作的系统调用"></a>文件操作的系统调用</h2><h3 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">fd = open (path, flag, mode)</span><br></pre></td></tr></table></figure>
<p>返回一个文件对象</p>
<h3 id="访问打开的文件"><a href="#访问打开的文件" class="headerlink" title="访问打开的文件"></a>访问打开的文件</h3><p>顺序访问是文件的默认访问方式，即<code>read()</code>和<code>write()</code>系统调用总是从文件指针的当前位置开始读写，而修改文件指针则可通过以下：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">newoffset = lseek(fd, offset, <span class="built_in">whence</span>);</span><br></pre></td></tr></table></figure>
<p>whence指定了文件指针的新位置的计算方式：</p>
<ul>
<li>offset + 0</li>
<li>offset + 当前指针位置</li>
<li>offset + 文件末尾</li>
</ul>
<p>而<code>read()</code>需要以下参数</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">nread = <span class="built_in">read</span>(fd, buf, count);</span><br></pre></td></tr></table></figure>
<h3 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">res = close(fd);</span><br></pre></td></tr></table></figure>
<h3 id="更名及删除文件"><a href="#更名及删除文件" class="headerlink" title="更名及删除文件"></a>更名及删除文件</h3><p>更名并不对文件的内容起作用，而是对一个或多个目录的内容起作用。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">res = rename(oldpath, newpath);</span><br></pre></td></tr></table></figure>
<p>而删除本质上是减少文件链接数，当连接数为0，文件才被真正的删除</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">res = unlink(pathname);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Kernel</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 33.搜索旋转排序数组</title>
    <url>/2020/01/10/LeetCode-33-%E6%90%9C%E7%B4%A2%E6%97%8B%E8%BD%AC%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>假设按照升序排序的数组在预先未知的某个点上进行了旋转。</p>
<p>( 例如，数组 [0,1,2,4,5,6,7] 可能变为 [4,5,6,7,0,1,2] )。</p>
<p>搜索一个给定的目标值，如果数组中存在这个目标值，则返回它的索引，否则返回 -1 。</p>
<p>你可以假设数组中不存在重复的元素。</p>
<p>你的算法时间复杂度必须是 O(log n) 级别。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: nums &#x3D; [4,5,6,7,0,1,2], target &#x3D; 0</span><br><span class="line">输出: 4</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: nums &#x3D; [4,5,6,7,0,1,2], target &#x3D; 3</span><br><span class="line">输出: -1</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/search-in-rotated-sorted-array" target="_blank" rel="noopener">https://leetcode-cn.com/problems/search-in-rotated-sorted-array</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="线性遍历"><a href="#线性遍历" class="headerlink" title="线性遍历"></a>线性遍历</h2><p>不谈</p>
<h2 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h2><ol>
<li>nums[left] &lt;= nums[mid]（left - mid不包含旋转）且nums[left] &lt;= target &lt;= nums[mid] 时 high 向前规约；</li>
<li>nums[mid] &lt; nums[left]（left - mid包含旋转），target &lt;= nums[mid] &lt; nums[left] 时向前规约（target 在旋转位置到 mid 之间）</li>
<li>nums[mid] &lt; nums[left]，nums[mid] &lt; nums[left] &lt;= target 时向前规约（target 在 left 到旋转位置之间）</li>
<li>其他情况向后规约</li>
</ol>
<p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(nums: List[int], target: int)</span> -&gt; int:</span></span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = len(nums) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = low + (high - low) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> target == nums[mid]:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">        <span class="keyword">if</span> nums[low] &lt;= nums[mid]:</span><br><span class="line">            <span class="keyword">if</span> target &gt;= nums[low] <span class="keyword">and</span> target &lt; nums[mid]:</span><br><span class="line">                high = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> target &gt; nums[mid] <span class="keyword">and</span> target &lt;= nums[high]:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lo = <span class="number">0</span>, hi = nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> ((nums[left] &gt; target) ^ (nums[left] &gt; nums[mid]) ^ (target &gt; nums[mid]))</span><br><span class="line">            lo = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            hi = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lo == hi &amp;&amp; nums[lo] == target ? lo : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>数组</tag>
        <tag>二分查找</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 31.下一个排列</title>
    <url>/2020/01/10/LeetCode-31-%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%8E%92%E5%88%97/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>实现获取下一个排列的函数，算法需要将给定数字序列重新排列成字典序中下一个更大的排列。</p>
<p>如果不存在下一个更大的排列，则将数字重新排列成最小的排列（即升序排列）。</p>
<p>必须原地修改，只允许使用额外常数空间。</p>
<p>以下是一些例子，输入位于左侧列，其相应输出位于右侧列。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1,2,3 → 1,3,2</span><br><span class="line">3,2,1 → 1,2,3</span><br><span class="line">1,1,5 → 1,5,1</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/next-permutation" target="_blank" rel="noopener">https://leetcode-cn.com/problems/next-permutation</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><ol>
<li>先找出最大的索引<code>k</code>满足<code>nums[k] &lt; nums[k+1]</code>，如果不存在就翻转整个数组</li>
<li>再找出另一个最大的索引<code>l</code>满足<code>nums[l] &gt; nums[k]</code></li>
<li>交换<code>nums[l]</code>和<code>nums[k]</code></li>
<li>最后翻转<code>nums[k+1:]</code></li>
</ol>
<p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Do not return anything, modify nums in-place instead.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    firstIndex = <span class="number">-1</span></span><br><span class="line">    n = len(nums)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(nums, i, j)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            nums[i],nums[j] = nums[j], nums[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">if</span> nums[i] &lt; nums[i+<span class="number">1</span>]:</span><br><span class="line">            firstIndex = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment">#print(firstIndex)</span></span><br><span class="line">    <span class="keyword">if</span> firstIndex == <span class="number">-1</span>:</span><br><span class="line">        reverse(nums, <span class="number">0</span>, n<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    secondIndex = <span class="number">-1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>, firstIndex, <span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">if</span> nums[i] &gt; nums[firstIndex]:</span><br><span class="line">            secondIndex = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    nums[firstIndex],nums[secondIndex] = nums[secondIndex], nums[firstIndex]</span><br><span class="line">    reverse(nums, firstIndex+<span class="number">1</span>, n<span class="number">-1</span>)</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>数组</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 28.实现strStr()</title>
    <url>/2020/01/09/LeetCode-28-%E5%AE%9E%E7%8E%B0strStr/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个 haystack 字符串和一个 needle 字符串，在 haystack 字符串中找出 needle 字符串出现的第一个位置 (从0开始)。如果不存在，则返回  -1。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: haystack &#x3D; &quot;hello&quot;, needle &#x3D; &quot;ll&quot;</span><br><span class="line">输出: 2</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: haystack &#x3D; &quot;aaaaa&quot;, needle &#x3D; &quot;bba&quot;</span><br><span class="line">输出: -1</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/implement-strstr" target="_blank" rel="noopener">https://leetcode-cn.com/problems/implement-strstr</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="暴力法"><a href="#暴力法" class="headerlink" title="暴力法"></a>暴力法</h2><p>使用双指针遍历</p>
<h2 id="KMP算法"><a href="#KMP算法" class="headerlink" title="KMP算法"></a>KMP算法</h2><p>KMP算法<a href="https://blog.csdn.net/starstar1992/article/details/54913261" target="_blank" rel="noopener">详细解答</a></p>
<p><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strStr</span><span class="params">(<span class="keyword">char</span>* source, <span class="keyword">char</span>* target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(source == <span class="literal">NULL</span> || target == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Two Pointer check for target</span></span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> s1,s2,n;</span><br><span class="line">    s1= <span class="number">0</span>;</span><br><span class="line">    s2= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> * s_temp=source;</span><br><span class="line">    <span class="keyword">char</span> * t_temp=target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (*s_temp!=<span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s1++;</span><br><span class="line">        s_temp++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (*t_temp!=<span class="string">'\0'</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        s2++;</span><br><span class="line">        t_temp++;</span><br><span class="line">    &#125;</span><br><span class="line">    n= s1-s2+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; s2; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (*(source+i+j) != *(target+j))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j == s2)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//'target' not found:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>简单</tag>
        <tag>双指针</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 27.移除元素</title>
    <url>/2020/01/09/LeetCode-27-%E7%A7%BB%E9%99%A4%E5%85%83%E7%B4%A0/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个数组 nums 和一个值 val，你需要原地移除所有数值等于 val 的元素，返回移除后数&gt; 组的新长度。</p>
<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>
<p>元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定 nums &#x3D; [3,2,2,3], val &#x3D; 3,</span><br><span class="line"></span><br><span class="line">函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。</span><br><span class="line"></span><br><span class="line">你不需要考虑数组中超出新长度后面的元素。</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定 nums &#x3D; [0,1,2,2,3,0,4,2], val &#x3D; 2,</span><br><span class="line"></span><br><span class="line">函数应该返回新的长度 5, 并且 nums 中的前五个元素为 0, 1, 3, 0, 4。</span><br></pre></td></tr></table></figure><br>注意这五个元素可为任意顺序。</p>
<p>你不需要考虑数组中超出新长度后面的元素。</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/remove-element" target="_blank" rel="noopener">https://leetcode-cn.com/problems/remove-element</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>此题解法与前一题<a href="2020/01/02/LeetCode-26-删除排序数组中的重复项">26.删除数组中的重复项</a>很相似。<br>使用一个快指针先遍历，找到不等于目标值的元素，将该元素赋值给慢指针所指向的元素。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeElement</span><span class="params">(nums, val)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :type nums: List[int]</span></span><br><span class="line"><span class="string">    :type val: int</span></span><br><span class="line"><span class="string">    :rtype: int</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">        <span class="keyword">if</span>(nums[i]==val): <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            nums[count] = nums[i]</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[i]==val) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            nums[count] = nums[i];</span><br><span class="line">            count ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>简单</tag>
        <tag>双指针</tag>
        <tag>数组</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 26.删除排序数组中的重复项</title>
    <url>/2020/01/02/LeetCode-26-%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个排序数组，你需要在原地删除重复出现的元素，使得每个元素只出现一次，返回移除后数组的新长度。</p>
<p>不要使用额外的数组空间，你必须在原地修改输入数组并在使用 O(1) 额外空间的条件下完成。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定数组 nums &#x3D; [1,1,2], </span><br><span class="line"></span><br><span class="line">函数应该返回新的长度 2, 并且原数组 nums 的前两个元素被修改为 1, 2。 </span><br><span class="line"></span><br><span class="line">你不需要考虑数组中超出新长度后面的元素。</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定 nums &#x3D; [0,0,1,1,1,2,2,3,3,4],</span><br><span class="line"></span><br><span class="line">函数应该返回新的长度 5, 并且原数组 nums 的前五个元素被修改为 0, 1, 2, 3, 4。</span><br><span class="line"></span><br><span class="line">你不需要考虑数组中超出新长度后面的元素。</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array" target="_blank" rel="noopener">https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p> 使用两个指针，快的指针遍历所有元素，发现有重复元素就将元素值赋给慢指针所指向的元素</p>
<p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeDuplicates</span><span class="params">(nums: List[int])</span> -&gt; int:</span></span><br><span class="line">    left = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> len(nums) &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> len(nums)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(nums)):</span><br><span class="line">        <span class="keyword">if</span> nums[i] != nums[i - <span class="number">1</span>]:</span><br><span class="line">            left += <span class="number">1</span></span><br><span class="line">            nums[left] = nums[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> left + <span class="number">1</span></span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums[count]!=nums[i]) nums[++count]=nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>难度</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 24.两两交换链表中的节点</title>
    <url>/2019/12/25/LeetCode-24-%E4%B8%A4%E4%B8%A4%E4%BA%A4%E6%8D%A2%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E8%8A%82%E7%82%B9/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个链表，两两交换其中相邻的节点，并返回交换后的链表。</p>
<p>你不能只是单纯的改变节点内部的值，而是需要实际的进行节点交换。</p>
<p><strong>示例:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定 1-&gt;2-&gt;3-&gt;4, 你应该返回 2-&gt;1-&gt;4-&gt;3.</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/swap-nodes-in-pairs" target="_blank" rel="noopener">https://leetcode-cn.com/problems/swap-nodes-in-pairs</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>使用三个指针，指针A指向的是奇数位置的节点，指针B指向的是偶数位置的节点，指针C指向的是奇数位置节点的前一个节点，每次跳动两位，进行交换<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swapPairs</span><span class="params">(head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">    dummyHead = ListNode(<span class="number">0</span>)</span><br><span class="line">    dummyHead.next = head</span><br><span class="line">    tmp = dummyHead</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> tmp.next != <span class="literal">None</span> <span class="keyword">and</span> tmp.next.next != <span class="literal">None</span>:</span><br><span class="line">        first = tmp.next</span><br><span class="line">        second = tmp.next.next</span><br><span class="line">        tmp.next = second</span><br><span class="line">        first.next = second.next</span><br><span class="line">        second.next = first</span><br><span class="line">        tmp = first</span><br><span class="line">    <span class="keyword">return</span> dummyHead.next</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">swapPairs</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">    ListNode* dummyHead = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    dummyHead-&gt;next = head;</span><br><span class="line">    ListNode* curr;</span><br><span class="line">    ListNode* first;</span><br><span class="line">    ListNode* second;</span><br><span class="line">    curr = dummyHead;</span><br><span class="line">    <span class="keyword">while</span>(curr-&gt;next &amp;&amp; curr-&gt;next-&gt;next)&#123;</span><br><span class="line">        first = curr-&gt;next;</span><br><span class="line">        second = curr-&gt;next-&gt;next;</span><br><span class="line">        curr-&gt;next = second;</span><br><span class="line">        first-&gt;next = second-&gt;next;</span><br><span class="line">        second-&gt;next = first;</span><br><span class="line">        curr = first;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>链表</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 23.合并K个排序链表</title>
    <url>/2019/12/25/LeetCode-23-%E5%90%88%E5%B9%B6K%E4%B8%AA%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>合并 k 个排序链表，返回合并后的排序链表。请分析和描述算法的复杂度。</p>
<p>示例:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">[</span><br><span class="line">  1-&gt;4-&gt;5,</span><br><span class="line">  1-&gt;3-&gt;4,</span><br><span class="line">  2-&gt;6</span><br><span class="line">]</span><br><span class="line">输出: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/merge-k-sorted-lists" target="_blank" rel="noopener">https://leetcode-cn.com/problems/merge-k-sorted-lists</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>此题可以分解来看。可以把多个有序链表的合并分解为多组两个有序链表的合并。而两个有序链表的合并刚好是<a href="2019/12/25/LeetCode-21-合并两个有序链表">LeetCode 21.合并两个有序链表</a>所解决的问题。<br>那么现在问题就在如何将多个有序链表的合并分解成两个有序链表了，分治算法可以解决这个问题。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> self._merge(lists, <span class="number">0</span>, len(lists)<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_merge</span><span class="params">(lists: List[ListNode], left: int, right: int)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> left == right:</span><br><span class="line">        <span class="keyword">return</span> lists[left]</span><br><span class="line">    mid = (left + right) // <span class="number">2</span></span><br><span class="line">    l1 = self._merge(lists, left, mid)</span><br><span class="line">    l2 = self._merge(lists, mid + <span class="number">1</span>, right)</span><br><span class="line">    <span class="keyword">return</span> self._mergeTwoLists(l1, l2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_mergeTwoLists</span><span class="params">(l1: ListNode, l2: ListNode)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> l1 == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> l2</span><br><span class="line">    <span class="keyword">if</span> l2 == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> l1</span><br><span class="line">    res = ListNode(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> l1.val &lt; l2.val:</span><br><span class="line">        res.val = l1.val</span><br><span class="line">        res.next = self._mergeTwoLists(l1.next, l2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res.val = l2.val</span><br><span class="line">        res.next = self._mergeTwoLists(l1, l2.next)</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">mergeKLists</span><span class="params">(<span class="built_in">vector</span>&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lists.empty()) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">int</span> n = lists.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">return</span> _merge(lists, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ListNode* _merge(<span class="built_in">vector</span>&lt;ListNode*&gt;&amp; lists, <span class="keyword">int</span> left, <span class="keyword">int</span> right)&#123;</span><br><span class="line">    <span class="keyword">if</span> (left == right) <span class="keyword">return</span> lists[left];</span><br><span class="line">    <span class="keyword">int</span> mid = left + (right - left) / <span class="number">2</span>;</span><br><span class="line">    ListNode* l1 = _merge(lists, left, mid);</span><br><span class="line">    ListNode* l2 = _merge(lists, mid + <span class="number">1</span>, right);</span><br><span class="line">    <span class="keyword">return</span> mergeTwoLists(l1, l2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!l1) <span class="keyword">return</span> l2;</span><br><span class="line">    <span class="keyword">if</span> (!l2) <span class="keyword">return</span> l1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l1-&gt;val &lt; l2-&gt;val)&#123;</span><br><span class="line">        l1-&gt;next = mergeTwoLists(l1-&gt;next, l2);</span><br><span class="line">        <span class="keyword">return</span> l1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        l2-&gt;next = mergeTwoLists(l1, l2-&gt;next);</span><br><span class="line">        <span class="keyword">return</span> l2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>困难</tag>
        <tag>链表</tag>
        <tag>分治算法</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 22.括号生成</title>
    <url>/2019/12/25/LeetCode-22-%E6%8B%AC%E5%8F%B7%E7%94%9F%E6%88%90/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给出 n 代表生成括号的对数，请你写出一个函数，使其能够生成所有可能的并且有效的括号组合。</p>
<p>例如，给出 n = 3，生成结果为：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  &quot;((()))&quot;,</span><br><span class="line">  &quot;(()())&quot;,</span><br><span class="line">  &quot;(())()&quot;,</span><br><span class="line">  &quot;()(())&quot;,</span><br><span class="line">  &quot;()()()&quot;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/generate-parentheses" target="_blank" rel="noopener">https://leetcode-cn.com/problems/generate-parentheses</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>将一对括号”()”作为一个整体，插入到已有的序列中。借助了BFS的思想。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generateParenthesis</span><span class="params">(self, n: int)</span> -&gt; List[str]:</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">'()'</span>]</span><br><span class="line">    stack = deque([<span class="string">'()'</span>])</span><br><span class="line">    visited = set()</span><br><span class="line">    index = n</span><br><span class="line">    <span class="keyword">while</span> index &gt; <span class="number">1</span>:</span><br><span class="line">        index -= <span class="number">1</span></span><br><span class="line">        l = len(stack)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(l):</span><br><span class="line">            tmp = stack.pop()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tmp)):</span><br><span class="line">                tmpstr = tmp[:i] + <span class="string">'()'</span> + tmp[i:]</span><br><span class="line">                <span class="keyword">if</span> tmpstr <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                    visited.add(tmpstr)</span><br><span class="line">                    stack.appendleft(tmpstr)</span><br><span class="line">    <span class="keyword">return</span> list(stack)</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; generateParenthesis(<span class="keyword">int</span> n) &#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; res;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;res.push_back(<span class="string">"()"</span>); <span class="keyword">return</span> res;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt; que;</span><br><span class="line">    que.push(<span class="string">"()"</span>);</span><br><span class="line">    <span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt; tmpset;</span><br><span class="line">    <span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> l,s,i;</span><br><span class="line">    <span class="built_in">string</span> tmpstr;</span><br><span class="line">    <span class="keyword">while</span> (start &lt; n - <span class="number">1</span>)&#123;</span><br><span class="line">        start++;</span><br><span class="line">        l = que.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> _ = <span class="number">0</span>; _ &lt; l; _++)&#123;</span><br><span class="line">            <span class="built_in">string</span> str = que.front();</span><br><span class="line">            que.pop();</span><br><span class="line">            s = str.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; s; i++)&#123;</span><br><span class="line">                tmpstr = str;</span><br><span class="line">                tmpstr.insert(i, <span class="string">"()"</span>);</span><br><span class="line">                <span class="keyword">if</span> (tmpset.count(tmpstr) == <span class="number">0</span>)&#123;</span><br><span class="line">                    que.push(tmpstr);</span><br><span class="line">                    tmpset.insert(tmpstr);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!que.empty())&#123;</span><br><span class="line">        res.push_back(que.front());</span><br><span class="line">        que.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>回溯算法</tag>
        <tag>中等</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 21.合并两个有序链表</title>
    <url>/2019/12/25/LeetCode-21-%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>将两个有序链表合并为一个新的有序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。 </p>
<p><strong>示例：</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入：1-&gt;2-&gt;4, 1-&gt;3-&gt;4</span><br><span class="line">输出：1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/merge-two-sorted-lists" target="_blank" rel="noopener">https://leetcode-cn.com/problems/merge-two-sorted-lists</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h2><p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">    <span class="keyword">if</span> l1 == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> l2</span><br><span class="line">    <span class="keyword">if</span> l2 == <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> l1</span><br><span class="line">    tmp = ListNode(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> l1.val &lt; l2.val:</span><br><span class="line">        tmp.val = l1.val</span><br><span class="line">        tmp.next = self.mergeTwoLists(l1.next, l2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp.val = l2.val</span><br><span class="line">        tmp.next = self.mergeTwoLists(l1, l2.next)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!l1) <span class="keyword">return</span> l2;</span><br><span class="line">    <span class="keyword">if</span> (!l2) <span class="keyword">return</span> l1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l1-&gt;val &lt; l2-&gt;val)&#123;</span><br><span class="line">        l1-&gt;next = mergeTwoLists(l1-&gt;next, l2);</span><br><span class="line">        <span class="keyword">return</span> l1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        l2-&gt;next = mergeTwoLists(l1, l2-&gt;next);</span><br><span class="line">        <span class="keyword">return</span> l2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>简单</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 20.有效的括号</title>
    <url>/2019/12/25/LeetCode-20-%E6%9C%89%E6%95%88%E7%9A%84%E6%8B%AC%E5%8F%B7/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个只包括 ‘(‘，’)’，’{‘，’}’，’[‘，’]’ 的字符串，判断字符串是否有效。</p>
<p>有效字符串需满足：</p>
<p>左括号必须用相同类型的右括号闭合。<br>左括号必须以正确的顺序闭合。<br>注意空字符串可被认为是有效字符串。</p>
<p>示例 1:</p>
<p>输入: “()”<br>输出: true<br>示例 2:</p>
<p>输入: “()[]{}”<br>输出: true<br>示例 3:</p>
<p>输入: “(]”<br>输出: false<br>示例 4:</p>
<p>输入: “([)]”<br>输出: false<br>示例 5:</p>
<p>输入: “{[]}”<br>输出: true</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/valid-parentheses" target="_blank" rel="noopener">https://leetcode-cn.com/problems/valid-parentheses</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><ol>
<li>使用一个栈</li>
<li>遍历这个字符串</li>
<li>如果是左括号，就把左括号入栈</li>
<li>如果是右括号，则检测该右括号是否是栈顶的左括号对应的右括号，是就弹出栈顶，不是则返回false</li>
<li>遍历结束，返回栈是否为空<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">    stack = deque()</span><br><span class="line">    keymap = &#123;<span class="string">'('</span>:<span class="string">')'</span>, <span class="string">'['</span>:<span class="string">']'</span>, <span class="string">'&#123;'</span>:<span class="string">'&#125;'</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        <span class="keyword">if</span> s[i] <span class="keyword">in</span> keymap:</span><br><span class="line">            stack.append(s[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> stack:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            tmp = stack.pop()</span><br><span class="line">            <span class="keyword">if</span> s[i] != keymap[tmp]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line">    <span class="keyword">if</span> len(stack) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<strong>C++解法</strong><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isValid</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="keyword">char</span>&gt; mapRelation = &#123;&#123;<span class="string">'('</span>,<span class="string">')'</span>&#125;,&#123;<span class="string">'['</span>,<span class="string">']'</span>&#125;,&#123;<span class="string">'&#123;'</span>,<span class="string">'&#125;'</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt; store;</span><br><span class="line">    <span class="keyword">if</span> (s.empty()) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; s.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (mapRelation.count(s[i])) store.push(s[i]);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (store.empty()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == mapRelation[store.top()]) store.pop();</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> store.empty();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>简单</tag>
        <tag>栈</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 19.删除链表的倒数第N个节点</title>
    <url>/2019/12/25/LeetCode-19-%E5%88%A0%E9%99%A4%E9%93%BE%E8%A1%A8%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%ACN%E4%B8%AA%E8%8A%82%E7%82%B9/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个链表，删除链表的倒数第 n 个节点，并且返回链表的头结点。</p>
<p><strong>示例</strong>：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">给定一个链表: 1-&gt;2-&gt;3-&gt;4-&gt;5, 和 n &#x3D; 2.</span><br><span class="line">当删除了倒数第二个节点后，链表变为 1-&gt;2-&gt;3-&gt;5.</span><br></pre></td></tr></table></figure><br>说明：</p>
<p>给定的 n 保证是有效的。</p>
<p>进阶：</p>
<p>你能尝试使用一趟扫描实现吗？</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list" target="_blank" rel="noopener">https://leetcode-cn.com/problems/remove-nth-node-from-end-of-list</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><p>遍历一遍链表，将所有链表节点存入容器中，直接删除倒数第n个节点，返回头节点。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeNthFromEnd</span><span class="params">(head: ListNode, n: int)</span> -&gt; ListNode:</span></span><br><span class="line">    nodeList = []</span><br><span class="line">    <span class="keyword">while</span> head:</span><br><span class="line">        nodeList.append(head)</span><br><span class="line">        head = head.next</span><br><span class="line">    nodeList[-n - <span class="number">1</span>].next = nodeList[-n + <span class="number">1</span>]</span><br><span class="line">    nodeList[-n].next = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> nodeList[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ListNode*&gt; nodeList;</span><br><span class="line">    <span class="keyword">int</span> l;</span><br><span class="line">    <span class="keyword">while</span> (head)&#123;</span><br><span class="line">        nodeList.push_back(head);</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    l = nodeList.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span> (n == l) <span class="keyword">return</span> nodeList[<span class="number">0</span>]-&gt;next;</span><br><span class="line">    nodeList[l - n - <span class="number">1</span>]-&gt;next = nodeList[l - n]-&gt;next;</span><br><span class="line">    <span class="keyword">return</span> nodeList[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="双指针"><a href="#双指针" class="headerlink" title="双指针"></a>双指针</h2><ol>
<li>先用一个指针，走n + 1步</li>
<li>然后用第二个指针从头开始，两个指针一起向后走</li>
<li>当第一个指针走到结束时，第二个指针的下一个节点就是倒数第n个节点<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeNthFromEnd</span><span class="params">(head: ListNode, n: int)</span> -&gt; ListNode:</span></span><br><span class="line">    first = head</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> first:</span><br><span class="line">            first = first.next</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> head.next</span><br><span class="line">    second = head</span><br><span class="line">    <span class="keyword">while</span> first:</span><br><span class="line">        first = first.next</span><br><span class="line">        second = second.next</span><br><span class="line">    second.next = second.next.next</span><br><span class="line">    <span class="keyword">return</span> head</span><br></pre></td></tr></table></figure>
<strong>C++解法</strong><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    ListNode* first = head;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; n + <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (first) first = first-&gt;next;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode* second = head;</span><br><span class="line">    <span class="keyword">while</span> (first)&#123;</span><br><span class="line">        first = first-&gt;next;</span><br><span class="line">        second = second-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    second-&gt;next = second-&gt;next-&gt;next;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>双指针</tag>
        <tag>链表</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 16. 最接近的三数之和</title>
    <url>/2019/12/24/LeetCode-16-%E6%9C%80%E6%8E%A5%E8%BF%91%E7%9A%84%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。</p>
<p>例如，给定数组 nums = [-1，2，1，-4], 和 target = 1.</p>
<p>与 target 最接近的三个数的和为 2. (-1 + 2 + 1 = 2).</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/3sum-closest" target="_blank" rel="noopener">https://leetcode-cn.com/problems/3sum-closest</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>此题解法与<a href="2019/12/24/LeetCode-15-三数之和">15.三数之和</a>极为相似。</p>
<ol>
<li>首先将数组排序</li>
<li>从头开始遍历该数组</li>
<li>以遍历到的当前元素的后一个元素下标为左指针，最后一个元素为右指针，记录当前的三个元素之和，更新与目标的最小距离<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSumClosest</span><span class="params">(nums: List[int], target: int)</span> -&gt; int:</span></span><br><span class="line">    n = len(nums)</span><br><span class="line">    nums.sort()</span><br><span class="line">    re_min = <span class="number">0</span> <span class="comment">#存储当前最小的差值</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        low = i+<span class="number">1</span></span><br><span class="line">        high = n<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            three_sum = nums[i] + nums[low] + nums[high]</span><br><span class="line">            x = target - three_sum <span class="comment">#当前三数的差值</span></span><br><span class="line">            <span class="keyword">if</span> re_min == <span class="number">0</span>:</span><br><span class="line">                re_min = abs(x)</span><br><span class="line">                sum_min = three_sum <span class="comment">#sum_min为当前最接近的和</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> abs(x) &lt; re_min:</span><br><span class="line">                re_min = abs(x)</span><br><span class="line">                sum_min = three_sum</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> three_sum == target:</span><br><span class="line">                <span class="keyword">return</span> target</span><br><span class="line">            <span class="keyword">elif</span> three_sum &lt; target:</span><br><span class="line">                low += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high -= <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sum_min</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<strong>C++解法</strong><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">threeSumClosest</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">int</span> left, right;</span><br><span class="line">    <span class="keyword">int</span> res_min = INT_MAX;</span><br><span class="line">    <span class="keyword">int</span> sum;</span><br><span class="line">    sort(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        left = i + <span class="number">1</span>;</span><br><span class="line">        right = n - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right)&#123;</span><br><span class="line">            <span class="keyword">int</span> threeSum = nums[i] + nums[left] + nums[right];</span><br><span class="line">            <span class="keyword">int</span> tmp = <span class="built_in">abs</span>(target - threeSum);</span><br><span class="line">            <span class="keyword">if</span> (tmp == <span class="number">0</span>) <span class="keyword">return</span> target;</span><br><span class="line">            <span class="keyword">if</span> (threeSum &gt; target) right--;</span><br><span class="line">            <span class="keyword">else</span> left++;</span><br><span class="line">            <span class="keyword">if</span> (tmp &lt; res_min)&#123;</span><br><span class="line">                sum = threeSum;</span><br><span class="line">                res_min = tmp;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>双指针</tag>
        <tag>数组</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 17. 电话号码的字母组合</title>
    <url>/2019/12/24/LeetCode-17-%E7%94%B5%E8%AF%9D%E5%8F%B7%E7%A0%81%E7%9A%84%E5%AD%97%E6%AF%8D%E7%BB%84%E5%90%88/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个仅包含数字 2-9 的字符串，返回所有它能表示的字母组合。</p>
<p>给出数字到字母的映射如下（与电话按键相同）。注意 1 不对应任何字母。</p>
<p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/original_images/17_telephone_keypad.png" alt=""></p>
<p><strong>示例:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入：&quot;23&quot;</span><br><span class="line">输出：[&quot;ad&quot;, &quot;ae&quot;, &quot;af&quot;, &quot;bd&quot;, &quot;be&quot;, &quot;bf&quot;, &quot;cd&quot;, &quot;ce&quot;, &quot;cf&quot;].</span><br><span class="line">说明:</span><br><span class="line">尽管上面的答案是按字典序排列的，但是你可以任意选择答案输出的顺序。</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/letter-combinations-of-a-phone-number" target="_blank" rel="noopener">https://leetcode-cn.com/problems/letter-combinations-of-a-phone-number</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>使用BFS<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">letterCombinations</span><span class="params">(self, digits: str)</span> -&gt; List[str]:</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">    numMap = &#123;<span class="string">'2'</span>:<span class="string">'abc'</span>, <span class="string">'3'</span>:<span class="string">'def'</span>, <span class="string">'4'</span>:<span class="string">'ghi'</span>, <span class="string">'5'</span>:<span class="string">'jkl'</span>, <span class="string">'6'</span>:<span class="string">'mno'</span>, <span class="string">'7'</span>:<span class="string">'pqrs'</span>, <span class="string">'8'</span>:<span class="string">'tuv'</span>, <span class="string">'9'</span>:<span class="string">'wxyz'</span>&#125;</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">if</span> len(digits) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> list(numMap[digits[<span class="number">0</span>]])</span><br><span class="line">    </span><br><span class="line">    stack = deque(list(numMap[digits[<span class="number">0</span>]]))</span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    visited = set()</span><br><span class="line">    <span class="keyword">while</span> start &lt; len(digits) - <span class="number">1</span>:</span><br><span class="line">        start += <span class="number">1</span></span><br><span class="line">        l = len(stack)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(l):</span><br><span class="line">            tmp = stack.pop()</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(numMap[digits[start]])):</span><br><span class="line">                <span class="keyword">if</span> tmp + numMap[digits[start]][i] <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                    visited.add(tmp + numMap[digits[start]][i])</span><br><span class="line">                    stack.appendleft(tmp + numMap[digits[start]][i])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> list(stack)</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; letterCombinations(<span class="built_in">string</span> digits) &#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; res;</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">char</span>,<span class="built_in">string</span>&gt; m = &#123;&#123;<span class="string">'2'</span>,<span class="string">"abc"</span> &#125;,&#123;<span class="string">'3'</span>,<span class="string">"def"</span>&#125;,&#123;<span class="string">'4'</span>,<span class="string">"ghi"</span>&#125;,&#123;<span class="string">'5'</span>,<span class="string">"jkl"</span>&#125;,&#123;<span class="string">'6'</span>,<span class="string">"mno"</span>&#125;,&#123;<span class="string">'7'</span>,<span class="string">"pqrs"</span>&#125;,&#123;<span class="string">'8'</span>,<span class="string">"tuv"</span>&#125;,&#123;<span class="string">'9'</span>,<span class="string">"wxyz"</span>&#125;&#125;;</span><br><span class="line">    <span class="keyword">int</span> n = digits.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m[digits[<span class="number">0</span>]].<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="built_in">string</span> str;</span><br><span class="line">            str.push_back(m[digits[<span class="number">0</span>]][i]);</span><br><span class="line">            res.push_back(str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt; que;</span><br><span class="line">    <span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; m[digits[<span class="number">0</span>]].<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="built_in">string</span> str;</span><br><span class="line">        str.push_back(m[digits[<span class="number">0</span>]][i]);</span><br><span class="line">        que.push(str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (start &lt; n - <span class="number">1</span>)&#123;</span><br><span class="line">        start ++;</span><br><span class="line">        <span class="keyword">int</span> l = que.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> _ = <span class="number">0</span>; _ &lt; l; _++)&#123;</span><br><span class="line">            <span class="built_in">string</span> tmp = que.front();</span><br><span class="line">            que.pop();</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; m[digits[start]].<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">                que.push(tmp + m[digits[start]][i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!que.empty())&#123;</span><br><span class="line">        res.push_back(que.front());</span><br><span class="line">        que.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>回溯算法</tag>
        <tag>中等</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 15. 三数之和</title>
    <url>/2019/12/24/LeetCode-15-%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。</p>
<p>注意：答案中不可以包含重复的三元组。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">例如, 给定数组 nums &#x3D; [-1, 0, 1, 2, -1, -4]，</span><br><span class="line"></span><br><span class="line">满足要求的三元组集合为：</span><br><span class="line">[</span><br><span class="line">  [-1, 0, 1],</span><br><span class="line">  [-1, -1, 2]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/3sum" target="_blank" rel="noopener">https://leetcode-cn.com/problems/3sum</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="双指针法"><a href="#双指针法" class="headerlink" title="双指针法"></a>双指针法</h2><ol>
<li>先将数组排序</li>
<li>从头开始遍历数组，如果当前元素小于0，转至步骤3，如果当前元素大于0，则没有向后遍历的意义，跳出循环</li>
<li>取当前元素后面的一个为左指针，数组末尾为右指针，寻找两个元素和与当前元素构成和为0的组合<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">threeSum</span><span class="params">(nums: List[int])</span> -&gt; List[List[int]]:</span></span><br><span class="line">    n=len(nums)</span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">not</span> nums <span class="keyword">or</span> n&lt;<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    nums.sort()</span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">if</span>(nums[i]&gt;<span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">if</span>(i&gt;<span class="number">0</span> <span class="keyword">and</span> nums[i]==nums[i<span class="number">-1</span>]):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        L=i+<span class="number">1</span></span><br><span class="line">        R=n<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span>(L&lt;R):</span><br><span class="line">            <span class="keyword">if</span>(nums[i]+nums[L]+nums[R]==<span class="number">0</span>):</span><br><span class="line">                res.append([nums[i],nums[L],nums[R]])</span><br><span class="line">                <span class="keyword">while</span>(L&lt;R <span class="keyword">and</span> nums[L]==nums[L+<span class="number">1</span>]):</span><br><span class="line">                    L=L+<span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span>(L&lt;R <span class="keyword">and</span> nums[R]==nums[R<span class="number">-1</span>]):</span><br><span class="line">                    R=R<span class="number">-1</span></span><br><span class="line">                L=L+<span class="number">1</span></span><br><span class="line">                R=R<span class="number">-1</span></span><br><span class="line">            <span class="keyword">elif</span>(nums[i]+nums[L]+nums[R]&gt;<span class="number">0</span>):</span><br><span class="line">                R=R<span class="number">-1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                L=L+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>双指针</tag>
        <tag>数组</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 14. 最长公共前缀</title>
    <url>/2019/12/24/LeetCode-14-%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%89%8D%E7%BC%80/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>编写一个函数来查找字符串数组中的最长公共前缀。</p>
<p>如果不存在公共前缀，返回空字符串 “”。</p>
<p>示例 1:</p>
<p>输入: [“flower”,”flow”,”flight”]<br>输出: “fl”<br>示例 2:</p>
<p>输入: [“dog”,”racecar”,”car”]<br>输出: “”<br>解释: 输入不存在公共前缀。<br>说明:</p>
<p>所有输入只包含小写字母 a-z 。</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/longest-common-prefix" target="_blank" rel="noopener">https://leetcode-cn.com/problems/longest-common-prefix</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>从第一个字符串开始遍历，如果该字符串不是其他字符串的前缀，则将该字符串长度减一。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestCommonPrefix</span><span class="params">(strs: List[str])</span> -&gt; str:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> strs:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">    res = strs[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(strs)):</span><br><span class="line">        <span class="keyword">while</span> strs[i].find(res) != <span class="number">0</span>:</span><br><span class="line">            res = res[<span class="number">0</span>:len(res) - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">longestCommonPrefix</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; strs)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strs.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    <span class="built_in">string</span> res = strs[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strs.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">        <span class="keyword">while</span> (strs[i].<span class="built_in">find</span>(res) != <span class="number">0</span>) &#123;</span><br><span class="line">            res = res.substr(<span class="number">0</span>, res.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>简单</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 11. 盛水最多的容器</title>
    <url>/2019/12/24/LeetCode-11-%E7%9B%9B%E6%B0%B4%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AE%B9%E5%99%A8/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定 n 个非负整数 a1，a2，…，an，每个数代表坐标中的一个点 (i, ai) 。在坐标内画 n 条垂直线，垂直线 i 的两个端点分别为 (i, ai) 和 (i, 0)。找出其中的两条线，使得它们与 x 轴共同构成的容器可以容纳最多的水。</p>
<p>说明：你不能倾斜容器，且 n 的值至少为 2。</p>
<p><img src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg" alt=""></p>
<p>图中垂直线代表输入数组 [1,8,6,2,5,4,8,3,7]。在此情况下，容器能够容纳水（表示为蓝色&gt; 部分）的最大值为 49。</p>
<p>示例:</p>
<p>输入: [1,8,6,2,5,4,8,3,7]<br>输出: 49</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/container-with-most-water" target="_blank" rel="noopener">https://leetcode-cn.com/problems/container-with-most-water</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><ol>
<li>使用双指针法</li>
<li>当两个指针指向的数值不相等时，移动较短的那个指针，由于木桶效应，实际上决定容器盛水多少的是较短的那个指针和两个指针间的距离<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">maxArea</span><span class="params">(height: List[int])</span> -&gt; int:</span></span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    end = len(height) - <span class="number">1</span></span><br><span class="line">    res = min(height[end], height[start])*(end - start)</span><br><span class="line">    <span class="keyword">while</span> start &lt; end:</span><br><span class="line">        <span class="keyword">if</span> height[start] &lt; height[end]:</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            end -= <span class="number">1</span></span><br><span class="line">        tmp = min(height[end], height[start])*(end - start)</span><br><span class="line">        res = max(res, tmp)</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<strong>C++解法</strong><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; <span class="built_in">height</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = <span class="built_in">height</span>.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> maxVal = INT_MIN;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">height</span>[left] &lt; <span class="built_in">height</span>[right])&#123;</span><br><span class="line">            maxVal = <span class="built_in">max</span>(maxVal, <span class="built_in">height</span>[left] * (right - left));</span><br><span class="line">            left ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            maxVal = <span class="built_in">max</span>(maxVal, <span class="built_in">height</span>[right] * (right - left));</span><br><span class="line">            right --;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxVal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>双指针</tag>
        <tag>数组</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 10. 正则表达式匹配</title>
    <url>/2019/12/23/LeetCode-10-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给你一个字符串 s 和一个字符规律 p，请你来实现一个支持 ‘.’ 和 ‘*’ 的正则表达式匹配。</p>
<p>‘.’ 匹配任意单个字符<br>‘*’ 匹配零个或多个前面的那一个元素<br>所谓匹配，是要涵盖 整个 字符串 s的，而不是部分字符串。</p>
<p>说明:</p>
<p>s 可能为空，且只包含从 a-z 的小写字母。<br>p 可能为空，且只包含从 a-z 的小写字母，以及字符 . 和 *。</p>
<p><strong>示例</strong> 1:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">s &#x3D; &quot;aa&quot;</span><br><span class="line">p &#x3D; &quot;a&quot;</span><br><span class="line">输出: false</span><br><span class="line">解释: &quot;a&quot; 无法匹配 &quot;aa&quot; 整个字符串。</span><br></pre></td></tr></table></figure></p>
<p><strong>示例</strong> 2:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">s &#x3D; &quot;aa&quot;</span><br><span class="line">p &#x3D; &quot;a*&quot;</span><br><span class="line">输出: true</span><br><span class="line">解释: 因为 &#39;*&#39; 代表可以匹配零个或多个前面的那一个元素, 在这里前面的元素就是 &#39;a&#39;。因此，字符串 &quot;aa&quot; 可被视为 &#39;a&#39; 重复了一次。</span><br></pre></td></tr></table></figure></p>
<p><strong>示例</strong> 3:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">s &#x3D; &quot;ab&quot;</span><br><span class="line">p &#x3D; &quot;.*&quot;</span><br><span class="line">输出: true</span><br><span class="line">解释: &quot;.*&quot; 表示可匹配零个或多个（&#39;*&#39;）任意字符（&#39;.&#39;）。</span><br></pre></td></tr></table></figure></p>
<p><strong>示例</strong> 4:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">s &#x3D; &quot;aab&quot;</span><br><span class="line">p &#x3D; &quot;c*a*b&quot;</span><br><span class="line">输出: true</span><br><span class="line">解释: 因为 &#39;*&#39; 表示零个或多个，这里 &#39;c&#39; 为 0 个, &#39;a&#39; 被重复一次。因此可以匹配字符串 &quot;aab&quot;。</span><br></pre></td></tr></table></figure></p>
<p><strong>示例</strong> 5:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入:</span><br><span class="line">s &#x3D; &quot;mississippi&quot;</span><br><span class="line">p &#x3D; &quot;mis*is*p*.&quot;</span><br><span class="line">输出: false</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/regular-expression-matching" target="_blank" rel="noopener">https://leetcode-cn.com/problems/regular-expression-matching</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="直接调用正则库（略）"><a href="#直接调用正则库（略）" class="headerlink" title="直接调用正则库（略）"></a>直接调用正则库（略）</h2><h2 id="回溯"><a href="#回溯" class="headerlink" title="回溯"></a>回溯</h2><ol>
<li>考虑最简单的情况，如果没有<code>.</code>，<code>*</code>，我们所需要对比的就只有两个字符串是否相同，那么最简单的情况可以写成以下方式<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span><span class="params">(s: str, p: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p: <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    first_s = s[<span class="number">0</span>]</span><br><span class="line">    first_p = p[<span class="number">0</span>]</span><br><span class="line">    tmpRes = (first_s == first_p)</span><br><span class="line">    <span class="keyword">return</span> tmpRes <span class="keyword">and</span> isMatch(s[<span class="number">1</span>:], p[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure></li>
<li>由于<code>.</code>可以匹配任意字符，则以上函数可以改写为：</li>
</ol>
<p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span><span class="params">(s: str, p: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p: <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    first_s = s[<span class="number">0</span>]</span><br><span class="line">    first_p = p[<span class="number">0</span>]</span><br><span class="line">    tmpRes = (first_p <span class="keyword">in</span> [first_s, <span class="string">'.'</span>])</span><br><span class="line">    <span class="keyword">return</span> tmpRes <span class="keyword">and</span> isMatch(s[<span class="number">1</span>:], p[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure></p>
<ol>
<li>最难的部分在于<code>*</code>。由于<code>*</code>指代前面的字符出现了0次或者一次，假设<code>p[j + 1] == &#39;*&#39;</code>那么可以有以下推论：<script type="math/tex; mode=display">
P(s[i:], p[j:]) = P(s[i:], p[j + 2:]) or P(s[i + 1:], p[j:])</script>根据这个，以上的函数可以改写为：</li>
</ol>
<p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span><span class="params">(s: str, p: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p: <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    first_s = s[<span class="number">0</span>]</span><br><span class="line">    first_p = p[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> len(p) &gt;= <span class="number">2</span> <span class="keyword">and</span> p[<span class="number">1</span>] == <span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">return</span> isMatch(s[:], p[<span class="number">2</span>:]) <span class="keyword">or</span> isMatch(s[<span class="number">1</span>:], p[:])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmpRes = (first_p <span class="keyword">in</span> [first_s, <span class="string">'.'</span>])</span><br><span class="line">        <span class="keyword">return</span> tmpRes <span class="keyword">and</span> isMatch(s[<span class="number">1</span>:], p[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure><br>将以上函数风格进行优化<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isMatch</span><span class="params">(s: str, p: str)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p: <span class="keyword">return</span> <span class="keyword">not</span> s </span><br><span class="line">    first = bool(s) <span class="keyword">and</span> p[<span class="number">0</span>] <span class="keyword">in</span> [s[<span class="number">0</span>], <span class="string">'.'</span>]</span><br><span class="line">    <span class="keyword">if</span> len(p) &gt;= <span class="number">2</span> <span class="keyword">and</span> p[<span class="number">1</span>] == <span class="string">"*"</span>:</span><br><span class="line">        <span class="keyword">return</span> (self.isMatch(s, p[<span class="number">2</span>:])) <span class="keyword">or</span> (first <span class="keyword">and</span> self.isMatch(s[<span class="number">1</span>:], p)) </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> first <span class="keyword">and</span> self.isMatch(s[<span class="number">1</span>:], p[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>动态规划</tag>
        <tag>回溯算法</tag>
        <tag>困难</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 9. 回文数</title>
    <url>/2019/12/23/LeetCode-9-%E5%9B%9E%E6%96%87%E6%95%B0/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>判断一个整数是否是回文数。回文数是指正序（从左向右）和倒序（从右向左）读都是一样的整数。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: 121</span><br><span class="line">输出: true</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: -121</span><br><span class="line">输出: false</span><br><span class="line">解释: 从左向右读, 为 -121 。 从右向左读, 为 121- 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><br><strong>示例 3:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: 10</span><br><span class="line">输出: false</span><br><span class="line">解释: 从右向左读, 为 01 。因此它不是一个回文数。</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/palindrome-number" target="_blank" rel="noopener">https://leetcode-cn.com/problems/palindrome-number</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="转换为字符串"><a href="#转换为字符串" class="headerlink" title="转换为字符串"></a>转换为字符串</h2><ol>
<li>将数字转换为字符串</li>
<li>前后各取一个指针进行对比<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span><span class="params">(x: int)</span> -&gt; bool:</span></span><br><span class="line">    tmpstr = str(x)</span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    end = len(tmpstr) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> start &lt;= end:</span><br><span class="line">        <span class="keyword">if</span> tmpstr[start] == tmpstr[end]:</span><br><span class="line">            start += <span class="number">1</span></span><br><span class="line">            end -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="计算数字的首末位"><a href="#计算数字的首末位" class="headerlink" title="计算数字的首末位"></a>计算数字的首末位</h2><p>对于数字的末位，直接取余就可以了，对于数字的首位，我们可以这么算。<br>首先用一个变量记录数字的最高位，<br>比如 12321，可以标记 help 为 10000，<br>第一个末位为 11，第一个首位为 12321/10000=1，<br>接下来我们需要计算 232 是否为回文，怎么计算呢？<br>我们需要去掉首位和末位。<br>可以采用 x % help / 10 的方式<br>12321%10000==2321 可以将最高位去掉，然后 2321/10==232 可以将最低为去掉。<br>最后不要忘记将 help/100。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPalindrome</span><span class="params">(x: int)</span> -&gt; bool:</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    help = <span class="number">1</span></span><br><span class="line">    tmp = x</span><br><span class="line">    <span class="keyword">while</span> tmp &gt;= <span class="number">10</span>:</span><br><span class="line">        tmp /= <span class="number">10</span></span><br><span class="line">        help *= <span class="number">10</span></span><br><span class="line">    <span class="keyword">while</span> x != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> (x % <span class="number">10</span> != x // help):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        x = x % help / <span class="number">10</span></span><br><span class="line">        help /= <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>简单</tag>
        <tag>数学</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 8. String to Integer字符串转换整型</title>
    <url>/2019/12/22/LeetCode-8-String-to-Integer%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E6%95%B4%E5%9E%8B/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>请你来实现一个 <code>atoi</code> 函数，使其能将字符串转换成整数。</p>
<p>首先，该函数会根据需要丢弃无用的开头空格字符，直到寻找到第一个非空格的字符为止。</p>
<p>当我们寻找到的第一个非空字符为正或者负号时，则将该符号与之后面尽可能多的连续数字组合起来，作为该整数的正负号；假如第一个非空字符是数字，则直接将其与之后连续的数字字符组合起来，形成整数。</p>
<p>该字符串除了有效的整数部分之后也可能会存在多余的字符，这些字符可以被忽略，它们对于函数不应该造成影响。</p>
<p>注意：假如该字符串中的第一个非空格字符不是一个有效整数字符、字符串为空或字符串仅包含空白字符时，则你的函数不需要进行转换。</p>
<p>在任何情况下，若函数不能进行有效的转换时，请返回 0。</p>
<p>说明：</p>
<p>假设我们的环境只能存储 32 位大小的有符号整数，那么其数值范围为 [−231,  231 − 1]。如果数值超过这个范围，请返回  INT_MAX (231 − 1) 或 INT_MIN (−231) 。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;42&quot;</span><br><span class="line">输出: 42</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;   -42&quot;</span><br><span class="line">输出: -42</span><br><span class="line">解释: 第一个非空白字符为 &#39;-&#39;, 它是一个负号。</span><br><span class="line">     我们尽可能将负号与后面所有连续出现的数字组合起来，最后得到 -42 。</span><br></pre></td></tr></table></figure><br><strong>示例 3:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;4193 with words&quot;</span><br><span class="line">输出: 4193</span><br><span class="line">解释: 转换截止于数字 &#39;3&#39; ，因为它的下一个字符不为数字。</span><br></pre></td></tr></table></figure><br><strong>示例 4:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;words and 987&quot;</span><br><span class="line">输出: 0</span><br><span class="line">解释: 第一个非空字符是 &#39;w&#39;, 但它不是数字或正、负号。</span><br><span class="line">     因此无法执行有效的转换。</span><br></pre></td></tr></table></figure><br><strong>示例 5:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;-91283472332&quot;</span><br><span class="line">输出: -2147483648</span><br><span class="line">解释: 数字 &quot;-91283472332&quot; 超过 32 位有符号整数范围。 </span><br><span class="line">     因此返回 INT_MIN (−231) 。</span><br></pre></td></tr></table></figure></p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/string-to-integer-atoi" target="_blank" rel="noopener">https://leetcode-cn.com/problems/string-to-integer-atoi</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myAtoi</span><span class="params">(str: str)</span> -&gt; int:</span></span><br><span class="line">    str = str.strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> str:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'0'</span> &lt;= str[<span class="number">0</span>] &lt;= <span class="string">'9'</span> <span class="keyword">or</span> str[<span class="number">0</span>] <span class="keyword">in</span> <span class="string">'+-'</span>:</span><br><span class="line">        start = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> start &lt; len(str):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">'0'</span> &lt;= str[start] &lt;= <span class="string">'9'</span>:</span><br><span class="line">                start += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> start == <span class="number">1</span> <span class="keyword">and</span> str[<span class="number">0</span>] <span class="keyword">in</span> <span class="string">'+-'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        res = int(str[:start])</span><br><span class="line">        <span class="keyword">if</span> res &lt;= <span class="number">-2</span>**<span class="number">31</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-2</span>**<span class="number">31</span></span><br><span class="line">        <span class="keyword">elif</span> res &gt;= <span class="number">2</span>**<span class="number">31</span> - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>**<span class="number">31</span> - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>中等</tag>
        <tag>数学</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 7. Reverse Integer整数反转</title>
    <url>/2019/12/22/LeetCode-7-Reverse-Integer%E6%95%B4%E6%95%B0%E5%8F%8D%E8%BD%AC/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给出一个 32 位的有符号整数，你需要将这个整数中每位上的数字进行反转。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: 123</span><br><span class="line">输出: 321</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: -123</span><br><span class="line">输出: -321</span><br></pre></td></tr></table></figure><br><strong>示例 3:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: 120</span><br><span class="line">输出: 21</span><br></pre></td></tr></table></figure><br>注意:</p>
<p>假设我们的环境只能存储得下 32 位的有符号整数，则其数值范围为 [−231,  231 − 1]。请根据这个假设，如果反转后整数溢出那么就返回 0。</p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/reverse-integer" target="_blank" rel="noopener">https://leetcode-cn.com/problems/reverse-integer</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><ol>
<li>取符号位</li>
<li>求整数的绝对值并将其转化为字符串</li>
<li>翻转字符串，并转换为int，最后加上符号位<br><strong>Python 解法</strong><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(x: int)</span> -&gt; int:</span></span><br><span class="line">    sign = <span class="number">1</span> <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">-1</span></span><br><span class="line">    tmpStr = str(abs(x))</span><br><span class="line">    res = sign * int(tmpStr[::<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span>  res <span class="keyword">if</span> <span class="number">-2</span>**<span class="number">31</span> &lt;= res &lt;= <span class="number">2</span>**<span class="number">31</span> - <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>简单</tag>
        <tag>数学</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 6.ZigZag Conversion Z字形变换</title>
    <url>/2019/12/22/LeetCode-6-ZigZag-Conversion-Z%E5%AD%97%E5%BD%A2%E5%8F%98%E6%8D%A2/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>将一个给定字符串根据给定的行数，以从上往下、从左到右进行 Z 字形排列。</p>
<p>比如输入字符串为 “LEETCODEISHIRING” 行数为 3 时，排列如下：<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">L   C   I   R</span><br><span class="line">E T O E S I I G</span><br><span class="line">E   D   H   N</span><br></pre></td></tr></table></figure><br>之后，你的输出需要从左往右逐行读取，产生出一个新的字符串，比如：”LCIRETOESIIGEDHN”。</p>
<p>请你实现这个将字符串进行指定行数变换的函数：</p>
<p>string convert(string s, int numRows);<br><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: s &#x3D; &quot;LEETCODEISHIRING&quot;, numRows &#x3D; 3</span><br><span class="line">输出: &quot;LCIRETOESIIGEDHN&quot;</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: s &#x3D; &quot;LEETCODEISHIRING&quot;, numRows &#x3D; 4</span><br><span class="line">输出: &quot;LDREOEIIECIHNTSG&quot;</span><br></pre></td></tr></table></figure><br>解释:<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">L     D     R</span><br><span class="line">E   O E   I I</span><br><span class="line">E C   I H   N</span><br><span class="line">T     S     G</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/zigzag-conversion" target="_blank" rel="noopener">https://leetcode-cn.com/problems/zigzag-conversion</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert</span><span class="params">(s: str, numRows: int)</span> -&gt; str:</span></span><br><span class="line">    result = []</span><br><span class="line">    appendorder = list(range(numRows)) + list(range(numRows - <span class="number">2</span>, <span class="number">0</span>, <span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">    str_index = <span class="number">0</span></span><br><span class="line">    order_index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> str_index &lt; len(s):</span><br><span class="line">        <span class="keyword">if</span> appendorder[order_index] &gt;= len(result):</span><br><span class="line">            result.append(<span class="string">""</span>)</span><br><span class="line">        result[appendorder[order_index]] += s[str_index]</span><br><span class="line">        order_index += <span class="number">1</span></span><br><span class="line">        str_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> order_index == len(appendorder):</span><br><span class="line">            order_index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>.join(result)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>中等</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 5. Longest Palindromic Substring最长回文子串</title>
    <url>/2019/12/21/LeetCode-5-Longest-Palindromic-Substring%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个字符串 s，找到 s 中最长的回文子串。你可以假设 s 的最大长度为 1000。</p>
<p><strong>示例 1：</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;babad&quot;</span><br><span class="line">输出: &quot;bab&quot;</span><br><span class="line">注意: &quot;aba&quot; 也是一个有效答案。</span><br></pre></td></tr></table></figure><br><strong>示例 2：</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;cbbd&quot;</span><br><span class="line">输出: &quot;bb&quot;</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/longest-palindromic-substring" target="_blank" rel="noopener">https://leetcode-cn.com/problems/longest-palindromic-substring</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="中心扩散法"><a href="#中心扩散法" class="headerlink" title="中心扩散法"></a>中心扩散法</h2><p>回文字符串一定是对称的，因此我们可以选择一个中心，向两边扩散判断字符串是否符合标准<br><img src="https://pic.leetcode-cn.com/1b9bfe346a4a9a5718b08149be11236a6db61b3922265d34f22632d4687aa0a8-image.png" alt=""><br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span><span class="params">(s: str)</span> -&gt; str:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span> len(s) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> s </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_padding</span><span class="params">(left: int, right: int)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> left &gt;= <span class="number">0</span> <span class="keyword">and</span> right &lt; len(s):</span><br><span class="line">            <span class="keyword">if</span> s[left] == s[right]:</span><br><span class="line">                left -= <span class="number">1</span></span><br><span class="line">                right += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> s[left + <span class="number">1</span>: right], right - left - <span class="number">1</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        odd, odd_length = _padding(i,i)</span><br><span class="line">        even, even_length = _padding(i, i + <span class="number">1</span>)</span><br><span class="line">        tmpStr = odd <span class="keyword">if</span> odd_length &gt; even_length <span class="keyword">else</span> even</span><br><span class="line">        res = res <span class="keyword">if</span> len(res) &gt; len(tmpStr) <span class="keyword">else</span> tmpStr</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><br><a id="more"></a></p>
<h2 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h2><p>给出该子串<code>s[i:j + 1]</code> 为回文的传递方程</p>
<script type="math/tex; mode=display">
P(i,j) = (P(i + 1, j - 1) and s[i] == s[j])</script><p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span><span class="params">(s: str)</span> -&gt; str:</span></span><br><span class="line">        size = len(s)</span><br><span class="line">        <span class="keyword">if</span> size &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        <span class="comment"># 二维 dp 问题</span></span><br><span class="line">        <span class="comment"># 状态：dp[l,r]: s[l:r] 包括 l，r ，表示的字符串是不是回文串</span></span><br><span class="line">        <span class="comment"># 设置为 None 是为了方便调试，看清楚代码执行流程</span></span><br><span class="line">        dp = [[<span class="literal">False</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(size)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(size)]</span><br><span class="line"></span><br><span class="line">        longest_l = <span class="number">1</span></span><br><span class="line">        res = s[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 因为只有 1 个字符的情况在最开始做了判断</span></span><br><span class="line">        <span class="comment"># 左边界一定要比右边界小，因此右边界从 1 开始</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">1</span>, size):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> range(r):</span><br><span class="line">                <span class="comment"># 状态转移方程：如果头尾字符相等并且中间也是回文</span></span><br><span class="line">                <span class="comment"># 在头尾字符相等的前提下，如果收缩以后不构成区间（最多只有 1 个元素），直接返回 True 即可</span></span><br><span class="line">                <span class="comment"># 否则要继续看收缩以后的区间的回文性</span></span><br><span class="line">                <span class="comment"># 重点理解 or 的短路性质在这里的作用</span></span><br><span class="line">                <span class="keyword">if</span> s[l] == s[r] <span class="keyword">and</span> (r - l &lt;= <span class="number">2</span> <span class="keyword">or</span> dp[l + <span class="number">1</span>][r - <span class="number">1</span>]):</span><br><span class="line">                    dp[l][r] = <span class="literal">True</span></span><br><span class="line">                    cur_len = r - l + <span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> cur_len &gt; longest_l:</span><br><span class="line">                        longest_l = cur_len</span><br><span class="line">                        res = s[l:r + <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># 调试语句</span></span><br><span class="line">            <span class="comment"># for item in dp:</span></span><br><span class="line">            <span class="comment">#     print(item)</span></span><br><span class="line">            <span class="comment"># print('---')</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>动态规划</tag>
        <tag>中等</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 4.Median of Two Sorted Arrays寻找两个有序数组的中位数</title>
    <url>/2019/12/21/LeetCode-4-Median-of-Two-Sorted-Arrays%E5%AF%BB%E6%89%BE%E4%B8%A4%E4%B8%AA%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E4%B8%AD%E4%BD%8D%E6%95%B0/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定两个大小为 m 和 n 的有序数组 nums1 和 nums2。</p>
<p>请你找出这两个有序数组的中位数，并且要求算法的时间复杂度为 O(log(m + n))。</p>
<p>你可以假设 nums1 和 nums2 不会同时为空。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nums1 &#x3D; [1, 3]</span><br><span class="line">nums2 &#x3D; [2]</span><br><span class="line"></span><br><span class="line">则中位数是 2.0</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nums1 &#x3D; [1, 2]</span><br><span class="line">nums2 &#x3D; [3, 4]</span><br><span class="line"></span><br><span class="line">则中位数是 (2 + 3)&#x2F;2 &#x3D; 2.5</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays" target="_blank" rel="noopener">https://leetcode-cn.com/problems/median-of-two-sorted-arrays</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="1-合并两个数组然后取中位数"><a href="#1-合并两个数组然后取中位数" class="headerlink" title="1. 合并两个数组然后取中位数"></a>1. 合并两个数组然后取中位数</h2><p><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findMedianSortedArrays</span><span class="params">(nums1: List[int], nums2: List[int])</span> -&gt; float:</span></span><br><span class="line">    _temp = nums1 + nums2</span><br><span class="line">    _temp.sort()</span><br><span class="line">    _length = len(_temp)</span><br><span class="line">    <span class="keyword">if</span> _length % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (_temp[_length // <span class="number">2</span> - <span class="number">1</span>]+_temp[_length // <span class="number">2</span>])/<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> _temp[(_length - <span class="number">1</span>) // <span class="number">2</span>]</span><br></pre></td></tr></table></figure><br><a id="more"></a><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = nums1.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">int</span> m = nums2.<span class="built_in">size</span>();</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tmpNum;</span><br><span class="line">    tmpNum.insert(tmpNum.<span class="built_in">end</span>(), nums1.<span class="built_in">begin</span>(), nums1.<span class="built_in">end</span>());</span><br><span class="line">    tmpNum.insert(tmpNum.<span class="built_in">end</span>(), nums2.<span class="built_in">begin</span>(), nums2.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    sort(tmpNum.<span class="built_in">begin</span>(), tmpNum.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((n + m) % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> (<span class="keyword">double</span>)(tmpNum[(n + m)/<span class="number">2</span> - <span class="number">1</span>] + tmpNum[(n + m)/<span class="number">2</span>]) / <span class="number">2.0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> tmpNum[(n + m)/<span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="2-二分法"><a href="#2-二分法" class="headerlink" title="2. 二分法"></a>2. 二分法</h2><p>摘自windliang大佬题解：</p>
<blockquote>
<p>题目要求 <code>O(log(n))</code>的时间复杂度看到 <code>log</code>，很明显，我们只有用到二分的方法才能达到。我们不妨用另一种思路，题目是求中位数，其实就是求第 <code>k</code> 小数的一种特殊情况，而求第 <code>k</code> 小数有一种算法。</p>
<p>假设我们要找第 <code>k</code> 小数，我们可以每次循环排除掉 <code>k/2</code> 个数。看下边一个例子。</p>
<p>假设我们要找第 <code>7</code> 小的数字。</p>
<p><img src="https://pic.leetcode-cn.com/735ea8129ab5b56b7058c6286217fa4bb5f8a198e4c8b2172fe0f75b29a966cd-image.png" alt="enter image description here"></p>
<p>我们比较两个数组的第 <code>k/2</code> 个数字，如果 <code>k</code> 是奇数，向下取整。也就是比较第 3 个数字，上边数组中的 4 和下边数组中的 3，如果哪个小，就表明该数组的前 <code>k/2</code> 个数字都不是第 <code>k</code> 小数字，所以可以排除。也就是 1，2，3 这三个数字不可能是第 7 小的数字，我们可&gt; 以把它排除掉。将 1349 和 45678910 两个数组作为新的数组进行比较。</p>
<p>更一般的情况 <code>A[1]</code> ，<code>A[2]</code> ，<code>A[3]</code>，<code>A[k/2]</code> … ，<code>B[1]</code>，<code>B[2]</code>，<code>B[3]</code>，<code>B[k/2]</code> … ，如果 <code>A[k/2]</code>&lt;<code>B[k/2]</code> ，那么<code>A[1]</code>，<code>A[2]</code>，<code>A[3]</code>，<code>A[k/2]</code>都不可能是第 <code>k</code> 小的数字。</p>
<p>A 数组中比 <code>A[k/2]</code> 小的数有 <code>k/2-1</code> 个，B 数组中，<code>B[k/2]</code> 比 <code>A[k/2]</code> 小，假设 <code>B[k/2]</code>前边的数字都比 <code>A[k/2]</code> 小，也只有 <code>k/2-1</code> 个，所以比 <code>A[k/2]</code> 小的数字最多有 <code>k/1-1+k/2-1=k-2</code>个，所以 <code>A[k/2]</code> 最多是第 <code>k-1</code> 小的数。而比 <code>A[k/2]</code> 小的数更不可能是第 <code>k</code> 小的数了，所以可以把它们排除。</p>
<p>橙色的部分表示已经去掉的数字。</p>
<p><img src="https://pic.leetcode-cn.com/09b8649cd2b8bbea74f7f632b098fed5f8404530ff44b5a0b54a360b3cf7dd8f-image.png" alt="enter image description here"></p>
<p>由于我们已经排除掉了 3 个数字，就是这 3 个数字一定在最前边，所以在两个新数组中，我们&gt; 只需要找第 7 - 3 = 4 小的数字就可以了，也就是 k = 4。此时两个数组，比较第 2 个数&gt; 字，3 &lt; 5，所以我们可以把小的那个数组中的 1 ，3 排除掉了。</p>
<p><img src="https://pic.leetcode-cn.com/f2d72fd3dff109ad810895b9a0c8d8782f47df6b2f24f9de72704961bc547fcb-image.png" alt="enter image description here"></p>
<p>我们又排除掉 2 个数字，所以现在找第 4 - 2 = 2 小的数字就可以了。此时比较两个数组中&gt; 的第 k / 2 = 1 个数，4 == 4，怎么办呢？由于两个数相等，所以我们无论去掉哪个数组中&gt; 的都行，因为去掉 1 个总会保留 1 个的，所以没有影响。为了统一，我们就假设 4 &gt; 4 吧，&gt; 所以此时将下边的 4 去掉。</p>
<p><img src="https://pic.leetcode-cn.com/3c89a8ea29f2e19057b57242c8bc37c5f09b6796b96c30f3d42caea21c12f294-image.png" alt="enter image description here"></p>
<p>由于又去掉 1 个数字，此时我们要找第 1 小的数字，所以只需判断两个数组中第一个数字哪个&gt; 小就可以了，也就是 4。</p>
<p>所以第 7 小的数字是 4。</p>
<p>我们每次都是取 <code>k/2</code> 的数进行比较，有时候可能会遇到数组长度小于 <code>k/2</code>的时候。<br><img src="https://pic.leetcode-cn.com/ad87d1f63a9bbd99e12605686290800ce61b03f9fb98d87f1d8c020d404421ac-image.png" alt="enter image description here"><br>此时 <code>k/2</code> 等于 3，而上边的数组长度是 2，我们此时将箭头指向它的末尾就可以了。这样的&gt; 话，由于 2 &lt; 3，所以就会导致上边的数组 1，2 都被排除。造成下边的情况。</p>
<p><img src="https://pic.leetcode-cn.com/7ea1963f184b1dcaddf951326ccbe7aa09cfbb9ebee7fffb2ede131853b3d1de-image.png" alt=""></p>
<p>由于 2 个元素被排除，所以此时 <code>k = 5</code>，又由于上边的数组已经空了，我们只需要返回下边的数组的第 5 个数字就可以了。</p>
<p>从上边可以看到，无论是找第奇数个还是第偶数个数字，对我们的算法并没有影响，而且在算法进行中，<code>k</code> 的值都有可能从奇数变为偶数，最终都会变为 1 或者由于一个数组空了，直接返回结果。</p>
<p>所以我们采用递归的思路，为了防止数组长度小于<code>k/2</code>，所以每次比较 <code>min(k/2，len(数组)</code>对应的数字，把小的那个对应的数组的数字排除，将两个新数组进入递归，并且 k 要减去排除的数字的个数。递归出口就是当 k=1 或者其中一个数字长度是 0 了。</p>
<p>作者：windliang<br>链接：<a href="https://leetcode-cn.com/problems/median-of-two-sorted-arrays/solution/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-by-w-2/" target="_blank" rel="noopener">https://leetcode-cn.com/problems/median-of-two-sorted-arrays/solution/xiang-xi-tong-su-de-si-lu-fen-xi-duo-jie-fa-by-w-2/</a><br>来源：力扣（LeetCode）<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<br><strong>Python 解法</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findMedianSortedArrays</span><span class="params">(nums1: List[int], nums2: List[int])</span> -&gt; float:</span></span><br><span class="line">    n = len(nums1)</span><br><span class="line">    m = len(nums2)</span><br><span class="line">    <span class="comment"># 将偶数情况和奇数情况合并，当是奇数时，会计算两次同样的k</span></span><br><span class="line">    left = (n + m + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    right = (n + m + <span class="number">2</span>) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(nums1: List[int], start1: int, end1: int, nums2: List[int], start2: int, end2: int, k: int)</span> -&gt; int:</span></span><br><span class="line">        l1 = end1 - start1 + <span class="number">1</span></span><br><span class="line">        l2 = end2 - start2 + <span class="number">1</span></span><br><span class="line">        <span class="comment"># 始终保证l1 长度小于l2，如果有数组为空，则一定是num1</span></span><br><span class="line">        <span class="keyword">if</span> (l1 &gt; l2): <span class="keyword">return</span> helper(nums2, start2, end2, nums1, start1, end1, k)</span><br><span class="line">        <span class="keyword">if</span> (l1 == <span class="number">0</span>): <span class="keyword">return</span> nums2[start2 + k - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">1</span>): <span class="keyword">return</span> min(nums1[start1], nums2[start2])</span><br><span class="line"></span><br><span class="line">        i = start1 + min(l1, k // <span class="number">2</span>) - <span class="number">1</span></span><br><span class="line">        j = start2 + min(l2, k // <span class="number">2</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> nums1[i] &gt; nums2[j]:</span><br><span class="line">            <span class="keyword">return</span> helper(nums1, start1, end1, nums2, j + <span class="number">1</span>, end2, k - (j - start2 + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> helper(nums1, i + <span class="number">1</span>, end1, nums2, start2, end2, k - (i - start1 + <span class="number">1</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (helper(nums1, <span class="number">0</span>, n - <span class="number">1</span>, nums2, <span class="number">0</span>, m - <span class="number">1</span>, left) + helper(nums1, <span class="number">0</span>, n - <span class="number">1</span>, nums2, <span class="number">0</span>, m - <span class="number">1</span>, right)) / <span class="number">2</span></span><br></pre></td></tr></table></figure><br><strong>C++解法</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = nums1.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">int</span> m = nums2.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">int</span> left = (n + m + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> right = (n + m + <span class="number">2</span>) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>)(findKthSmallest(nums1, <span class="number">0</span>, n - <span class="number">1</span>, nums2, <span class="number">0</span>, m - <span class="number">1</span>, left) + findKthSmallest(nums1, <span class="number">0</span>, n - <span class="number">1</span>, nums2, <span class="number">0</span>, m - <span class="number">1</span>, right)) / <span class="number">2.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">findKthSmallest</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="keyword">int</span> start1, <span class="keyword">int</span> end1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2, <span class="keyword">int</span> start2, <span class="keyword">int</span> end2, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l1 = end1 - start1 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> l2 = end2 - start2 + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l1 &gt; l2) <span class="keyword">return</span> findKthSmallest(nums2, start2, end2, nums1, start1, end1, k);</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="number">0</span>) <span class="keyword">return</span> nums2[start2 + k - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">min</span>(nums1[start1], nums2[start2]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i = start1 + <span class="built_in">min</span>(l1, k / <span class="number">2</span>) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> j = start2 + <span class="built_in">min</span>(l2, k / <span class="number">2</span>) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (nums1[i] &gt; nums2[j]) <span class="keyword">return</span> findKthSmallest(nums1, start1, end1, nums2, j + <span class="number">1</span>, end2, k - (j - start2 + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> findKthSmallest(nums1, i + <span class="number">1</span>, end1, nums2, start2, end2, k - (i - start1 + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h1 id="3-从中位数定义出发，切割数组，实现二分"><a href="#3-从中位数定义出发，切割数组，实现二分" class="headerlink" title="3. 从中位数定义出发，切割数组，实现二分"></a>3. 从中位数定义出发，切割数组，实现二分</h1><p>TBD</p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>困难</tag>
        <tag>数组</tag>
        <tag>分治算法</tag>
        <tag>二分查找</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 3.Longest Substring Without Repeating Characters无重复最长子串</title>
    <url>/2019/12/19/LeetCode-3-Longest-Substring-Without-Repeating-Characters%E6%97%A0%E9%87%8D%E5%A4%8D%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个字符串，请你找出其中不含有重复字符的 <strong>最长子串</strong> 的长度。</p>
<p><strong>示例 1:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;abcabcbb&quot;</span><br><span class="line">输出: 3 </span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;abc&quot;，所以其长度为 3。</span><br></pre></td></tr></table></figure><br><strong>示例 2:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;bbbbb&quot;</span><br><span class="line">输出: 1</span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;b&quot;，所以其长度为 1。</span><br></pre></td></tr></table></figure><br><strong>示例 3:</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">输入: &quot;pwwkew&quot;</span><br><span class="line">输出: 3</span><br><span class="line">解释: 因为无重复字符的最长子串是 &quot;wke&quot;，所以其长度为 3。</span><br><span class="line">     请注意，你的答案必须是 子串 的长度，&quot;pwke&quot; 是一个子序列，不是子串。</span><br></pre></td></tr></table></figure></p>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters" target="_blank" rel="noopener">https://leetcode-cn.com/problems/longest-substring-without-repeating-characters</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路s"><a href="#解题思路s" class="headerlink" title="解题思路s"></a>解题思路s</h1><h2 id="利用集合构造滑动窗口"><a href="#利用集合构造滑动窗口" class="headerlink" title="利用集合构造滑动窗口"></a>利用集合构造滑动窗口</h2><ol>
<li>新建集合</li>
<li>新建快慢两个指针</li>
<li>先移动快指针，如果新加入字符不在集合中，则将其加入集合，并更新最大值</li>
<li>如果新加入字符已经在集合中，则向右移动慢指针，并同时从集合中删除指针指向的元素，直到字串中不存在重复元素</li>
</ol>
<p><strong>python</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(s: str)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    lookup = set()</span><br><span class="line">    left = <span class="number">0</span></span><br><span class="line">    maxLength = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        <span class="keyword">while</span> s[i] <span class="keyword">in</span> lookup:</span><br><span class="line">            lookup.remove(s[left])</span><br><span class="line">            left += <span class="number">1</span></span><br><span class="line">        lookup.add(s[i])</span><br><span class="line">        maxLength = max(maxLength, i - left + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> maxLength</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong>C++</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">unordered_set</span>&lt;<span class="keyword">char</span>&gt; lookup;</span><br><span class="line">    <span class="keyword">int</span> maxLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (lookup.<span class="built_in">find</span>(s[i]) != lookup.<span class="built_in">end</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            lookup.erase(s[left]);</span><br><span class="line">            left ++;</span><br><span class="line">        &#125;</span><br><span class="line">        lookup.insert(s[i]);</span><br><span class="line">        maxLength = <span class="built_in">max</span>(maxLength, i - left + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxLength;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><!--more--></p>
<h2 id="考虑优化"><a href="#考虑优化" class="headerlink" title="考虑优化"></a>考虑优化</h2><p>新加入字符已经在现有的窗口时,不需要对窗口一步一步缩减，可以直接将窗口的左指针移到该字符上一次出现的位置之后</p>
<p><strong>python</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(s: str)</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    lookup = &#123;&#125;</span><br><span class="line">    left = <span class="number">0</span></span><br><span class="line">    maxLength = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">        <span class="keyword">if</span> s[i] <span class="keyword">in</span> lookup <span class="keyword">and</span> left &lt;= lookup[s[i]]:</span><br><span class="line">            left = lookup[s[i]] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            maxLength = max(maxLength, i - left + <span class="number">1</span>)</span><br><span class="line">        lookup[s[i]] = i</span><br><span class="line">    <span class="keyword">return</span> maxLength</span><br></pre></td></tr></table></figure></p>
<p><strong>C++</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; lookup;</span><br><span class="line">    <span class="keyword">int</span> maxLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (lookup.<span class="built_in">find</span>(s[i]) != lookup.<span class="built_in">end</span>() &amp;&amp; left &lt;= lookup[s[i]])</span><br><span class="line">        &#123;</span><br><span class="line">            left = lookup[s[i]] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            maxLength = <span class="built_in">max</span>(maxLength, i - left + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        lookup[s[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxLength;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>字符串</tag>
        <tag>中等</tag>
        <tag>双指针</tag>
        <tag>哈希</tag>
        <tag>hashmap</tag>
        <tag>滑动窗口</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 2. Add Two Numbers 两数相加</title>
    <url>/2019/12/19/LeetCode-2-Add-Two-Numbers-%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给出两个 <strong>非空</strong> 的链表用来表示两个非负的整数。其中，它们各自的位数是按照 <strong>逆序</strong> 的方式存储的，并且它们的每个节点只能存储 <strong>一位</strong> 数字。</p>
<p>如果，我们将这两个数相加起来，则会返回一个新的链表来表示它们的和。</p>
<p>您可以假设除了数字 0 之外，这两个数都不会以 0 开头。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">示例：</span><br><span class="line"></span><br><span class="line">输入：(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)</span><br><span class="line">输出：7 -&gt; 0 -&gt; 8</span><br><span class="line">原因：342 + 465 &#x3D; 807</span><br></pre></td></tr></table></figure>
<p>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/add-two-numbers" target="_blank" rel="noopener">https://leetcode-cn.com/problems/add-two-numbers</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>使用变量<code>carry</code>来记录进位，每次只加两个链表的一位，更新<code>carry</code></p>
<h2 id="递归写法"><a href="#递归写法" class="headerlink" title="递归写法"></a>递归写法</h2><p><strong>Python</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">    head = ListNode(<span class="number">0</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(l1: ListNode, l2: ListNode, carry: int, tmp: ListNode)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1 <span class="keyword">and</span> <span class="keyword">not</span> l2 <span class="keyword">and</span> carry != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        x = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        y = l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        value = (x + y + carry) % <span class="number">10</span></span><br><span class="line">        carry = (x + y + carry) // <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        tmp.next = ListNode(value)</span><br><span class="line">        tmp = tmp.next</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1 <span class="keyword">and</span> <span class="keyword">not</span> l2:</span><br><span class="line">            helper(<span class="literal">None</span>, <span class="literal">None</span>, carry, tmp)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> l1:</span><br><span class="line">            helper(<span class="literal">None</span>, l2.next, carry, tmp)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> l2:</span><br><span class="line">            helper(l1.next, <span class="literal">None</span>, carry, tmp)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            helper(l1.next, l2.next, carry, tmp)</span><br><span class="line">    helper(l1, l2, <span class="number">0</span>, head)</span><br><span class="line">    <span class="keyword">return</span> head.next</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong>C++</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode l2)</span></span>&#123;</span><br><span class="line">    ListNode* head =<span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    helper(l1, l2, <span class="number">0</span>, head);</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">helper</span><span class="params">(ListNode* l1, ListNode* l2, <span class="keyword">int</span> carry, ListNode* tmp)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="literal">NULL</span> &amp;&amp; l2 == <span class="literal">NULL</span> &amp;&amp; carry == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">    x = l1?l1-&gt;val:<span class="number">0</span>;</span><br><span class="line">    y = l2?l2-&gt;val:<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    value = (x + y + carry) % <span class="number">10</span>;</span><br><span class="line">    carry = (x + y + carry) / <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    tmp-&gt;next = <span class="keyword">new</span> ListNode(value);</span><br><span class="line">    tmp = tmp-&gt;next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (l1 == <span class="literal">NULL</span> &amp;&amp; l2 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        helper(<span class="literal">NULL</span>, <span class="literal">NULL</span>, carry, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (l1 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        helper(<span class="literal">NULL</span>, l2-&gt;next, carry, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (l2 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        helper(l1-&gt;next, <span class="literal">NULL</span>, carry, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        helper(l1-&gt;next, l2-&gt;next, carry, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="迭代写法"><a href="#迭代写法" class="headerlink" title="迭代写法"></a>迭代写法</h2><p><strong>Python</strong><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">    carry = <span class="number">0</span></span><br><span class="line">    head = ListNode(<span class="number">0</span>)</span><br><span class="line">    tmp = head</span><br><span class="line">    <span class="keyword">while</span> l1 <span class="keyword">or</span> l2 <span class="keyword">or</span> carry:</span><br><span class="line">        x = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        y = l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        tmp.next = ListNode((x + y + carry) % <span class="number">10</span>)</span><br><span class="line">        carry = (x + y + carry) // <span class="number">10</span></span><br><span class="line">        tmp = tmp.next</span><br><span class="line"></span><br><span class="line">        l1 = l1.next <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">        l2 = l2.next <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> carry == <span class="number">1</span>:</span><br><span class="line">        tmp.next = ListNode(carry)</span><br><span class="line">    <span class="keyword">return</span> head.next</span><br></pre></td></tr></table></figure></p>
<p><strong>C++</strong><br><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode l2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    ListNode* head = <span class="keyword">new</span> ListNode(<span class="number">0</span>);</span><br><span class="line">    ListNode* tmp = head;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (l1 || l2 || carry != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x = l1?l1-&gt;val:<span class="number">0</span>;</span><br><span class="line">        y = l2?l2-&gt;val:<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        tmp-&gt;next = <span class="keyword">new</span> ListNode((x + y + carry) % <span class="number">10</span>);</span><br><span class="line">        carry = (x + y + carry) / <span class="number">10</span>;</span><br><span class="line">        tmp = tmp-&gt;next;</span><br><span class="line"></span><br><span class="line">        l1 = l1?l1-&gt;next:<span class="literal">NULL</span>;</span><br><span class="line">        l2 = l2?l2-&gt;next:<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (carry == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp-&gt;next = <span class="keyword">new</span> ListNode(carry);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head-&gt;next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>中等</tag>
        <tag>链表</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode - 1. Two Sum 两数之和</title>
    <url>/2019/12/19/LeetCode-1-Two-Sum-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/</url>
    <content><![CDATA[<h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><blockquote>
<p>给定一个整数数组 <code>nums</code> 和一个目标值 <code>target</code>，请你在该数组中找出和为目标值的那 两个<br>整数，并返回他们的数组下标。</p>
<p>你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;示例:</span><br><span class="line"></span><br><span class="line">&gt;给定 nums &#x3D; [2, 7, 11, 15], target &#x3D; 9</span><br><span class="line"></span><br><span class="line">&gt;因为 nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9</span><br><span class="line">&gt;所以返回 [0, 1]</span><br></pre></td></tr></table></figure><br>来源：力扣（LeetCode）<br>链接：<a href="https://leetcode-cn.com/problems/two-sum" target="_blank" rel="noopener">https://leetcode-cn.com/problems/two-sum</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>
</blockquote>
<h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="1-暴力解法"><a href="#1-暴力解法" class="headerlink" title="1. 暴力解法"></a>1. 暴力解法</h2><p>嵌套循环遍历该数组，寻找和为<code>target</code>的数组对，时间复杂度 <strong>O(N^2)</strong></p>
<p>实现过于简单，不做陈述。</p>
<h2 id="2-哈希"><a href="#2-哈希" class="headerlink" title="2. 哈希"></a>2. 哈希</h2><ol>
<li>遍历数组，将其值作为key，下标作为value存入哈希表中</li>
<li>第二次遍历数组，使用target减去当前数值，确认是否差在数组中存在<br>时间复杂度 <strong>O(N)</strong></li>
</ol>
<p><strong>Python 解法</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">    tmpDict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">        tmpDict[nums[i]] = i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">        <span class="keyword">if</span> target - nums[i] <span class="keyword">in</span> tmpDict <span class="keyword">and</span> i != tmpDict[target - nums[i]]:</span><br><span class="line">            <span class="keyword">return</span> [i, tmpDict[target - nums[i]]]</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p><strong>C++ 解法</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="built_in">map</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; result(<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; nums.<span class="built_in">size</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">map</span>[nums[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; nums.<span class="built_in">size</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">map</span>.count(target - nums[i]) &amp;&amp; <span class="built_in">map</span>[target - nums[i]] != i)</span><br><span class="line">        &#123;</span><br><span class="line">            result[<span class="number">0</span>] = i;</span><br><span class="line">            result[<span class="number">1</span>] = <span class="built_in">map</span>[target - nums[i]];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<!--more-->
<h2 id="3-考虑优化遍历一遍哈希"><a href="#3-考虑优化遍历一遍哈希" class="headerlink" title="3. 考虑优化遍历一遍哈希"></a>3. 考虑优化遍历一遍哈希</h2><p><strong>Python解法</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">    tmpDict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">        <span class="keyword">if</span> target - nums[i] <span class="keyword">in</span> tmpDict:</span><br><span class="line">            <span class="keyword">return</span> [i, tmpDict[target - nums[i]]]</span><br><span class="line">        tmpDict[nums[i]] = i</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p><strong>C++解法</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="built_in">map</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; nums.<span class="built_in">size</span>();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">map</span>.count(target - nums[i]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;i, <span class="built_in">map</span>[target - nums[i]]&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">map</span>[nums[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>LeetCode题解</category>
      </categories>
      <tags>
        <tag>简单</tag>
        <tag>数组</tag>
        <tag>哈希</tag>
        <tag>hashmap</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2019/12/18/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>多维混合Copula的风速建模</title>
    <url>/2017/04/13/2017-04-13-%E5%A4%9A%E7%BB%B4%E6%B7%B7%E5%90%88Copula%E7%9A%84%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/</url>
    <content><![CDATA[<h1 id="多维混合Copula参数估计"><a href="#多维混合Copula参数估计" class="headerlink" title="多维混合Copula参数估计"></a>多维混合Copula参数估计</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">tic</span><br><span class="line">U=QWC;</span><br><span class="line">V=BDQC;</span><br><span class="line">Z=GHKC;</span><br><span class="line">M=CMC;</span><br><span class="line"><span class="comment">%初始化</span></span><br><span class="line">S=<span class="number">5</span>;</span><br><span class="line">th=<span class="number">0.001</span></span><br><span class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</span><br><span class="line">a1=copulafit(<span class="string">'Gaussian'</span>,[U,V,Z,M]);</span><br><span class="line">[a2,nuhat]=copulafit(<span class="string">'t'</span>,[U,V,Z,M]);</span><br><span class="line">a3=copula4fit(<span class="string">'Gumbel'</span>,[U,V,Z,M]);</span><br><span class="line">a4=copula4fit(<span class="string">'Clayton'</span>,[U,V,Z,M]);</span><br><span class="line">a5=copula4fit(<span class="string">'Frank'</span>,[U,V,Z,M]);</span><br><span class="line">theta=&#123;a1,a2,a3,a4,a5&#125;;</span><br><span class="line">tturntheta_old=<span class="built_in">zeros</span>(<span class="number">35</span>,<span class="number">1</span>);</span><br><span class="line">N=<span class="built_in">numel</span>(U);</span><br><span class="line">count=<span class="number">0</span>;</span><br><span class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</span><br><span class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">4</span>);</span><br><span class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</span><br><span class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</span><br><span class="line">tt(:,<span class="number">3</span>)=tinv(Z(:),nuhat);</span><br><span class="line">tt(:,<span class="number">4</span>)=tinv(M(:),nuhat);</span><br><span class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</span><br><span class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</span><br><span class="line">nn(:,<span class="number">3</span>)=norminv(Z(:));</span><br><span class="line">nn(:,<span class="number">4</span>)=norminv(M(:));</span><br><span class="line">t=<span class="built_in">inf</span>;</span><br><span class="line">COPULA=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">list1=cell(<span class="number">6</span>,<span class="number">101</span>);</span><br><span class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</span><br><span class="line">puz=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">puz1=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line">lower=[-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,-<span class="built_in">inf</span>,<span class="number">1.001</span>,<span class="number">0.001</span>,-<span class="built_in">inf</span>];</span><br><span class="line">turntheta=<span class="built_in">zeros</span>(<span class="number">15</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span></span><br><span class="line">    theta_old=theta;</span><br><span class="line">    omega_old=omega;</span><br><span class="line"></span><br><span class="line"><span class="comment">%保证搜索过程中仍为正定矩阵</span></span><br><span class="line">    [A1,B1]=eig(theta_old&#123;<span class="number">1</span>&#125;);</span><br><span class="line">    [A2,B2]=eig(theta_old&#123;<span class="number">2</span>&#125;);</span><br><span class="line">    C1=A1*<span class="built_in">sqrt</span>(B1);</span><br><span class="line">    C2=A2*<span class="built_in">sqrt</span>(B2);</span><br><span class="line"></span><br><span class="line">    tturntheta_old(<span class="number">1</span>:<span class="number">16</span>)=<span class="built_in">reshape</span>(C1,[<span class="number">16</span>,<span class="number">1</span>]);</span><br><span class="line">    tturntheta_old(<span class="number">17</span>:<span class="number">32</span>)=<span class="built_in">reshape</span>(C2,[<span class="number">16</span>,<span class="number">1</span>]);</span><br><span class="line">    tturntheta_old(<span class="number">33</span>)=theta_old&#123;<span class="number">3</span>&#125;;</span><br><span class="line">    tturntheta_old(<span class="number">34</span>)=theta_old&#123;<span class="number">4</span>&#125;;</span><br><span class="line">    tturntheta_old(<span class="number">35</span>)=theta_old&#123;<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U,V,Z,M],theta_old&#123;<span class="number">1</span>&#125;);</span><br><span class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'t'</span>,[U,V,Z,M],theta_old&#123;<span class="number">2</span>&#125;,nuhat);</span><br><span class="line">    COPULA(:,<span class="number">3</span>)=copula4pdf(<span class="string">'Gumbel'</span>,[U,V,Z,M],theta_old&#123;<span class="number">3</span>&#125;);</span><br><span class="line">    COPULA(:,<span class="number">4</span>)=copula4pdf(<span class="string">'Clayton'</span>,[U,V,Z,M],theta_old&#123;<span class="number">4</span>&#125;);</span><br><span class="line">    COPULA(:,<span class="number">5</span>)=copula4pdf(<span class="string">'Frank'</span>,[U,V,Z,M],theta_old&#123;<span class="number">5</span>&#125;);</span><br><span class="line"></span><br><span class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</span><br><span class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</span><br><span class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</span><br><span class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</span><br><span class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</span><br><span class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</span><br><span class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</span><br><span class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</span><br><span class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</span><br><span class="line">    omega</span><br><span class="line">    [tturntheta,fval,exitflag,output]=update4theta(N,U,V,Z,M,tturntheta_old,puz1,tt,nn,lower,nuhat);</span><br><span class="line"></span><br><span class="line">    CC1=<span class="built_in">reshape</span>(tturntheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</span><br><span class="line">    CC2=<span class="built_in">reshape</span>(tturntheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</span><br><span class="line">    CC1=CC1*CC1';</span><br><span class="line">    CC2=CC2*CC2';</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC1)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</span><br><span class="line">        CC1=CC1+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">find</span>(eig(CC2)&lt;<span class="number">0.000000001</span>)&gt;<span class="number">0</span>)</span><br><span class="line">        CC2=CC2+<span class="built_in">eps</span>*<span class="built_in">eye</span>(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,CC1(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),CC1(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC1(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC1(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC1(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),CC1(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC1(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC1(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">1</span>,<span class="number">1</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">2</span>,<span class="number">2</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),CC1(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC1(<span class="number">3</span>,<span class="number">3</span>)*CC1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</span><br><span class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,CC2(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),CC2(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC2(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,CC2(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC2(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),CC2(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,CC2(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            CC2(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">1</span>,<span class="number">1</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">2</span>,<span class="number">2</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),CC2(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(CC2(<span class="number">3</span>,<span class="number">3</span>)*CC2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</span><br><span class="line">    theta&#123;<span class="number">3</span>&#125;=tturntheta(<span class="number">33</span>);</span><br><span class="line">    theta&#123;<span class="number">4</span>&#125;=tturntheta(<span class="number">34</span>);</span><br><span class="line">    theta&#123;<span class="number">5</span>&#125;=tturntheta(<span class="number">35</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    theta;</span><br><span class="line">    list1&#123;<span class="number">1</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">1</span>&#125;;</span><br><span class="line">    list1&#123;<span class="number">2</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">2</span>&#125;;</span><br><span class="line">    list1&#123;<span class="number">3</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">3</span>&#125;;</span><br><span class="line">    list1&#123;<span class="number">4</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">4</span>&#125;;</span><br><span class="line">    list1&#123;<span class="number">5</span>,count+<span class="number">1</span>&#125;=theta&#123;<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    theta&#123;<span class="number">1</span>&#125;</span><br><span class="line">    theta&#123;<span class="number">2</span>&#125;</span><br><span class="line">    theta&#123;<span class="number">3</span>&#125;</span><br><span class="line">    theta&#123;<span class="number">4</span>&#125;</span><br><span class="line">    theta&#123;<span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line">    list2(:,count+<span class="number">1</span>)=omega;</span><br><span class="line">    t=<span class="built_in">max</span>([norm(tturntheta(:)-tturntheta_old(:));norm(omega_old(:)-omega(:))])</span><br><span class="line">    count=count+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br></pre></td></tr></table></figure>
<p><strong>注：在多维模式下最应注意的是搜索过程中多维高斯Copula与t-Copula的相依结构参数应该保持正定</strong></p>
<blockquote>
<p>保持矩阵正定的方法<br>假设 $A$ 矩阵正定，则;<br>$A=Y<em>\lambda</em>Y^T$,其中 $\lambda$ 为对角线上为矩阵$A$的特征值的对角矩阵，$Y$为对应各特征值的特征向量矩阵。<br>因此对于$B=Y<em>\sqrt{\lambda}$，有$A=B</em>B^T$。<br>因此只需对$B$中的元素进行搜索就能保证最后合成的$A$一定为正定。</p>
</blockquote>
<a id="more"></a>
<h2 id="非线性优化部分"><a href="#非线性优化部分" class="headerlink" title="非线性优化部分"></a>非线性优化部分</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output]</span>=<span class="title">update4theta</span><span class="params">(N,U,V,Z,M,ttheta,puz,t,n,lower,nuhat)</span></span></span><br><span class="line">tic</span><br><span class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">10000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-8</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>,<span class="string">'UseParallel'</span>,<span class="number">1</span>);</span><br><span class="line">[turntheta,fval,exitflag,output]=fmincon(@u4theta,ttheta,[],[],[],[],lower,[],[],options);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">u4theta</span><span class="params">(ttheta)</span></span></span><br><span class="line">    theta=cell(<span class="number">5</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    X1=<span class="built_in">reshape</span>(ttheta(<span class="number">1</span>:<span class="number">16</span>),[<span class="number">4</span>,<span class="number">4</span>]);</span><br><span class="line">    X2=<span class="built_in">reshape</span>(ttheta(<span class="number">17</span>:<span class="number">32</span>),[<span class="number">4</span>,<span class="number">4</span>]);</span><br><span class="line">    X1=X1*X1';</span><br><span class="line">    X2=X2*X2';</span><br><span class="line"></span><br><span class="line">    theta&#123;<span class="number">1</span>&#125;=[<span class="number">1</span>,X1(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),X1(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X1(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X1(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X1(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),X1(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X1(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X1(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">1</span>,<span class="number">1</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">2</span>,<span class="number">2</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),X1(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X1(<span class="number">3</span>,<span class="number">3</span>)*X1(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</span><br><span class="line">    theta&#123;<span class="number">2</span>&#125;=[<span class="number">1</span>,X2(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),X2(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X2(<span class="number">1</span>,<span class="number">2</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">2</span>,<span class="number">2</span>)),<span class="number">1</span>,X2(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X2(<span class="number">1</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),X2(<span class="number">2</span>,<span class="number">3</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">3</span>,<span class="number">3</span>)),<span class="number">1</span>,X2(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>));</span><br><span class="line">            X2(<span class="number">1</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">1</span>,<span class="number">1</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">2</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">2</span>,<span class="number">2</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),X2(<span class="number">3</span>,<span class="number">4</span>)/<span class="built_in">sqrt</span>(X2(<span class="number">3</span>,<span class="number">3</span>)*X2(<span class="number">4</span>,<span class="number">4</span>)),<span class="number">1</span>];</span><br><span class="line">    theta&#123;<span class="number">3</span>&#125;=ttheta(<span class="number">33</span>);</span><br><span class="line">    theta&#123;<span class="number">4</span>&#125;=ttheta(<span class="number">34</span>);</span><br><span class="line">    theta&#123;<span class="number">5</span>&#125;=ttheta(<span class="number">35</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> theta&#123;<span class="number">5</span>&#125;==<span class="number">0</span></span><br><span class="line">    theta&#123;<span class="number">5</span>&#125;=theta&#123;<span class="number">5</span>&#125;+<span class="number">0.0001</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">th1=theta&#123;<span class="number">1</span>&#125;;</span><br><span class="line">th2=theta&#123;<span class="number">2</span>&#125;;</span><br><span class="line">th3=theta&#123;<span class="number">3</span>&#125;;</span><br><span class="line">th4=theta&#123;<span class="number">4</span>&#125;;</span><br><span class="line">th5=theta&#123;<span class="number">5</span>&#125;;</span><br><span class="line">y=<span class="number">0</span>;</span><br><span class="line">Y=<span class="built_in">zeros</span>(<span class="number">1</span>,N);</span><br><span class="line"><span class="keyword">parfor</span> <span class="built_in">j</span>=<span class="number">1</span>:N</span><br><span class="line">    Y(<span class="built_in">j</span>)=<span class="built_in">log</span>(det(th1)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">1</span>)-<span class="built_in">eye</span>(<span class="number">4</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</span><br><span class="line">         <span class="built_in">log</span>(det(th2)^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">gamma</span>((nuhat+<span class="number">4</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)^(<span class="number">3</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th2^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">4</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">4</span>*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">3</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">4</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</span><br><span class="line">         <span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">4</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*(<span class="number">2</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">2</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (<span class="number">2</span>*th3*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">2</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">2</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) - (th3^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*(<span class="number">1</span>/th3 - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">4</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)) + (<span class="number">2</span>*th3^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3))*(-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^(th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">1</span>)*(<span class="number">1</span>/th3 - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^th3 + (-<span class="built_in">log</span>(Z(<span class="built_in">j</span>)))^th3)^(<span class="number">1</span>/th3 - <span class="number">3</span>))/(M(<span class="built_in">j</span>)*U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*Z(<span class="built_in">j</span>)))*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</span><br><span class="line">         <span class="built_in">log</span>((th4^<span class="number">3</span>*(<span class="number">1</span>/th4 + <span class="number">1</span>)*(<span class="number">1</span>/th4 + <span class="number">2</span>)*(<span class="number">1</span>/th4 + <span class="number">3</span>))/(M(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*U(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*V(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*Z(<span class="built_in">j</span>)^(th4 + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/U(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/V(<span class="built_in">j</span>)^th4 + <span class="number">1</span>/Z(<span class="built_in">j</span>)^th4 - <span class="number">3</span>)^(<span class="number">1</span>/th4 + <span class="number">4</span>)))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</span><br><span class="line">         <span class="built_in">log</span>((<span class="number">7</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) + (<span class="number">6</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (th5^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)) - (<span class="number">12</span>*th5^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-th5) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">j</span>)*th5) - <span class="number">1</span>)))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">y=-sum(Y);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="参数估计结果"><a href="#参数估计结果" class="headerlink" title="参数估计结果"></a>参数估计结果</h1><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rho_n=[<span class="number">1.0000</span>   <span class="number">-0.4594</span>    <span class="number">0.6594</span>    <span class="number">0.3254</span></span><br><span class="line">     <span class="number">-0.4594</span>    <span class="number">1.0000</span>   <span class="number">-0.8218</span>    <span class="number">0.6426</span></span><br><span class="line">      <span class="number">0.6594</span>   <span class="number">-0.8218</span>    <span class="number">1.0000</span>   <span class="number">-0.4552</span></span><br><span class="line">      <span class="number">0.3254</span>    <span class="number">0.6426</span>   <span class="number">-0.4552</span>    <span class="number">1.0000</span>];</span><br><span class="line"></span><br><span class="line">rho_t=[<span class="number">1.0000</span>    <span class="number">0.6856</span>    <span class="number">0.6195</span>    <span class="number">0.6621</span></span><br><span class="line">      <span class="number">0.6856</span>    <span class="number">1.0000</span>    <span class="number">0.9344</span>    <span class="number">0.3696</span></span><br><span class="line">      <span class="number">0.6195</span>    <span class="number">0.9344</span>    <span class="number">1.0000</span>    <span class="number">0.3127</span></span><br><span class="line">      <span class="number">0.6621</span>    <span class="number">0.3696</span>    <span class="number">0.3127</span>    <span class="number">1.0000</span>];</span><br><span class="line"></span><br><span class="line">rho_g=<span class="number">1.9479</span>;</span><br><span class="line"></span><br><span class="line">rho_c=<span class="number">0.0010</span>;</span><br><span class="line"></span><br><span class="line">rho_f=<span class="number">2.0234</span>;</span><br><span class="line"></span><br><span class="line">omega=[<span class="number">0</span>    <span class="number">0.7098</span>    <span class="number">0.1432</span>    <span class="number">0.0364</span>    <span class="number">0.1106</span>]</span><br></pre></td></tr></table></figure>
<p>欧式距离</p>
<p>$d_m=6.6293$</p>
<p>可以看出从欧氏距离上讲，确实混合Copula模型比单个Copula建模的效果要好。<br>由于高斯Copula在多维下并不能表现出尾部相关性，因此其权重参数为0。其余的Copula基本是按照各自拟合优度占据权重。</p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
        <tag>EM算法</tag>
      </tags>
  </entry>
  <entry>
    <title>多维形式的Copula函数推导及建模</title>
    <url>/2017/04/06/2017-04-06-%E5%A4%9A%E7%BB%B4%E5%BD%A2%E5%BC%8F%E7%9A%84Copula%E5%87%BD%E6%95%B0%E6%8E%A8%E5%AF%BC%E5%8F%8A%E5%BB%BA%E6%A8%A1/</url>
    <content><![CDATA[<h1 id="两种Copula"><a href="#两种Copula" class="headerlink" title="两种Copula"></a>两种Copula</h1><p>Copula函数主要分为两种，一种为椭圆族Copula，一种为Archimedean-Copula。其中椭圆族Copula直接给出了其多维形式，具体详见<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="noopener">《MATLAB统计分析与应用：40个案例分析》</a>P189。而Archimedean-Copula的函数由于各种生成元的不同导致只给出了常用的二元形式。多维形式需要手动推导。</p>
<h1 id="对多维Archimedean-Copula推导"><a href="#对多维Archimedean-Copula推导" class="headerlink" title="对多维Archimedean-Copula推导"></a>对多维Archimedean-Copula推导</h1><h2 id="对于分布函数的推导"><a href="#对于分布函数的推导" class="headerlink" title="对于分布函数的推导"></a>对于分布函数的推导</h2><p>根据<a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="noopener">书中</a>P190给出的生成元与基础形式，推导出各自生成元的反函数，然后将生成元带入，得到四维Copula分布函数。<br><a id="more"></a><br><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">Gumbelcdf =</span><br><span class="line"><span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a))</span><br><span class="line"></span><br><span class="line">Claytoncdf =</span><br><span class="line">(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a)</span><br><span class="line"></span><br><span class="line">Frankcdf =</span><br><span class="line">-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a</span><br></pre></td></tr></table></figure></p>
<h2 id="对于密度函数的推导"><a href="#对于密度函数的推导" class="headerlink" title="对于密度函数的推导"></a>对于密度函数的推导</h2><p>根据定义，密度函数是对分布函数中的多个样本进行多次求偏导得到的。由于函数较为复杂，手动推导会带来很大的麻烦，因而采用MATLAB程序进行推导。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">clear all;</span><br><span class="line">syms U V Z M a d</span><br><span class="line">S1=<span class="string">'exp(-((-log(U))^a+(-log(V))^a+(-log(Z))^a+(-log(M))^a)^(1/a))'</span>;</span><br><span class="line">d=S1;</span><br><span class="line">v=[U V Z M];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    d=diff(d,v(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Gum=d</span><br><span class="line">S2=<span class="string">'(U^(-a)+V^(-a)+Z^(-a)+M^(-a)-3)^(-1/a)'</span></span><br><span class="line">d=S2;</span><br><span class="line">v=[U V Z M];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    d=diff(d,v(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Clay=d</span><br><span class="line">S3=<span class="string">'-log(exp(log((exp(-M*a) - 1)/(exp(-a) - 1)) + log((exp(-U*a) - 1)/(exp(-a) - 1)) + log((exp(-V*a) - 1)/(exp(-a) - 1)) + log((exp(-Z*a) - 1)/(exp(-a) - 1)))*(exp(-a) - 1) + 1)/a'</span>;</span><br><span class="line">d=S3;</span><br><span class="line">v=[U V Z M];</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    d=diff(d,v(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Frank=d</span><br></pre></td></tr></table></figure>
<p>求得结果</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">Gum =</span><br><span class="line">(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z)</span><br><span class="line"></span><br><span class="line">Clay =</span><br><span class="line">(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">Frank =</span><br><span class="line">(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p><em>注：以上是经过修正后能直接进行矩阵计算的结果，修正方法为将原结果中的`</em>,^,/<code>转换为</code>.<em>,.^,./`</em></p>
<h1 id="多维Copula参数估计"><a href="#多维Copula参数估计" class="headerlink" title="多维Copula参数估计"></a>多维Copula参数估计</h1><p>MATLAB自带的函数不支持多维的Archimdean-Copula的参数估计与函数计算，因此需要自己写出极大似然估计算法。由于MATLAB自带的极大似然估计函数<code>mle</code>不支持多维变量的输入，因此先计算出对数似然函数，然后利用非线性优化函数<code>fmincon</code>求解对应的参数值</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">para</span>=<span class="title">copula4fit</span><span class="params">(name,data)</span></span></span><br><span class="line">options = optimset(<span class="string">'Algorithm'</span>,<span class="string">'interior-point'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolCon'</span>,<span class="number">10</span>^<span class="number">-12</span>,<span class="string">'TolFun'</span>,<span class="number">10</span>^<span class="number">-4</span>,<span class="string">'TolX'</span>,<span class="number">10</span>^<span class="number">-6</span>);</span><br><span class="line"><span class="keyword">switch</span> name</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></span><br><span class="line"></span><br><span class="line">        lower = <span class="number">1.1</span>;</span><br><span class="line">        a = <span class="number">2</span>;</span><br><span class="line">        [ para LL6] = fmincon(@mlepdffun_G,a,[],[],[],[],lower,[],[],options);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></span><br><span class="line">        lower = <span class="number">0.0001</span>;</span><br><span class="line">        a = <span class="number">1</span>;</span><br><span class="line">        [ para LL2] = fmincon(@mlepdffun_C,a,[],[],[],[],lower,[],[],options);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></span><br><span class="line">        theta0 = <span class="number">1</span>;</span><br><span class="line">        [ para LL5] = fmincon(@mlepdffun_F,theta0,[],[],[],[],[],[],[],options);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_G</span><span class="params">(a)</span></span></span><br><span class="line">    U=data(:,<span class="number">1</span>);</span><br><span class="line">    V=data(:,<span class="number">2</span>);</span><br><span class="line">    Z=data(:,<span class="number">3</span>);</span><br><span class="line">    M=data(:,<span class="number">4</span>);</span><br><span class="line">    N=<span class="built_in">numel</span>(U);</span><br><span class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">4</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)^<span class="number">2</span>*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*(<span class="number">2</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">2</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (<span class="number">2</span>*a*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">2</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">2</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*(<span class="number">1</span>/a - <span class="number">3</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">4</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)) + (<span class="number">2</span>*a^<span class="number">2</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a))*(-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^(a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">1</span>)*(<span class="number">1</span>/a - <span class="number">2</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">1</span>)*((-<span class="built_in">log</span>(M(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(U(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(V(<span class="built_in">i</span>)))^a + (-<span class="built_in">log</span>(Z(<span class="built_in">i</span>)))^a)^(<span class="number">1</span>/a - <span class="number">3</span>))/(M(<span class="built_in">i</span>)*U(<span class="built_in">i</span>)*V(<span class="built_in">i</span>)*Z(<span class="built_in">i</span>)));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    y=-sum(Y);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_C</span><span class="params">(a)</span></span></span><br><span class="line">    U=data(:,<span class="number">1</span>);</span><br><span class="line">    V=data(:,<span class="number">2</span>);</span><br><span class="line">    Z=data(:,<span class="number">3</span>);</span><br><span class="line">    M=data(:,<span class="number">4</span>);</span><br><span class="line">    N=<span class="built_in">numel</span>(U);</span><br><span class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</span><br><span class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((a^<span class="number">3</span>*(<span class="number">1</span>/a + <span class="number">1</span>)*(<span class="number">1</span>/a + <span class="number">2</span>)*(<span class="number">1</span>/a + <span class="number">3</span>))/(M(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*U(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*V(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*Z(<span class="built_in">i</span>)^(a + <span class="number">1</span>)*(<span class="number">1</span>/M(<span class="built_in">i</span>)^a + <span class="number">1</span>/U(<span class="built_in">i</span>)^a + <span class="number">1</span>/V(<span class="built_in">i</span>)^a + <span class="number">1</span>/Z(<span class="built_in">i</span>)^a - <span class="number">3</span>)^(<span class="number">1</span>/a + <span class="number">4</span>)));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    y=-sum(Y);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">mlepdffun_F</span><span class="params">(a)</span></span></span><br><span class="line">    U=data(:,<span class="number">1</span>);</span><br><span class="line">    V=data(:,<span class="number">2</span>);</span><br><span class="line">    Z=data(:,<span class="number">3</span>);</span><br><span class="line">    M=data(:,<span class="number">4</span>);</span><br><span class="line">    N=<span class="built_in">numel</span>(U);</span><br><span class="line">    Y=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U));</span><br><span class="line">    <span class="keyword">parfor</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        Y(<span class="built_in">i</span>)=<span class="built_in">log</span>((<span class="number">7</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">2</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">2</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) + (<span class="number">6</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">4</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">4</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (a^<span class="number">3</span>*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)) - (<span class="number">12</span>*a^<span class="number">3</span>*<span class="built_in">exp</span>(<span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a)*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)^<span class="number">3</span>)/((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)/(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)))*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)^<span class="number">3</span>*(<span class="built_in">exp</span>(-M(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-U(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-V(<span class="built_in">i</span>)*a) - <span class="number">1</span>)*(<span class="built_in">exp</span>(-Z(<span class="built_in">i</span>)*a) - <span class="number">1</span>)));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    y=-sum(Y);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="多维Copula函数值计算"><a href="#多维Copula函数值计算" class="headerlink" title="多维Copula函数值计算"></a>多维Copula函数值计算</h1><h2 id="多维分布函数"><a href="#多维分布函数" class="headerlink" title="多维分布函数"></a>多维分布函数</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>=<span class="title">copula4cdf</span><span class="params">(name,data,a)</span></span></span><br><span class="line">U=data(:,<span class="number">1</span>);</span><br><span class="line">V=data(:,<span class="number">2</span>);</span><br><span class="line">Z=data(:,<span class="number">3</span>);</span><br><span class="line">M=data(:,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">switch</span> name</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></span><br><span class="line">        c=<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U)).^a+(-<span class="built_in">log</span>(V)).^a+(-<span class="built_in">log</span>(Z)).^a+(-<span class="built_in">log</span>(M)).^a).^(<span class="number">1.</span>/a));</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></span><br><span class="line">        c=(U.^(-a)+V.^(-a)+Z.^(-a)+M.^(-a)<span class="number">-3</span>).^(<span class="number">-1.</span>/a);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></span><br><span class="line">        c=-<span class="built_in">log</span>(<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>)./a;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="多维密度函数"><a href="#多维密度函数" class="headerlink" title="多维密度函数"></a>多维密度函数</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">p</span>=<span class="title">copula4pdf</span><span class="params">(name,data,a)</span></span></span><br><span class="line">U=data(:,<span class="number">1</span>);</span><br><span class="line">V=data(:,<span class="number">2</span>);</span><br><span class="line">Z=data(:,<span class="number">3</span>);</span><br><span class="line">M=data(:,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">switch</span> name</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Gumbel'</span></span><br><span class="line">        p=(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">4.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).^<span class="number">2.</span>*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*(<span class="number">2.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">2</span>))./(M.*U.*V.*Z) - (<span class="number">2.</span>*a.*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">2.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">2.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*(<span class="number">1.</span>/a - <span class="number">3</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">4</span>))./(M.*U.*V.*Z) + (<span class="number">2.</span>*a.^<span class="number">2.</span>*<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a)).*(-<span class="built_in">log</span>(M)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(U)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(V)).^(a - <span class="number">1</span>).*(-<span class="built_in">log</span>(Z)).^(a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">1</span>).*(<span class="number">1.</span>/a - <span class="number">2</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">1</span>).*((-<span class="built_in">log</span>(M)).^a + (-<span class="built_in">log</span>(U)).^a + (-<span class="built_in">log</span>(V)).^a + (-<span class="built_in">log</span>(Z)).^a).^(<span class="number">1.</span>/a - <span class="number">3</span>))./(M.*U.*V.*Z);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Clayton'</span></span><br><span class="line">        p=(a.^<span class="number">3.</span>*(<span class="number">1.</span>/a + <span class="number">1</span>).*(<span class="number">1.</span>/a + <span class="number">2</span>).*(<span class="number">1.</span>/a + <span class="number">3</span>))./(M.^(a + <span class="number">1</span>).*U.^(a + <span class="number">1</span>).*V.^(a + <span class="number">1</span>).*Z.^(a + <span class="number">1</span>).*(<span class="number">1.</span>/M.^a + <span class="number">1.</span>/U.^a + <span class="number">1.</span>/V.^a + <span class="number">1.</span>/Z.^a - <span class="number">3</span>).^(<span class="number">1.</span>/a + <span class="number">4</span>));</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'Frank'</span></span><br><span class="line">        p=(<span class="number">7.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">2</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">2.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) + (<span class="number">6.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">4.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">4</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">4.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (a.^<span class="number">3.</span>*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)) - (<span class="number">12.</span>*a.^<span class="number">3.</span>*<span class="built_in">exp</span>(<span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="number">2.</span>*<span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*<span class="built_in">exp</span>(-M.*a).*<span class="built_in">exp</span>(-U.*a).*<span class="built_in">exp</span>(-V.*a).*<span class="built_in">exp</span>(-Z.*a).*<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>).^<span class="number">3</span>)./((<span class="built_in">exp</span>(<span class="built_in">log</span>((<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>)) + <span class="built_in">log</span>((<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>)./(<span class="built_in">exp</span>(-a) - <span class="number">1</span>))).*(<span class="built_in">exp</span>(-a) - <span class="number">1</span>) + <span class="number">1</span>).^<span class="number">3.</span>*(<span class="built_in">exp</span>(-M.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-U.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-V.*a) - <span class="number">1</span>).*(<span class="built_in">exp</span>(-Z.*a) - <span class="number">1</span>));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="多维单一Copula建模"><a href="#多维单一Copula建模" class="headerlink" title="多维单一Copula建模"></a>多维单一Copula建模</h1><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rho_n=copulafit(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC]);</span><br><span class="line">[rho_t,df]=copulafit(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC]);</span><br><span class="line">rho_g=copula4fit(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC]);</span><br><span class="line">rho_c=copula4fit(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC]);</span><br><span class="line">rho_f=copula4fit(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC]);</span><br><span class="line">[fx,xsort]=ecdf(qw);</span><br><span class="line">[fy,ysort]=ecdf(bdq);</span><br><span class="line">[fz,zsort]=ecdf(ghk);</span><br><span class="line">[fn,nsort]=ecdf(cm);</span><br><span class="line">U1=spline(xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),qw);</span><br><span class="line">U2=spline(ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),bdq);</span><br><span class="line">U3=spline(zsort(<span class="number">2</span>:<span class="keyword">end</span>),fz(<span class="number">2</span>:<span class="keyword">end</span>),ghk);</span><br><span class="line">U4=spline(nsort(<span class="number">2</span>:<span class="keyword">end</span>),fn(<span class="number">2</span>:<span class="keyword">end</span>),cm);</span><br><span class="line">C=@(u1,u2,u3,u4)<span class="built_in">mean</span>((U1&lt;=u1).*(U2&lt;=u2).*(U3&lt;=u3).*(U4&lt;=u4));</span><br><span class="line">CU=<span class="built_in">zeros</span>(<span class="built_in">size</span>(U1(:)));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(U1)</span><br><span class="line">    CU(<span class="built_in">i</span>)=C(U1(<span class="built_in">i</span>),U2(<span class="built_in">i</span>),U3(<span class="built_in">i</span>),U4(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">C_n=copulacdf(<span class="string">'Gaussian'</span>,[QWC,BDQC,GHKC,CMC],rho_n);</span><br><span class="line">C_t=copulacdf(<span class="string">'t'</span>,[QWC,BDQC,GHKC,CMC],rho_t,df);</span><br><span class="line">C_g=copula4cdf(<span class="string">'Gumbel'</span>,[QWC,BDQC,GHKC,CMC],rho_g);</span><br><span class="line">C_c=copula4cdf(<span class="string">'Clayton'</span>,[QWC,BDQC,GHKC,CMC],rho_c);</span><br><span class="line">C_f=copula4cdf(<span class="string">'Frank'</span>,[QWC,BDQC,GHKC,CMC],rho_f);</span><br><span class="line"></span><br><span class="line">d_n=(CU-C_n)'*(CU-C_n);</span><br><span class="line">d_t=(CU-C_t)'*(CU-C_t);</span><br><span class="line">d_g=(CU-C_g)'*(CU-C_g);</span><br><span class="line">d_c=(CU-C_c)'*(CU-C_c);</span><br><span class="line">d_f=(CU-C_f)'*(CU-C_f);</span><br></pre></td></tr></table></figure>
<h2 id="结果及评价"><a href="#结果及评价" class="headerlink" title="结果及评价"></a>结果及评价</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rho_n =</span><br><span class="line"></span><br><span class="line">    <span class="number">1.0000</span>    <span class="number">0.6339</span>    <span class="number">0.5346</span>    <span class="number">0.6108</span></span><br><span class="line">    <span class="number">0.6339</span>    <span class="number">1.0000</span>    <span class="number">0.8092</span>    <span class="number">0.3639</span></span><br><span class="line">    <span class="number">0.5346</span>    <span class="number">0.8092</span>    <span class="number">1.0000</span>    <span class="number">0.3028</span></span><br><span class="line">    <span class="number">0.6108</span>    <span class="number">0.3639</span>    <span class="number">0.3028</span>    <span class="number">1.0000</span></span><br><span class="line"></span><br><span class="line">rho_t =</span><br><span class="line"></span><br><span class="line">    <span class="number">1.0000</span>    <span class="number">0.6441</span>    <span class="number">0.5591</span>    <span class="number">0.6179</span></span><br><span class="line">    <span class="number">0.6441</span>    <span class="number">1.0000</span>    <span class="number">0.8427</span>    <span class="number">0.3769</span></span><br><span class="line">    <span class="number">0.5591</span>    <span class="number">0.8427</span>    <span class="number">1.0000</span>    <span class="number">0.3204</span></span><br><span class="line">    <span class="number">0.6179</span>    <span class="number">0.3769</span>    <span class="number">0.3204</span>    <span class="number">1.0000</span></span><br><span class="line"></span><br><span class="line">rho_g =</span><br><span class="line"></span><br><span class="line">    <span class="number">1.5298</span></span><br><span class="line"></span><br><span class="line">rho_c =</span><br><span class="line"></span><br><span class="line">    <span class="number">0.4995</span></span><br><span class="line"></span><br><span class="line">rho_f =</span><br><span class="line"></span><br><span class="line">    <span class="number">3.5044</span></span><br></pre></td></tr></table></figure>
<h2 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h2><p>欧式距离</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">d_n =</span><br><span class="line"></span><br><span class="line">   <span class="number">11.0717</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d_t =</span><br><span class="line"></span><br><span class="line">    <span class="number">7.0748</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d_g =</span><br><span class="line"></span><br><span class="line">   <span class="number">48.8770</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d_c =</span><br><span class="line"></span><br><span class="line">  <span class="number">258.5072</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d_f =</span><br><span class="line"></span><br><span class="line">   <span class="number">48.3227</span></span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>欧氏距离</th>
<th>$d_n$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>计算值</td>
<td>11.0717</td>
<td>7.0748</td>
<td>48.8770</td>
<td>258.5072</td>
<td>48.3227</td>
</tr>
</tbody>
</table>
</div>
<p>我认为在对于多维变量的处理上，由于Archimedean-Copula函数仅仅通过一个变量来描述其多位相关性并不是很合理，因而通过一个结构相依矩阵来表述相关性的t-Copula与Normal-Copula就与源数据拟合方面表现的就更好</p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
        <tag>多维Copula</tag>
      </tags>
  </entry>
  <entry>
    <title>阶段性总结</title>
    <url>/2017/03/29/2017-03-29-%E9%98%B6%E6%AE%B5%E6%80%A7%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="风速的随机性数学表述"><a href="#风速的随机性数学表述" class="headerlink" title="风速的随机性数学表述"></a>风速的随机性数学表述</h1><p>通过查阅文献可以得知，可以使用双参数威布尔分布来描述风速的概率分布</p>
<p>双参数威布尔函数</p>
<script type="math/tex; mode=display">F_w(x)=1-exp(-({x \over c})^k)</script><p>其概率密度函数为</p>
<script type="math/tex; mode=display">P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)</script><p>式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。</p>
<h2 id="程序验证随机性"><a href="#程序验证随机性" class="headerlink" title="程序验证随机性"></a>程序验证随机性</h2><p>通过将风速数据的频数分布图与根据风速数据拟合的威布尔分布概率密度函数曲线进行对比可以发现，使用双参数威布尔分布去拟合风速数据是完全合理的。下图中红色的曲线为威布尔分布概率密度函数曲线，蓝色部分为风速的频率分布直方图。</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg" alt="图1 风速频数分布直方图"></p>
<h2 id="场间风速的关系"><a href="#场间风速的关系" class="headerlink" title="场间风速的关系"></a>场间风速的关系</h2><p>通过对拟合后的风速数据的分布函数绘制频数分布直方图可以简单的看出场间风速的一些关系。下图为桥湾（1）、北大桥（2）、干河口（3）以及昌马（4）四个风电场两两之间的风速频数分布直方图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/6in1.jpg" alt="图2 场间风速频数直方图"></p>
<p>对于以上的关系可以通过地理以及气象等知识进行解释。下图是四个风电场的地理位置关系。<br><img src="http://oag5ozkgs.bkt.clouddn.com/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE.jpg" alt="Alt text"></p>
<ul>
<li>桥湾（1）与北大桥（2）间地理位置是东西平行，在东西风向盛行的酒泉地区两者风况有较大的相似，所以线性相关性较大，如图2-1</li>
<li>干河口（3）与桥湾（1）的地理位置虽然接近东西平行，但是距离较远，因此线性相关性较低，如图2-2</li>
<li>桥湾（1）与昌马（4）间地理位置接近南北垂直，但是由于两者间距离较近，所以线性相关性也较为明显，如图2-3</li>
<li>干河口（3）与北大桥（2）的地理位置接近东西平行的，在东西风向盛行的酒泉地区两者风况有较大的相似。如图2-4可以看出存在较大的线性相关性。</li>
<li>昌马（4）与北大桥（2）的距离较远，因此线性相关性较差，如图2-5</li>
<li>干河口（3）与昌马（4）的距离最远，因此线性相关性也最差，如图2-6<a id="more"></a>
<h1 id="对场间风速进行建模"><a href="#对场间风速进行建模" class="headerlink" title="对场间风速进行建模"></a>对场间风速进行建模</h1></li>
</ul>
<h2 id="通过单个copula函数对场间风速进行建模"><a href="#通过单个copula函数对场间风速进行建模" class="headerlink" title="通过单个copula函数对场间风速进行建模"></a>通过单个copula函数对场间风速进行建模</h2><p><strong>参数估计结果</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$\rho_{Norm}$</th>
<th>$\rho_t$</th>
<th>$k$</th>
<th>$\theta_G$</th>
<th>$\theta_C$</th>
<th>$\theta_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾与北大桥</td>
<td>0.6339</td>
<td>0.6386</td>
<td>9.1619</td>
<td>1.8533</td>
<td>0.6913</td>
<td>5.0402</td>
</tr>
<tr>
<td>桥湾与干河口</td>
<td>0.5346</td>
<td>0.5364</td>
<td>9.7829</td>
<td>1.6350</td>
<td>0.4847</td>
<td>3.8853</td>
</tr>
<tr>
<td>桥湾与昌马</td>
<td>0.6108</td>
<td>0.6169</td>
<td>10.4474</td>
<td>1.7697</td>
<td>0.6530</td>
<td>4.8459</td>
</tr>
<tr>
<td>北大桥与干河口</td>
<td>0.8092</td>
<td>0.8479</td>
<td>2.7192</td>
<td>2.9270</td>
<td>1.4685</td>
<td>9.8959</td>
</tr>
<tr>
<td>北大桥与昌马</td>
<td>0.3639</td>
<td>0.3630</td>
<td>33.9054</td>
<td>1.3098</td>
<td>0.3072</td>
<td>2.3697</td>
</tr>
<tr>
<td>干河口与昌马</td>
<td>0.3028</td>
<td>0.3026</td>
<td>21.9903</td>
<td>1.2628</td>
<td>0.2141</td>
<td>1.9736</td>
</tr>
</tbody>
</table>
</div>
<p><strong>对建模结果进行评价</strong></p>
<p>与根据风速数据建立的经验Copula函数进行对比</p>
<p>使用Q-Q图进行校验（非定量分析）</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="noopener">Q-Q图的判定原则</a>可知，各类Copula函数差别很明显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法</p>
<p>使用K-S校验进行定量分析</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
</div>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="noopener">K-S检验法的判定原则</a>可知，在六种不同的风电场组合中，Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数的 $KS$ 统计值相对较小，而Normal-Copula，Clayton-Copula的统计值相对较大</p>
<p>秩相关性测度</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
</div>
<p>通过与经验函数的Kendall秩相关系数，Spearman秩相关系数进行对比可以发现Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与原始数据保持着良好的秩相关性，而Normal-Copula，Clayton-Copula的秩相关性较差。</p>
<p>使用欧式距离进行分析</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
</div>
<p>可以看到在以上6种风电场组合中Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与经验Copula函数的欧氏距离较小，而Normal-Copula，Clayton-Copula与经验函数的欧氏距离较大</p>
<h2 id="使用多个Copula函数进行混合对风速进行建模"><a href="#使用多个Copula函数进行混合对风速进行建模" class="headerlink" title="使用多个Copula函数进行混合对风速进行建模"></a>使用多个Copula函数进行混合对风速进行建模</h2><p>通过查阅文献可以知道，多个Copula函数通过加权相加后仍然是Copula函数</p>
<p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将论文中的三个Copula混合模型拓展至五个常用Copula进行混合建模。</p>
<p>由于混合时运算量过大，因此选取干河口与北大桥的场间风速为例进行建模</p>
<p><strong>三个Copula混合的参数结果</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>即</p>
<script type="math/tex; mode=display">
C(u,v;a)=0.7495C_{Gumbel}(u,v;4.1127)+0.1683C_{Frank}(u,v;6.5931)
+0.0822C_t(u,v;0.1244,3)</script><p><strong>五个Copula混合的参数结果</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>即</p>
<script type="math/tex; mode=display">
\begin{aligned}
C(u,v;a)= & 0.1075C_t(u,v;0.9678,2.7192)+0.0613C_N(u,v;0.9250)
+\\
& 0.5502C_{Gumbel}(u,v;3.7781)+0.1946C_{Frank}(u,v;9.8959)+0.0864C_{Clayton}(u,v;0.0049)
\end{aligned}</script><p><strong>模型评价</strong></p>
<p>Q-Q图校验</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析，但是可以对比单个Copula时的QQ图<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"></p>
<p>可以明显看出混合Copula的效果比单个Copula效果要好。</p>
<p>K-S检验</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
</div>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<p>欧氏距离</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
</div>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h2 id="使用多元Copula进行4维风电场间风速建模"><a href="#使用多元Copula进行4维风电场间风速建模" class="headerlink" title="使用多元Copula进行4维风电场间风速建模"></a>使用多元Copula进行4维风电场间风速建模</h2><p><strong>使用单一多维Copula建模</strong></p>
<p>分别得到了Normal-Copula与t-Copula的多元风速相依结构矩阵</p>
<script type="math/tex; mode=display">\rho_n=\begin{bmatrix}
1 & 0.6339 & 0.5346 & 0.6108\\
0.6339 & 1 & 0.8092 & 0.3639\\
0.5346 & 0.8092 & 1 & 0.3028\\
0.6108 & 0.3639 & 0.3028 & 1
\end{bmatrix}</script><script type="math/tex; mode=display">\rho_t=\begin{bmatrix}
1 &0.6441  &0.5591  &0.6179 \\
0.6441 &1  &0.8527  &0.3769 \\
0.5591 &0.8527  &1  &0.3204 \\
0.6179 &0.3769  &0.3204  &1
\end{bmatrix}</script><script type="math/tex; mode=display">k_t=7.8639</script><p><strong>模型评价</strong></p>
<p>K-S校验</p>
<script type="math/tex; mode=display">k_G=0.0281\\k_t=0.0401</script><p>欧氏距离</p>
<script type="math/tex; mode=display">d_G=11.0717\\d_t=7.0748</script><p>后来通过查阅文献得知KS校验不能在多维问题中使用，多维问题主要使用欧氏距离进行分析</p>
<p><strong>使用多维混合Copula两种思路</strong></p>
<ul>
<li><p>使用多维的Copula直接进行混合<br>问题： Archimedean Copula族的Copula函数需要手动计算多维形式，并手动编程通过MLE方法估算函数参数，MATLAB自带的fit函数仅支持二元的Archimedean Copula参数估计。并且在计算4维t-Copula概率密度函数时的计算量非常大，单句指令需要运算三个小时，当嵌套至EM算法的迭代中时将耗费更多的时间，预计计算时间将达到十几天。</p>
</li>
<li><p>通过pair-Copula将多个二维Copula函数进行合并，直至出现四维Copula<br>问题：暂时没有找到对于pair-Copula构建过程较为详细的文献，还处在摸索阶段</p>
</li>
</ul>
<h1 id="光伏的随机性表达"><a href="#光伏的随机性表达" class="headerlink" title="光伏的随机性表达"></a>光伏的随机性表达</h1><h2 id="通过核密度估计来表达长时间内的光伏照射强度"><a href="#通过核密度估计来表达长时间内的光伏照射强度" class="headerlink" title="通过核密度估计来表达长时间内的光伏照射强度"></a>通过核密度估计来表达长时间内的光伏照射强度</h2><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为：</p>
<script type="math/tex; mode=display">f_h(x)={1 \over nh}{\displaystyle \sum_{j=1}^n{K({x-x_j \over h})}}={1 \over n}{\displaystyle \sum_{j=1}^n{K_h(x-x_j)}}</script><p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="noopener">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p>所有代码详见<a href="https://github.com/fatelancer/Copula_Wind" target="_blank" rel="noopener">Copula_Wind</a></p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>风速建模</tag>
      </tags>
  </entry>
  <entry>
    <title>混合Copula建模修正——更多Copula函数的加入</title>
    <url>/2017/03/23/2017-03-23-%E6%B7%B7%E5%90%88Copula%E5%BB%BA%E6%A8%A1%E4%BF%AE%E6%AD%A3/</url>
    <content><![CDATA[<h1 id="修正的原因"><a href="#修正的原因" class="headerlink" title="修正的原因"></a>修正的原因</h1><p>由于Copula函数并非线性函数，简单的通过单个Copula函数拟合效果来选择使用哪几个Copula函数来进行混合可能不够准确，可能会存在两个单一表现并不好的Copula函数混合后结果却比较好的情况。</p>
<p>因此，将原来的混合Copula模型拓展至五个常用Copula进行混合建模。</p>
<h1 id="修正后的代码"><a href="#修正后的代码" class="headerlink" title="修正后的代码"></a>修正后的代码</h1><h2 id="EM算法主体部分"><a href="#EM算法主体部分" class="headerlink" title="EM算法主体部分"></a>EM算法主体部分</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">U=GHKC;</span><br><span class="line">V=BDQC;</span><br><span class="line"><span class="comment">% 初始化</span></span><br><span class="line">S=<span class="number">5</span>;</span><br><span class="line">th=<span class="number">0.01</span>;</span><br><span class="line">omega=[<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>,<span class="number">1</span>/<span class="number">5</span>];</span><br><span class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</span><br><span class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</span><br><span class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</span><br><span class="line">a4=copulafit(<span class="string">'Gaussian'</span>,[U,V]);</span><br><span class="line">a5=copulafit(<span class="string">'Clayton'</span>,[U,V]);</span><br><span class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3,a4(<span class="number">1</span>,<span class="number">2</span>),a5];</span><br><span class="line">[N,~]=<span class="built_in">size</span>(U);</span><br><span class="line">count=<span class="number">0</span>;</span><br><span class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</span><br><span class="line">nn=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</span><br><span class="line">tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</span><br><span class="line">tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</span><br><span class="line">nn(:,<span class="number">1</span>)=norminv(U(:));</span><br><span class="line">nn(:,<span class="number">2</span>)=norminv(V(:));</span><br><span class="line">t=<span class="built_in">inf</span>;</span><br><span class="line">COPULA=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">list1=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</span><br><span class="line">list2=<span class="built_in">zeros</span>(<span class="number">5</span>,<span class="number">101</span>);</span><br><span class="line">puz=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">puz1=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">turntheta_old=<span class="built_in">zeros</span>(<span class="number">1</span>,S);</span><br><span class="line">tic</span><br><span class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">50</span>;</span><br><span class="line">    theta_old=theta;</span><br><span class="line">    omega_old=omega;</span><br><span class="line">    <span class="comment">%转化为无约束限制的参数</span></span><br><span class="line">    turntheta_old(<span class="number">1</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line">    turntheta_old(<span class="number">2</span>)=<span class="built_in">log</span>(theta_old(<span class="number">2</span>)<span class="number">-1</span>);</span><br><span class="line">    turntheta_old(<span class="number">4</span>)=<span class="built_in">tan</span>(<span class="built_in">pi</span>*theta_old(<span class="number">4</span>)/<span class="number">2</span>);</span><br><span class="line">    turntheta_old(<span class="number">5</span>)=<span class="built_in">log</span>(theta_old(<span class="number">5</span>));</span><br><span class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</span><br><span class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</span><br><span class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</span><br><span class="line">    COPULA(:,<span class="number">4</span>)=copulapdf(<span class="string">'Gaussian'</span>,[U(:) V(:)],theta_old(<span class="number">4</span>));</span><br><span class="line">    COPULA(:,<span class="number">5</span>)=copulapdf(<span class="string">'Clayton'</span>,[U(:) V(:)],theta_old(<span class="number">5</span>));</span><br><span class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</span><br><span class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</span><br><span class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</span><br><span class="line">    puz(:,<span class="number">4</span>)=COPULA(:,<span class="number">4</span>)*omega_old(<span class="number">4</span>);</span><br><span class="line">    puz(:,<span class="number">5</span>)=COPULA(:,<span class="number">5</span>)*omega_old(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">4</span>)=puz(<span class="built_in">i</span>,<span class="number">4</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">5</span>)=puz(<span class="built_in">i</span>,<span class="number">5</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</span><br><span class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</span><br><span class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</span><br><span class="line">    omega(<span class="number">4</span>)=sum(puz1(:,<span class="number">4</span>))/N;</span><br><span class="line">    omega(<span class="number">5</span>)=sum(puz1(:,<span class="number">5</span>))/N;</span><br><span class="line">    omega</span><br><span class="line">    tic</span><br><span class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,turntheta_old,puz1,tt,nn,nuhat);</span><br><span class="line">    toc</span><br><span class="line">    theta(<span class="number">1</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line">    theta(<span class="number">2</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">2</span>))+<span class="number">1</span>;</span><br><span class="line">    theta(<span class="number">4</span>)=<span class="built_in">atan</span>(turntheta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line">    theta(<span class="number">5</span>)=<span class="built_in">exp</span>(turntheta(<span class="number">5</span>));</span><br><span class="line">    theta</span><br><span class="line">    list1(:,count+<span class="number">1</span>)=theta;</span><br><span class="line">    list2(:,count+<span class="number">1</span>)=omega;</span><br><span class="line">    t=<span class="built_in">max</span>([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</span><br><span class="line">    count=count+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">toc</span><br><span class="line">beep</span><br></pre></td></tr></table></figure>
<p>代码中涉及对参数进行数学变换将其参数从各自有限定义域转为$(-\infty,+ \infty)$</p>
<p>其中:</p>
<ul>
<li>t-Copula与正态Copula参数定义域为$(-1,1)$</li>
<li>Gumbel-Copula参数定义域为$(1,+\infty)$</li>
<li>Clayton-Copula参数定义域为$(0,+\infty)$</li>
<li>Frank-Copula参数定义域为$(-\infty,+\infty)$</li>
</ul>
<a id="more"></a>
<h2 id="参数更新部分"><a href="#参数更新部分" class="headerlink" title="参数更新部分"></a>参数更新部分</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,n,nuhat)</span></span></span><br><span class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'MaxFunEvals'</span>,<span class="number">1000</span>,<span class="string">'TolFun'</span>,<span class="number">1e-6</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'on'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</span><br><span class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></span><br><span class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></span><br><span class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">y=<span class="number">0</span>;</span><br><span class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</span><br><span class="line">th1=<span class="built_in">eye</span>(<span class="number">2</span>);</span><br><span class="line">th(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line">th(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">1</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line">th1(<span class="number">1</span>,<span class="number">2</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line">th1(<span class="number">2</span>,<span class="number">1</span>)=<span class="built_in">atan</span>(theta(<span class="number">4</span>))*<span class="number">2</span>/<span class="built_in">pi</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</span><br><span class="line"></span><br><span class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</span><br><span class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^((<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>)))^(<span class="number">2</span><span class="number">-1</span>/(<span class="built_in">exp</span>(theta(<span class="number">2</span>))+<span class="number">1</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</span><br><span class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>)+...</span><br><span class="line">        <span class="built_in">log</span>((det(th1))^(<span class="number">-1</span>/<span class="number">2</span>)*<span class="built_in">exp</span>(<span class="number">-1</span>/<span class="number">2</span>*n(<span class="built_in">j</span>,:)*(th1^(<span class="number">-1</span>)-<span class="built_in">eye</span>(<span class="number">2</span>))*n(<span class="built_in">j</span>,:)'))*puz(<span class="built_in">j</span>,<span class="number">4</span>)+...</span><br><span class="line">        <span class="built_in">log</span>((<span class="number">1</span>+<span class="built_in">exp</span>(theta(<span class="number">5</span>)))*(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>))^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>))<span class="number">-1</span>)*(U(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))+V(<span class="built_in">j</span>)^(-<span class="built_in">exp</span>(theta(<span class="number">5</span>)))<span class="number">-1</span>)^(<span class="number">-2</span><span class="number">-1</span>/<span class="built_in">exp</span>(theta(<span class="number">5</span>))))*puz(<span class="built_in">j</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">y=-y;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h1 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h1><h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><div class="table-container">
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.9678</td>
<td>0.1075</td>
<td>2.7192</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>3.7781</td>
<td>0.5502</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>9.8959</td>
<td>0.1946</td>
<td></td>
</tr>
<tr>
<td>Norm-Copula</td>
<td>0.9250</td>
<td>0.0613</td>
<td></td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.0049</td>
<td>0.0864</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p>与3个Copula函数混合时的模型相比：</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="3个Copula函数混合Q-Q图"></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula_new.jpg" alt="5个Copula函数混合Q-Q图"></p>
<p>由于不是定量分析，对比效果不明显，以下采用定量分析</p>
<h2 id="KS检验"><a href="#KS检验" class="headerlink" title="KS检验"></a>KS检验</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_{3M}$</th>
<th>$K_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
<td>0.0260</td>
</tr>
</tbody>
</table>
</div>
<p>可以看出5个Copula混合时的模型较3个Copula混合时的效果更好</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_{3M}$</th>
<th>$d_{5M}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
<td>1.2730</td>
</tr>
</tbody>
</table>
</div>
<p>从欧氏距离上也能够得到与KS检验中同样的结果</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>综上，可以将混合Copula模型更新为如下形式</p>
<script type="math/tex; mode=display">
\begin{aligned}
C(u,v;a)= & 0.1075C_t(u,v;0.9678,2.7192)+0.0613C_N(u,v;0.9250)
+\\
& 0.5502C_{Gumbel}(u,v;3.7781)+0.1946C_{Frank}(u,v;9.8959)+0.0864C_{Clayton}(u,v;0.0049)
\end{aligned}</script><p>PS:以上程序跑了9个小时，由于本人电脑运算处理速度问题，暂且限制在该精度下，但是结果仍可更加精确，后面会使用工作站进行进一步的精确计算</p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
        <tag>混合Copula</tag>
      </tags>
  </entry>
  <entry>
    <title>光伏建模（2）——核密度估计实现</title>
    <url>/2017/03/17/2017-03-17-%E5%85%89%E4%BC%8F%E5%BB%BA%E6%A8%A1%EF%BC%882%EF%BC%89%E2%80%94%E2%80%94%E6%A0%B8%E5%AF%86%E5%BA%A6%E4%BC%B0%E8%AE%A1%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<h1 id="数据录入"><a href="#数据录入" class="headerlink" title="数据录入"></a>数据录入</h1><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\一月\太阳能测光数据_2010-01-01 - 2010-02-01.xls'</span>);</span><br><span class="line">solardata=solar(:,<span class="number">2</span>);</span><br><span class="line">SData=cell(<span class="number">1</span>,<span class="number">7</span>);</span><br><span class="line">SData(<span class="number">1</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\二月\太阳能测光数据_2010-02.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</span><br><span class="line">SData(<span class="number">2</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\三月\太阳能测光数据_2010-03-01 - 2010-04-01.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</span><br><span class="line">SData(<span class="number">3</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\四月\太阳能测光数据_2010-04-01 - 2010-05-01.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</span><br><span class="line">SData(<span class="number">4</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\五月\太阳能测光数据_2010-05-01 - 2010-06-01.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</span><br><span class="line">SData(<span class="number">5</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\六月\太阳能测光数据_2010-06-01 - 2010-07-01.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">2</span>)]</span><br><span class="line">SData(<span class="number">6</span>)=&#123;solar&#125;;</span><br><span class="line"></span><br><span class="line">solar=xlsread(<span class="string">'E:\学习\毕设\数据资料\数据资料\windfarm data\敦煌太阳能测光数据1-7\七月\太阳能测光数据2010-7-1-2010-8-1.xls'</span>);</span><br><span class="line">solardata=[solardata; solar(:,<span class="number">3</span>)]</span><br><span class="line">SData(<span class="number">7</span>)=&#123;solar&#125;;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="使用核密度估计对长时间内的光伏强度进行估计"><a href="#使用核密度估计对长时间内的光伏强度进行估计" class="headerlink" title="使用核密度估计对长时间内的光伏强度进行估计"></a>使用核密度估计对长时间内的光伏强度进行估计</h1><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[fsd,sdc]=ecdf(solardata);</span><br><span class="line">[fks,ksc]=ksdensity(solardata,[<span class="number">-100</span>:<span class="number">1</span>:<span class="number">1200</span>]);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">ecdfhist(fsd,sdc,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(ksc,fks,<span class="string">'-r'</span>)</span><br></pre></td></tr></table></figure>
<p><em>在默认情况下核函数选取的是高斯核函数，事实上在所有核函数中，高斯与epanechnikov这两种核函数拟合效果较好</em></p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/1.jpg" alt="频率分布"></p>
<p>可以看到在长时间尺度上（上例为半年）核密度估计的拟合程度很高，但是在稍短的时间尺度上（一个月）则效果较差，如下图</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_2.jpg" alt=""></p>
<p>该种情况可以通过<a href="http://blog.csdn.net/matlab_matlab/article/details/56286868" target="_blank" rel="noopener">调整窗的宽度来提高拟合优度</a>，如下图为窗宽度为2.5时重新拟合一个月的光伏强度结果</p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/1_3.jpg" alt="当width=2.5时拟合结果"></p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
        <tag>核密度估计</tag>
      </tags>
  </entry>
  <entry>
    <title>光伏建模——核密度估计而非Beta分布</title>
    <url>/2017/03/15/2017-03-15-%E5%85%89%E4%BC%8F%E5%BB%BA%E6%A8%A1/</url>
    <content><![CDATA[<h1 id="光伏建模与风速建模的不同"><a href="#光伏建模与风速建模的不同" class="headerlink" title="光伏建模与风速建模的不同"></a>光伏建模与风速建模的不同</h1><ul>
<li>对与风速建模而言，其符合双参数威布尔分布表示其样本数据符合双参数威布尔数据样本的特征</li>
<li>对于光伏建模而言，所谓的使用beta分布拟合光伏实际意义为在短时间内（一天之内）光照强度的曲线可以通过beta分布的概率密度函数去近似拟合</li>
</ul>
<p>此二者有本质区别，因此如果仅通过曲线拟合表示光伏建模数据不能称作光伏建模随机性的数学表述，因此在缺乏先验的情况下只能求助于仅基于样本数据核密度估计</p>
<a id="more"></a>
<h1 id="非参数核密度估计"><a href="#非参数核密度估计" class="headerlink" title="非参数核密度估计"></a>非参数核密度估计</h1><p>定义<br>  :   设$x_1,x_2,…,x_n$为随机变量$x$的样本，令随机变量$x$的概率密度函数为$f(x)$，则 $f(x)$ 的核密度估计为： </p>
<script type="math/tex; mode=display">f_h(x)={1 \over nh}{\displaystyle \sum_{j=1}^n{K({x-x_j \over h})}}={1 \over n}{\displaystyle \sum_{j=1}^n{K_h(x-x_j)}}</script><p>  其中$n$为样本容量，$h$ 为平滑系数，$K(·)$ 为核函数</p>
<iframe src="http://www.cnblogs.com/wt869054461/p/5935992.html" width="100%" height="700px" frameborder="0" scrolling="auto"> </iframe>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>核密度估计</tag>
      </tags>
  </entry>
  <entry>
    <title>混合Copula风速建模——代码实现与结果分析</title>
    <url>/2017/03/10/2017-03-10-%E6%B7%B7%E5%90%88Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E2%80%94%E2%80%94%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p><em>由于仿真一次所耗时间较长，因此选择北大桥与干河口风电场作为代表</em></p>
<h1 id="EM算法估计混合Copula参数"><a href="#EM算法估计混合Copula参数" class="headerlink" title="EM算法估计混合Copula参数"></a>EM算法估计混合Copula参数</h1><h2 id="EM主体"><a href="#EM主体" class="headerlink" title="EM主体"></a>EM主体</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">U=GHK;</span><br><span class="line">V=BDQ;</span><br><span class="line"><span class="comment">% 初始化</span></span><br><span class="line">S=<span class="number">3</span>;</span><br><span class="line">th=<span class="number">0.01</span>;</span><br><span class="line">omega=[<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>,<span class="number">1</span>/<span class="number">3</span>];</span><br><span class="line">[a,nuhat]=copulafit(<span class="string">'t'</span>,[U,V]);</span><br><span class="line">a2=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</span><br><span class="line">a3=copulafit(<span class="string">'Frank'</span>,[U,V]);</span><br><span class="line">theta=[a(<span class="number">1</span>,<span class="number">2</span>),a2,a3];</span><br><span class="line">[N,~]=<span class="built_in">size</span>(U);</span><br><span class="line">count=<span class="number">0</span>;</span><br><span class="line">tt=<span class="built_in">zeros</span>(N,<span class="number">2</span>);</span><br><span class="line">t=<span class="built_in">inf</span>;</span><br><span class="line">COPULA=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">list1=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</span><br><span class="line">list2=<span class="built_in">zeros</span>(<span class="number">3</span>,<span class="number">101</span>);</span><br><span class="line">puz=<span class="built_in">zeros</span>(N,S);</span><br><span class="line">puz1=<span class="built_in">zeros</span>(N,S);</span><br><span class="line"><span class="keyword">while</span> t&gt;=th&amp;&amp;count&lt;=<span class="number">100</span>;</span><br><span class="line">    theta_old=theta;</span><br><span class="line">    omega_old=omega;</span><br><span class="line">    COPULA(:,<span class="number">1</span>)=copulapdf(<span class="string">'t'</span>,[U(:) V(:)],theta_old(<span class="number">1</span>),nuhat);</span><br><span class="line">    COPULA(:,<span class="number">2</span>)=copulapdf(<span class="string">'Gumbel'</span>,[U(:) V(:)],theta_old(<span class="number">2</span>));</span><br><span class="line">    COPULA(:,<span class="number">3</span>)=copulapdf(<span class="string">'Frank'</span>,[U(:) V(:)],theta_old(<span class="number">3</span>));</span><br><span class="line">    puz(:,<span class="number">1</span>)=COPULA(:,<span class="number">1</span>)*omega_old(<span class="number">1</span>);</span><br><span class="line">    puz(:,<span class="number">2</span>)=COPULA(:,<span class="number">2</span>)*omega_old(<span class="number">2</span>);</span><br><span class="line">    puz(:,<span class="number">3</span>)=COPULA(:,<span class="number">3</span>)*omega_old(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">1</span>)=puz(<span class="built_in">i</span>,<span class="number">1</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">2</span>)=puz(<span class="built_in">i</span>,<span class="number">2</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">        puz1(<span class="built_in">i</span>,<span class="number">3</span>)=puz(<span class="built_in">i</span>,<span class="number">3</span>)/sum(puz(<span class="built_in">i</span>,:));</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    omega(<span class="number">1</span>)=sum(puz1(:,<span class="number">1</span>))/N;</span><br><span class="line">    omega(<span class="number">2</span>)=sum(puz1(:,<span class="number">2</span>))/N;</span><br><span class="line">    omega(<span class="number">3</span>)=sum(puz1(:,<span class="number">3</span>))/N;</span><br><span class="line">    omega</span><br><span class="line">    tt(:,<span class="number">1</span>)=tinv(U(:),nuhat);</span><br><span class="line">    tt(:,<span class="number">2</span>)=tinv(V(:),nuhat);</span><br><span class="line">    [turntheta,fval,exitflag,output,grad,hessian]=updatetheta(N,U,V,theta_old,puz1,tt,nuhat);</span><br><span class="line">    theta=turntheta;</span><br><span class="line">    theta</span><br><span class="line">    list1(:,count+<span class="number">1</span>)=theta;</span><br><span class="line">    list2(:,count+<span class="number">1</span>)=omega;</span><br><span class="line">    t=<span class="built_in">max</span>([norm(theta_old(:)-theta(:));norm(omega_old(:)-omega(:))])</span><br><span class="line">    count=count+<span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="参数更新（非线性优化bfgs）"><a href="#参数更新（非线性优化bfgs）" class="headerlink" title="参数更新（非线性优化bfgs）"></a>参数更新（非线性优化bfgs）</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[turntheta,fval,exitflag,output,grad,hessian]</span>=<span class="title">updatetheta</span><span class="params">(N,U,V,theta,puz,t,nuhat)</span></span></span><br><span class="line">options=optimset(<span class="string">'Display'</span>,<span class="string">'iter-detailed'</span>,<span class="string">'TolFun'</span>,<span class="number">1e-10</span>,<span class="string">'TolX'</span>,<span class="number">1e-10</span>,<span class="string">'LargeScale'</span>,<span class="string">'off'</span>,<span class="string">'FinDiffType'</span>,<span class="string">'central'</span>,<span class="string">'HessUpdate'</span>,<span class="string">'bfgs'</span>);</span><br><span class="line">[turntheta,fval,exitflag,output,grad,hessian]=fminunc(@utheta,theta,options);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span>=<span class="title">utheta</span><span class="params">(theta)</span></span></span><br><span class="line"><span class="keyword">if</span> theta(<span class="number">3</span>)==<span class="number">0</span></span><br><span class="line">    theta(<span class="number">3</span>)=theta(<span class="number">3</span>)+<span class="number">0.0001</span>;  <span class="comment">%防止出现 Frank  Copula 的相依结构参数为 0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">y=<span class="number">0</span>;</span><br><span class="line">th=<span class="built_in">eye</span>(<span class="number">2</span>);</span><br><span class="line">th(<span class="number">1</span>,<span class="number">2</span>)=theta(<span class="number">1</span>);</span><br><span class="line">th(<span class="number">2</span>,<span class="number">1</span>)=theta(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:N</span><br><span class="line"></span><br><span class="line">    y=y+<span class="built_in">log</span>(((det(th))^(<span class="number">-1</span>/<span class="number">2</span>))*<span class="built_in">gamma</span>((nuhat+<span class="number">2</span>)/<span class="number">2</span>)*<span class="built_in">gamma</span>(nuhat/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,:)*th^(<span class="number">-1</span>)*t(<span class="built_in">j</span>,:)'/nuhat)^(-(nuhat+<span class="number">2</span>)/<span class="number">2</span>)/((<span class="built_in">gamma</span>((nuhat+<span class="number">1</span>)/<span class="number">2</span>))^<span class="number">2</span>*((<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">1</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="number">1</span>+t(<span class="built_in">j</span>,<span class="number">2</span>)^<span class="number">2</span>/nuhat)^(-(nuhat+<span class="number">1</span>)/<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">1</span>)+...</span><br><span class="line">        <span class="built_in">log</span>(<span class="built_in">exp</span>(-((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^theta(<span class="number">2</span>)+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^theta(<span class="number">2</span>))^(<span class="number">1</span>/theta(<span class="number">2</span>)))*(<span class="built_in">log</span>(U(<span class="built_in">j</span>))*<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)<span class="number">-1</span>)*(((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">1</span>/theta(<span class="number">2</span>))+theta(<span class="number">2</span>)<span class="number">-1</span>)/(U(<span class="built_in">j</span>)*V(<span class="built_in">j</span>)*((-<span class="built_in">log</span>(U(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>))+(-<span class="built_in">log</span>(V(<span class="built_in">j</span>)))^(theta(<span class="number">2</span>)))^(<span class="number">2</span><span class="number">-1</span>/theta(<span class="number">2</span>))))*puz(<span class="built_in">j</span>,<span class="number">2</span>)+...</span><br><span class="line">        <span class="built_in">log</span>(theta(<span class="number">3</span>)*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))*<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*(U(<span class="built_in">j</span>)+V(<span class="built_in">j</span>)))/((<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)))-(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*U(<span class="built_in">j</span>)))*(<span class="number">1</span>-<span class="built_in">exp</span>(-theta(<span class="number">3</span>)*V(<span class="built_in">j</span>))))^<span class="number">2</span>)*puz(<span class="built_in">j</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">y=-y;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><div class="table-container">
<table>
<thead>
<tr>
<th>Copula函数</th>
<th>$\theta$</th>
<th>$\omega$</th>
<th>$k$</th>
</tr>
</thead>
<tbody>
<tr>
<td>t-Copula</td>
<td>0.1244</td>
<td>0.0822</td>
<td>3</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>4.1127</td>
<td>0.7495</td>
<td></td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>6.5931</td>
<td>0.1683</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>即</p>
<script type="math/tex; mode=display">C(u,v;a)=0.7495C_{Gumbel}(u,v;4.1127)+0.1683C_{Frank}(u,v;6.5931)+0.0822C_t(u,v;0.1244,3)</script><h1 id="结果评价"><a href="#结果评价" class="headerlink" title="结果评价"></a>结果评价</h1><h2 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h2><p><img src="http://oag5ozkgs.bkt.clouddn.com/mcopula.jpg" alt="mixed-Copula"><br>可以与之前单一Copula的仿真QQ图进行比较<br><img src="http://oag5ozkgs.bkt.clouddn.com/im1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/im2.jpg" alt="qq图3"><br>可以明显的看出拟合优度上混合Copula有很大的优势</p>
<h2 id="K-S检验"><a href="#K-S检验" class="headerlink" title="K-S检验"></a>K-S检验</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
<th>$K_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
<td>0.0271</td>
</tr>
</tbody>
</table>
</div>
<p>可以看出就K-S统计值而言混合Copula也小于其他单一Copula</p>
<h2 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
<th>$d_M$</th>
</tr>
</thead>
<tbody>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
<td>1.3220</td>
</tr>
</tbody>
</table>
</div>
<p>可以看出就欧式距离而言混合Copula也小于其他单一Copula</p>
<p>PS：作为一个学电气的人一开始看到要使用一个从未见过的EM算法我几乎是拒绝的，要多谢CS的室友和我分享了有关这方面的知识并且和我一起探讨。这个程序跑起来确实让人奔溃，跑一次就要三个多小时，但是最后仿真出来的结果符合我推测确实让我很开心</p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>MATLAB</tag>
        <tag>EM算法</tag>
        <tag>混合Copula</tag>
        <tag>bfgs</tag>
      </tags>
  </entry>
  <entry>
    <title>混合Copula函数风速建模——EM算法</title>
    <url>/2017/03/06/2017-03-06-%E6%B7%B7%E5%90%88Copula%E5%87%BD%E6%95%B0%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1/</url>
    <content><![CDATA[<p><img src="/images/123.jpg" alt="1"><br><a id="more"></a><br><img src="/images/1232.jpg" alt="2"><br><img src="/images/1233.jpg" alt="3"><br><img src="/images/1234.jpg" alt="4"><br><img src="/images/1235.jpg" alt="5"><br><img src="/images/1236.jpg" alt="6"><br><img src="/images/1237.jpg" alt="7"><br><img src="/images/1238.jpg" alt="8"><br><img src="/images/1239.jpg" alt="9"></p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>风速建模</tag>
        <tag>EM算法</tag>
      </tags>
  </entry>
  <entry>
    <title>Copula风速建模相关（5）——结果分析</title>
    <url>/2017/03/03/2017-03-03-Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%885%EF%BC%89/</url>
    <content><![CDATA[<h1 id="Q-Q图分析"><a href="#Q-Q图分析" class="headerlink" title="Q-Q图分析"></a>Q-Q图分析</h1><p><img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br><img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="noopener">Q-Q图的判定原则</a>可知，各类Copula函数差别不 很 明 显，其 中Gumbel-Copula，Frank-Copula，t-Copula函数曲线均较为接近45°曲线，拟合效果相对较好。以下采用统计法</p>
<a id="more"></a>
<h1 id="K-S检验法"><a href="#K-S检验法" class="headerlink" title="K-S检验法"></a>K-S检验法</h1><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
</div>
<p>通过<a href="http://fatelancer.top/2017/02/27/Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/#copula函数的拟合优度校验与经验copula函数对比" target="_blank" rel="noopener">K-S检验法的判定原则</a>可知，在六种不同的风电场组合中，Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数的 $KS$ 统计值相对较小，而Normal-Copula，Clayton-Copula的统计值相对较大</p>
<h1 id="秩相关性测度"><a href="#秩相关性测度" class="headerlink" title="秩相关性测度"></a>秩相关性测度</h1><div class="table-container">
<table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
</div>
<p>通过与经验函数的Kendall秩相关系数，Spearman秩相关系数进行对比可以发现Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与原始数据保持着良好的秩相关性，而Normal-Copula，Clayton-Copula的秩相关性较差。</p>
<h1 id="欧式距离"><a href="#欧式距离" class="headerlink" title="欧式距离"></a>欧式距离</h1><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
</div>
<p>可以看到在以上6种风电场组合中Gumbel-Copula，Frank-Copula，t-Copula这三种Copula函数与经验Copula函数的欧氏距离较小，而Normal-Copula，Clayton-Copula与经验函数的欧氏距离较大</p>
<h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>任何一个单一的Copula函数都不能够非常好的表达风电场的相依结构，因此考虑使用混合Copula函数，即将表现较好的3个Copula函数进行加权组合，即</p>
<script type="math/tex; mode=display">C(u,v;a)=\omega_1C_{Gumbel}(u,v;\theta_1)+\omega_2C_{Frank}(u,v;\theta_2)+\omega_3C_t(u,v;\theta_3,k)</script><p>其中 $\omega_1+ \omega_2+ \omega_3=1$</p>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>风速建模</tag>
      </tags>
  </entry>
  <entry>
    <title>Copula风速建模相关(4)——Copula模型评价</title>
    <url>/2017/03/02/2017-03-02-Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%884%EF%BC%89/</url>
    <content><![CDATA[<h1 id="Q-Q图"><a href="#Q-Q图" class="headerlink" title="Q-Q图"></a>Q-Q图</h1><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">%计算网格点上Copula分布函数值画QQ图</span></span><br><span class="line">Ccdf_n=copulacdf(<span class="string">'Gaussian'</span>,[Udata(:),Vdata(:)],rho_norm);</span><br><span class="line">Ccdf_t=copulacdf(<span class="string">'t'</span>,[Udata(:),Vdata(:)],rho_t,nuhat);</span><br><span class="line">Ccdf_G=copulacdf(<span class="string">'Gumbel'</span>,[Udata(:),Vdata(:)],paramhat_G);</span><br><span class="line">Ccdf_C=copulacdf(<span class="string">'Clayton'</span>,[Udata(:),Vdata(:)],paramhat_C);</span><br><span class="line">Ccdf_F=copulacdf(<span class="string">'Frank'</span>,[Udata(:),Vdata(:)],paramhat_F);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_n,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</span><br><span class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Normal Copula'</span>,<span class="string">'rho:'</span>,num2str(rho_norm(<span class="number">1</span>,<span class="number">2</span>))]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Normal'</span>]);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_t,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</span><br><span class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'t-Copula'</span>,<span class="string">'rho:'</span>,num2str(rho_t(<span class="number">1</span>,<span class="number">2</span>)),<span class="string">'k:'</span>,num2str(nuhat)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'t'</span>]);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_G,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</span><br><span class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Gumbel-Copula'</span>,<span class="string">'p_G:'</span>,num2str(paramhat_G)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Gumbel'</span>]);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_C,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</span><br><span class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Clayton-Copula'</span>,<span class="string">'p_C'</span>,num2str(paramhat_C)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Clayton'</span>]);</span><br><span class="line"><span class="built_in">figure</span>;</span><br><span class="line">qqplot(<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)),<span class="built_in">reshape</span>(Ccdf_F,<span class="built_in">size</span>(Udata)),<span class="string">'b'</span>);</span><br><span class="line">xlabel(<span class="string">'经验Copula'</span>);ylabel([<span class="string">'Frank-Copula'</span>,<span class="string">'p_F'</span>,num2str(paramhat_F)]); title([N&#123;n&#125;,<span class="string">'与'</span>,N&#123;m&#125;,<span class="string">'Q-Q图'</span>,<span class="string">'Frank'</span>]);</span><br></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p> <img src="http://oag5ozkgs.bkt.clouddn.com/2in1_1.jpg" alt="qq图2"><br> <img src="http://oag5ozkgs.bkt.clouddn.com/3in1_1.jpg" alt="qq图3"></p>
<a id="more"></a>
<h1 id="K-S检验"><a href="#K-S检验" class="headerlink" title="K-S检验"></a>K-S检验</h1><p><em>以北大桥与桥湾风电场为例</em></p>
<h2 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%K-S检验</span></span><br><span class="line">[h_n,p_n,k_n]=kstest2(CopulaEmpirical',Ccdf_n)</span><br><span class="line">[h_t,p_t,k_t]=kstest2(CopulaEmpirical',Ccdf_t)</span><br><span class="line">[h_G,p_G,k_G]=kstest2(CopulaEmpirical',Ccdf_G)</span><br><span class="line">[h_C,p_C,k_C]=kstest2(CopulaEmpirical',Ccdf_C)</span><br><span class="line">[h_F,p_F,k_F]=kstest2(CopulaEmpirical',Ccdf_F)</span><br></pre></td></tr></table></figure>
<h2 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$k_N$</th>
<th>$k_t$</th>
<th>$k_G$</th>
<th>$k_C$</th>
<th>$k_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>0.0406</td>
<td>0.0395</td>
<td>0.0302</td>
<td>0.0520</td>
<td>0.0364</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>0.0260</td>
<td>0.0219</td>
<td>0.0156</td>
<td>0.0489</td>
<td>0.0208</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>0.0260</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0499</td>
<td>0.0239</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>0.0395</td>
<td>0.0343</td>
<td>0.0302</td>
<td>0.0468</td>
<td>0.0323</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>0.0239</td>
<td>0.0239</td>
<td>0.0156</td>
<td>0.0385</td>
<td>0.0166</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>0.0208</td>
<td>0.0208</td>
<td>0.0146</td>
<td>0.0385</td>
<td>0.0156</td>
</tr>
</tbody>
</table>
</div>
<h1 id="Copula函数的秩相关性测度"><a href="#Copula函数的秩相关性测度" class="headerlink" title="Copula函数的秩相关性测度"></a>Copula函数的秩相关性测度</h1><h2 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%Copula模型的相关性测度</span></span><br><span class="line"><span class="comment">%使用原始数据计算秩相关系数</span></span><br><span class="line">Kendall=corr([X,Y],<span class="string">'type'</span>,<span class="string">'Kendall'</span>)</span><br><span class="line">Spearman=corr([X,Y],<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br><span class="line"><span class="comment">%计算Copula的秩相关系数</span></span><br><span class="line">Kendall_norm = copulastat(<span class="string">'Gaussian'</span>,rho_norm)</span><br><span class="line">Spearman_norm = copulastat(<span class="string">'Gaussian'</span>,rho_norm,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br><span class="line">Kendall_t = copulastat(<span class="string">'t'</span>,rho_t,nuhat)</span><br><span class="line">Spearman_t = copulastat(<span class="string">'t'</span>,rho_t,nuhat,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br><span class="line">Kendall_G = copulastat(<span class="string">'Gumbel'</span>,paramhat_G)</span><br><span class="line">Spearman_G = copulastat(<span class="string">'Gumbel'</span>,paramhat_G,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br><span class="line">Kendall_C = copulastat(<span class="string">'Clayton'</span>,paramhat_C)</span><br><span class="line">Spearman_C = copulastat(<span class="string">'Clayton'</span>,paramhat_C,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br><span class="line">Kendall_F = copulastat(<span class="string">'Frank'</span>,paramhat_F)</span><br><span class="line">Spearman_F= copulastat(<span class="string">'Frank'</span>,paramhat_F,<span class="string">'type'</span>,<span class="string">'Spearman'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="结果-2"><a href="#结果-2" class="headerlink" title="结果"></a>结果</h2><div class="table-container">
<table>
<thead>
<tr>
<th>数据来源</th>
<th>Kendall秩相关系数 $\tau$</th>
<th>Spearman秩相关系数 $\rho_s$</th>
</tr>
</thead>
<tbody>
<tr>
<td>原始观测数据</td>
<td>0.4816</td>
<td>0.6628</td>
</tr>
<tr>
<td>Normal-Copula</td>
<td>0.4371</td>
<td>0.6159</td>
</tr>
<tr>
<td>t-Copula</td>
<td>0.4410</td>
<td>0.6151</td>
</tr>
<tr>
<td>Gumbel-Copula</td>
<td>0.4604</td>
<td>0.6366</td>
</tr>
<tr>
<td>Clayton-Copula</td>
<td>0.2569</td>
<td>0.3751</td>
</tr>
<tr>
<td>Frank-Copula</td>
<td>0.4592</td>
<td>0.6465</td>
</tr>
</tbody>
</table>
</div>
<h1 id="欧式距离计算"><a href="#欧式距离计算" class="headerlink" title="欧式距离计算"></a>欧式距离计算</h1><h2 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%----------------求欧式距离</span></span><br><span class="line"><span class="comment">% 通过循环计算经验Copula函数在新产生的网格点处的函数值</span></span><br><span class="line">CUV=<span class="built_in">zeros</span>(<span class="built_in">size</span>(UU(:)));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(UU)</span><br><span class="line">    CUV(<span class="built_in">i</span>)=C(UU(<span class="built_in">i</span>),VV(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%求各Copula函数在原始样本点处的函数值</span></span><br><span class="line">Cnorm=copulacdf(<span class="string">'Gaussian'</span>,[UU(:),VV(:)],rho_norm);</span><br><span class="line">Ct=copulacdf(<span class="string">'t'</span>,[UU(:),VV(:)],rho_t,nuhat);</span><br><span class="line">CG=copulacdf(<span class="string">'Gumbel'</span>,[UU(:),VV(:)],paramhat_G);</span><br><span class="line">CC=copulacdf(<span class="string">'Clayton'</span>,[UU(:),VV(:)],paramhat_C);</span><br><span class="line">CF=copulacdf(<span class="string">'Frank'</span>,[UU(:),VV(:)],paramhat_F);</span><br><span class="line"></span><br><span class="line"><span class="comment">%计算欧式距离</span></span><br><span class="line">dnorm=<span class="built_in">sqrt</span>((CUV-Cnorm)'*(CUV-Cnorm))</span><br><span class="line">dt=<span class="built_in">sqrt</span>((CUV-Ct)'*(CUV-Ct))</span><br><span class="line">dG=<span class="built_in">sqrt</span>((CUV-CG)'*(CUV-CG))</span><br><span class="line">dC=<span class="built_in">sqrt</span>((CUV-CC)'*(CUV-CC))</span><br><span class="line">dF=<span class="built_in">sqrt</span>((CUV-CF)'*(CUV-CF))</span><br></pre></td></tr></table></figure>
<h2 id="结果-3"><a href="#结果-3" class="headerlink" title="结果"></a>结果</h2><div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$d_N$</th>
<th>$d_t$</th>
<th>$d_G$</th>
<th>$d_C$</th>
<th>$d_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾，北大桥</td>
<td>2.8924</td>
<td>2.8209</td>
<td>1.3953</td>
<td>9.1763</td>
<td>2.4125</td>
</tr>
<tr>
<td>桥湾，干河口</td>
<td>2.7285</td>
<td>2.6970</td>
<td>1.1862</td>
<td>8.2528</td>
<td>2.2180</td>
</tr>
<tr>
<td>桥湾，昌马</td>
<td>2.3450</td>
<td>2.2558</td>
<td>1.3469</td>
<td>8.3662</td>
<td>1.8227</td>
</tr>
<tr>
<td>北大桥，干河口</td>
<td>3.6952</td>
<td>2.4590</td>
<td>1.6097</td>
<td>10.9923</td>
<td>1.6888</td>
</tr>
<tr>
<td>北大桥，昌马</td>
<td>1.7187</td>
<td>1.7470</td>
<td>1.5995</td>
<td>5.0238</td>
<td>1.3692</td>
</tr>
<tr>
<td>干河口，昌马</td>
<td>1.8369</td>
<td>1.8561</td>
<td>1.3731</td>
<td>4.8842</td>
<td>1.4301</td>
</tr>
</tbody>
</table>
</div>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>Q-Q图</tag>
        <tag>K-S检验</tag>
        <tag>欧氏距离</tag>
      </tags>
  </entry>
  <entry>
    <title>Copula风速建模相关（3）——代码实现</title>
    <url>/2017/03/01/2017-03-01-Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%883%EF%BC%89/</url>
    <content><![CDATA[<h1 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h1><p><strong>使用甘肃桥湾（1），北大桥（2），干河口（3），昌马（4）四处风速数据作为仿真数据</strong></p>
<h1 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h1><h2 id="读入数据"><a href="#读入数据" class="headerlink" title="读入数据"></a>读入数据</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%从文件中读取数据</span></span><br><span class="line">load(<span class="string">'data.mat'</span>);</span><br><span class="line">qw=data(:,<span class="number">1</span>);<span class="comment">%桥湾</span></span><br><span class="line">bdq=data(:,<span class="number">4</span>);<span class="comment">%北大桥</span></span><br><span class="line">ghk=data(:,<span class="number">7</span>);<span class="comment">%干河口</span></span><br><span class="line">cm=data(:,<span class="number">10</span>);<span class="comment">%昌马</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="对风速进行双参数威布尔分布化"><a href="#对风速进行双参数威布尔分布化" class="headerlink" title="对风速进行双参数威布尔分布化"></a>对风速进行双参数威布尔分布化</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%桥湾</span></span><br><span class="line">pqw=wblfit(qw);</span><br><span class="line">QW=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pqw(<span class="number">1</span>),pqw(<span class="number">2</span>));</span><br><span class="line">QWC=wblcdf(qw,pqw(<span class="number">1</span>),pqw(<span class="number">2</span>));</span><br><span class="line"><span class="comment">%北大桥</span></span><br><span class="line">pbdq=wblfit(bdq);</span><br><span class="line">BDQ=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pbdq(<span class="number">1</span>),pbdq(<span class="number">2</span>));</span><br><span class="line">BDQC=wblcdf(bdq,pbdq(<span class="number">1</span>),pbdq(<span class="number">2</span>));</span><br><span class="line"><span class="comment">%干河口</span></span><br><span class="line">pghk=wblfit(ghk);</span><br><span class="line">GHK=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pghk(<span class="number">1</span>),pghk(<span class="number">2</span>));</span><br><span class="line">GHKC=wblcdf(ghk,pghk(<span class="number">1</span>),pghk(<span class="number">2</span>));</span><br><span class="line"><span class="comment">%昌马</span></span><br><span class="line">pcm=wblfit(cm);</span><br><span class="line">CM=wblpdf(<span class="number">1</span>:<span class="number">50</span>,pcm(<span class="number">1</span>),pcm(<span class="number">2</span>));</span><br><span class="line">CMC=wblcdf(cm,pcm(<span class="number">1</span>),pcm(<span class="number">2</span>));</span><br><span class="line">d=&#123;qw,bdq,ghk,cm&#125;;</span><br><span class="line">D=&#123;QW,BDQ,GHK,CM&#125;;</span><br><span class="line">DD=&#123;QWC,BDQC,GHKC,CMC&#125;;</span><br><span class="line">N=&#123;<span class="string">'桥湾'</span>,<span class="string">'北大桥'</span>,<span class="string">'干河口'</span>,<span class="string">'昌马'</span>&#125;;</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场</th>
<th>威布尔参数a</th>
<th>威布尔参数b</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾</td>
<td>8.1343</td>
<td>1.8773</td>
</tr>
<tr>
<td>北大桥</td>
<td>8.6619</td>
<td>1.7378</td>
</tr>
<tr>
<td>干河口</td>
<td>8.3685</td>
<td>1.5731</td>
</tr>
<tr>
<td>昌马</td>
<td>9.1261</td>
<td>2.1229</td>
</tr>
</tbody>
</table>
</div>
<h1 id="频率与频数直方图"><a href="#频率与频数直方图" class="headerlink" title="频率与频数直方图"></a>频率与频数直方图</h1><h2 id="频率分布直方图"><a href="#频率分布直方图" class="headerlink" title="频率分布直方图"></a>频率分布直方图</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%桥湾</span></span><br><span class="line">[fqw,qwc]=ecdf(qw);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>);</span><br><span class="line">ecdfhist(fqw,qwc,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(QW,<span class="string">'-r'</span>);</span><br><span class="line">title(<span class="string">'桥湾'</span>);</span><br><span class="line">xlabel(<span class="string">'风速'</span>);</span><br><span class="line">ylabel(<span class="string">'f(x)'</span>);</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="comment">%北大桥</span></span><br><span class="line">[fbdq,bdqc]=ecdf(bdq);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line">ecdfhist(fbdq,bdqc,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(BDQ,<span class="string">'-r'</span>);</span><br><span class="line">title(<span class="string">'北大桥'</span>);</span><br><span class="line">xlabel(<span class="string">'风速'</span>);</span><br><span class="line">ylabel(<span class="string">'f(x)'</span>);</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="comment">%干河口</span></span><br><span class="line">[fghk,ghkc]=ecdf(ghk);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>);</span><br><span class="line">ecdfhist(fghk,ghkc,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line"><span class="built_in">plot</span>(GHK,<span class="string">'-r'</span>);</span><br><span class="line">title(<span class="string">'干河口'</span>);</span><br><span class="line">xlabel(<span class="string">'风速'</span>);</span><br><span class="line">ylabel(<span class="string">'f(x)'</span>);</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="comment">%昌马</span></span><br><span class="line">[fcm,cmc]=ecdf(cm);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>);</span><br><span class="line">ecdfhist(fcm,cmc,<span class="number">100</span>);</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(CM,<span class="string">'-r'</span>);</span><br><span class="line">title(<span class="string">'昌马'</span>);</span><br><span class="line">xlabel(<span class="string">'风速'</span>);</span><br><span class="line">ylabel(<span class="string">'f(x)'</span>);</span><br><span class="line"><span class="built_in">hold</span> off</span><br></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/4in1_1.jpg" alt="频率分布直方图"></p>
<h2 id="频数分布直方图"><a href="#频数分布直方图" class="headerlink" title="频数分布直方图"></a>频数分布直方图</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="built_in">i</span>+<span class="number">1</span>:<span class="number">4</span></span><br><span class="line">        <span class="built_in">figure</span>;</span><br><span class="line">        hist3([DD&#123;<span class="built_in">i</span>&#125;(:) DD&#123;<span class="built_in">j</span>&#125;(:)],[<span class="number">50</span>,<span class="number">50</span>]);</span><br><span class="line">        xlabel(N&#123;<span class="built_in">i</span>&#125;);</span><br><span class="line">        ylabel(N&#123;<span class="built_in">j</span>&#125;);</span><br><span class="line">        zlabel(<span class="string">'频数'</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<p><img src="http://oag5ozkgs.bkt.clouddn.com/6in1.jpg" alt="风电场间频数直方图"></p>
<h1 id="各Copula函数"><a href="#各Copula函数" class="headerlink" title="各Copula函数"></a>各Copula函数</h1><h2 id="Copula函数参数估计"><a href="#Copula函数参数估计" class="headerlink" title="Copula函数参数估计"></a>Copula函数参数估计</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">rho_norm = copulafit(<span class="string">'Gaussian'</span>,[U,V]);</span><br><span class="line">[rho_t,nuhat,nuci]=copulafit(<span class="string">'t'</span>,[U,V]);</span><br><span class="line">paramhat_G=copulafit(<span class="string">'Gumbel'</span>,[U,V]);</span><br><span class="line">paramhat_C=copulafit(<span class="string">'Clayton'</span>,[U,V]);</span><br><span class="line">paramhat_F=copulafit(<span class="string">'Frank'</span>,[U,V]);</span><br></pre></td></tr></table></figure>
<p><strong>结果</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>风电场组合</th>
<th>$\rho_{Norm}$</th>
<th>$\rho_t$</th>
<th>$k$</th>
<th>$\theta_G$</th>
<th>$\theta_C$</th>
<th>$\theta_F$</th>
</tr>
</thead>
<tbody>
<tr>
<td>桥湾与北大桥</td>
<td>0.6339</td>
<td>0.6386</td>
<td>9.1619</td>
<td>1.8533</td>
<td>0.6913</td>
<td>5.0402</td>
</tr>
<tr>
<td>桥湾与干河口</td>
<td>0.5346</td>
<td>0.5364</td>
<td>9.7829</td>
<td>1.6350</td>
<td>0.4847</td>
<td>3.8853</td>
</tr>
<tr>
<td>桥湾与昌马</td>
<td>0.6108</td>
<td>0.6169</td>
<td>10.4474</td>
<td>1.7697</td>
<td>0.6530</td>
<td>4.8459</td>
</tr>
<tr>
<td>北大桥与干河口</td>
<td>0.8092</td>
<td>0.8479</td>
<td>2.7192</td>
<td>2.9270</td>
<td>1.4685</td>
<td>9.8959</td>
</tr>
<tr>
<td>北大桥与昌马</td>
<td>0.3639</td>
<td>0.3630</td>
<td>33.9054</td>
<td>1.3098</td>
<td>0.3072</td>
<td>2.3697</td>
</tr>
<tr>
<td>干河口与昌马</td>
<td>0.3028</td>
<td>0.3026</td>
<td>21.9903</td>
<td>1.2628</td>
<td>0.2141</td>
<td>1.9736</td>
</tr>
</tbody>
</table>
</div>
<h2 id="经验Copula"><a href="#经验Copula" class="headerlink" title="经验Copula"></a>经验Copula</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%计算经验分布</span></span><br><span class="line">[fx,xsort]=ecdf(X);</span><br><span class="line">[fy,ysort]=ecdf(Y);</span><br><span class="line"><span class="comment">%调用spine函数利用样条插值计算原始样本点的经验分布函数值</span></span><br><span class="line">UU=spline(xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),X);</span><br><span class="line">VV=spline(ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),Y);</span><br><span class="line"><span class="comment">%定义经验Copula函数</span></span><br><span class="line">C=@(u,v)<span class="built_in">mean</span>((UU&lt;=u).*(VV&lt;=v));</span><br><span class="line"></span><br><span class="line">[Udata,Vdata] = <span class="built_in">meshgrid</span>(<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">31</span>));</span><br><span class="line"><span class="comment">%循环计算经验Copula函数值</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(Udata)</span><br><span class="line">    CopulaEmpirical(<span class="built_in">i</span>)=C(Udata(<span class="built_in">i</span>),Vdata(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>MATLAB</tag>
        <tag>风力发电</tag>
      </tags>
  </entry>
  <entry>
    <title>Copula风速建模相关（2）——函数性质以及常用代码</title>
    <url>/2017/02/28/2017-02-28-Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%882%EF%BC%89/</url>
    <content><![CDATA[<p><a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28a48beacab57eaa1da8adc7ac58931c9a%29&amp;filter=sc_long_sign&amp;tn=SE_xueshusource_2kduw22v&amp;sc_vurl=http%3A%2F%2Fwww.docin.com%2Fp-204143270.html%3Fref%3D360%26ref%3D360%26ref%3D360&amp;ie=utf-8&amp;sc_us=15886197312218780659" target="_blank" rel="noopener">1</a></p>
<h1 id="二元Copula函数的定义以及性质"><a href="#二元Copula函数的定义以及性质" class="headerlink" title="二元Copula函数的定义以及性质"></a>二元Copula函数的定义以及性质</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义:"></a><strong>定义:</strong></h2><blockquote>
<p>二元Copula函数是指满足以下性质的函数$C(u,v)$:</p>
<ul>
<li>$C(u,v)$ 的定义域为[0,1]x[0,1]；</li>
<li>$C(u,v)$ 有零基面，并且是二维递增的；</li>
<li>对任意$u,v\in [0,1]$，满足$C(u,1)=u，C(1,v)=v$。<br>所谓的有零基面是：至少存在一个$u_0\in[0,1]$ 和一个$v_0\in[0,1]$，使得$C(u_0,v)=0=C(u,v_0)$。<br>二维递增是指：对任意$0\le u_1\le u_2\le1$和$0\le v_1\le v_2\le1$，有<script type="math/tex; mode=display">C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\ge 0</script></li>
</ul>
</blockquote>
<a id="more"></a>
<h2 id="性质："><a href="#性质：" class="headerlink" title="性质："></a><strong>性质：</strong></h2><blockquote>
<p>二元Copula函数满足以下性质：</p>
<ul>
<li>$C(u,v)$ 关于每一个变量都是单调非减的</li>
<li>对于任意的$u,v\in[0,1],C(u,0)=C(0,v)=0,C(u,1)=u,C(1,v)=v$</li>
<li>对任意$0\le u_1\le u_2\le1$和$0\le v_1\le v_2\le1$，有<script type="math/tex; mode=display">C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\ge 0</script></li>
<li>对任意的$u_1,u_2,v_1,v_2\in[0,1]$，有 $|C(u_2,v_2)-C(u_1,v_1)|\le|u_2-u_1|+|v_2-v_1|$。</li>
<li>对任意$u,v\in[0,1],max(u+v-1,0)\le C(u,v) \le min(u,v)$，令<br>$C^-(u,v)=max(u+v-1,0),C^+(u,v)=min(u,v)$，则称$C^-(u,v)和 C^+(u,v)$ 分别为<strong>Frechet上界和下界</strong></li>
<li>若$U,V$ 独立且同服从 $[0,1]$ 上的均匀分布，则$C(u,v)=uv$。</li>
</ul>
</blockquote>
<h1 id="多元Copula函数的定义及性质"><a href="#多元Copula函数的定义及性质" class="headerlink" title="多元Copula函数的定义及性质"></a>多元Copula函数的定义及性质</h1><h2 id="定义："><a href="#定义：" class="headerlink" title="定义："></a><strong>定义：</strong></h2><blockquote>
<p>N元Copula函数是指满足以下性质的函数 $C(u_1,u_2,…,u_N)$ ：</p>
<ul>
<li>定义域为 $[0,1]^N$</li>
<li>$C(u_1,u_2,…,u_N)$ 有零基面，并且是N维递增的；</li>
<li>$C(u_1,u_2,…,u_N)$ 有边缘分布函数<script type="math/tex; mode=display">C_i(u_i)=C(1,...,1,u_i,1,...,1)=u_i</script>  其中 $u_i \in <a href="i=1,2,...,N">0,1</a>$ 。</li>
</ul>
</blockquote>
<h2 id="性质：-1"><a href="#性质：-1" class="headerlink" title="性质："></a><strong>性质：</strong></h2><blockquote>
<p>多元Copula函数具备以下性质：</p>
<ul>
<li>$C(u_1,u_2,…,u_N)$ 关于每个变量都是单调非减得</li>
<li>$C(u_1,u_2,…,0,…,u_N)=0,C(1,…,1,u_i,1,…,1)=u_i$ 。</li>
<li>对任意的 $u_i,v_i \in <a href="i=1,2,...,N">0,1</a>$ ，有<script type="math/tex; mode=display">|C(u_1,u_2,...,u_N)|-C(v_1,v_2,...,v_N) \le {\displaystyle \sum _{i=1}^N {|u_i-v_i|}}</script></li>
<li>令 $C^-(u_1,u_2,…u_N)=max({\displaystyle\sum_{i=1}^N{u_i-N+1,0}})$ ，<br>$C^+(u_1,u_2,…,u_N)=min(u_1,u_2,…,u_N)$ ，则对任意的  $u_i\in <a href="i=1,2,...,N">0,1</a>$ ，有<script type="math/tex; mode=display">C^-(u_1,u_2,...u_N)\le C(u_1,u_2,...,u_N)\le C^+(u_1,u_2,...,u_N)</script>  记为 $C^-\prec C\prec C^+$ 。称 $C^-$ 和 $C^+$ 分别为<strong>Frechet</strong>上下界，当 $N\ge 2$ 时，$C^+$ 是一个N元Copula函数，但是当 $N&gt;2$ 时， $C^-$ 并不是一个Copula函数</li>
<li>若 $U_i\sim U(0,1)(i=1,2,…,N)$ 相互独立，则 $C(u_1,u_2,…,u_N)={\displaystyle \prod _{i=1}^N{u_i}}$</li>
</ul>
</blockquote>
<h1 id="MATLAB常用Copula函数"><a href="#MATLAB常用Copula函数" class="headerlink" title="MATLAB常用Copula函数"></a>MATLAB常用Copula函数</h1><h2 id="copulafit"><a href="#copulafit" class="headerlink" title="copulafit"></a><a href="http://cn.mathworks.com/help/stats/copulafit.html?s_tid=srchtitle" target="_blank" rel="noopener">copulafit</a></h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%估计正态Copula中的参数</span></span><br><span class="line"><span class="number">1.</span> RHOHAT=copulafit(<span class="string">'Gaussian'</span>,U)</span><br><span class="line"><span class="comment">%估计t-Copula中的参数</span></span><br><span class="line"><span class="number">2.</span> [RHOHAT,nuhat]=copulafit(<span class="string">'t'</span>,U)</span><br><span class="line"><span class="number">3.</span> [RHOHAT,nuhat,nuci]=copulafit(<span class="string">'t'</span>,U)</span><br><span class="line"><span class="comment">%估计二元阿基米德Copula中的参数（包括Clayton，Frank，Gumbel）</span></span><br><span class="line"><span class="number">4.</span> paramhat=copulafit(family,U)</span><br><span class="line"><span class="number">5.</span> [paramhat,paramci]=copulafit(family,U)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="copulastat"><a href="#copulastat" class="headerlink" title="copulastat"></a><a href="http://cn.mathworks.com/help/stats/copulastat.html" target="_blank" rel="noopener">copulastat</a></h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%计算正态Copula对应的Kendall秩相关系数</span></span><br><span class="line"><span class="number">1.</span> R=copulastat(<span class="string">'Gaussian'</span>,rho)</span><br><span class="line"><span class="comment">%计算t-Copula对应的Kendall秩相关系数</span></span><br><span class="line"><span class="number">2.</span> R=copulastat(<span class="string">'t'</span>,rho,NU)</span><br><span class="line"><span class="comment">%计算二元阿基米德Copula对应的Kendall秩相关系数（family字段可选Clayton，Frank，Gumbel）</span></span><br><span class="line"><span class="number">3.</span> R=copulastat(family,alpha)</span><br><span class="line"><span class="comment">%计算由type参数制定的秩相关系数R可选字段为'Kendall','Spearman'</span></span><br><span class="line"><span class="number">4.</span> R=copulastat(...,<span class="string">'type'</span>,<span class="built_in">type</span>)</span><br></pre></td></tr></table></figure>
<h2 id="copulaparam"><a href="#copulaparam" class="headerlink" title="copulaparam"></a><a href="http://cn.mathworks.com/help/stats/copulaparam.html" target="_blank" rel="noopener">copulaparam</a></h2><p><em>根据秩相关系数求解Copula中的 $\rho$ 或 $\alpha$</em><br><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%计算正态Copula中的线性相关参数ρ</span></span><br><span class="line"><span class="number">1.</span> rho=copulaparam(<span class="string">'Gaussian'</span>,R)</span><br><span class="line"><span class="comment">%计算t-Copula中的线性相关参数ρ</span></span><br><span class="line"><span class="number">2.</span> rho=copulaparam(<span class="string">'t'</span>,R,NU)</span><br><span class="line"><span class="comment">%计算二元阿基米德Copula中的参数α</span></span><br><span class="line"><span class="number">3.</span> alpha=copulaparam(family,R)</span><br><span class="line"><span class="comment">%用type参数指定秩相关系数的类型</span></span><br><span class="line"><span class="number">4.</span> [...]=copulaparam(...,<span class="string">'type'</span>,<span class="built_in">type</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="copulapdf"><a href="#copulapdf" class="headerlink" title="copulapdf"></a><a href="http://cn.mathworks.com/help/stats/copulapdf.html?searchHighlight=copulapdf&amp;s_tid=doc_srchtitle" target="_blank" rel="noopener">copulapdf</a></h2><p><em>用于计算Copula的密度函数值</em><br><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> y = copulapdf(<span class="string">'Gaussian'</span>,u,rho)</span><br><span class="line"><span class="number">2.</span> y = copulapdf(<span class="string">'t'</span>,u,rho,nu)</span><br><span class="line"><span class="number">3.</span> y = copulapdf(family,u,alpha)</span><br></pre></td></tr></table></figure></p>
<h2 id="copulacdf"><a href="#copulacdf" class="headerlink" title="copulacdf"></a><a href="http://cn.mathworks.com/help/stats/copulacdf.html" target="_blank" rel="noopener">copulacdf</a></h2><p><em>用于计算Copula分布函数值</em><br><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> y = copulacdf(<span class="string">'Gaussian'</span>,u,rho)</span><br><span class="line"><span class="number">2.</span> y = copulacdf(<span class="string">'t'</span>,u,rho,nu)</span><br><span class="line"><span class="number">3.</span> y = copulacdf(family,u,alpha)</span><br></pre></td></tr></table></figure><br><strong>PS:双参数威布尔分布常用函数：<a href="http://cn.mathworks.com/help/stats/wblfit.html?searchHighlight=wblfit&amp;s_tid=doc_srchtitle" target="_blank" rel="noopener">wblfit</a>,<a href="http://cn.mathworks.com/help/stats/wblpdf.html?searchHighlight=wblpdf&amp;s_tid=doc_srchtitle" target="_blank" rel="noopener">wblpdf</a>,<a href="http://cn.mathworks.com/help/stats/wblcdf.html?searchHighlight=wblcdf&amp;s_tid=doc_srchtitle" target="_blank" rel="noopener">wblcdf</a></strong></p>
<h1 id="Copula经验分布函数的求取"><a href="#Copula经验分布函数的求取" class="headerlink" title="Copula经验分布函数的求取"></a>Copula经验分布函数的求取</h1><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% 调用ecdf函数求X和Y的经验分布函数</span></span><br><span class="line">[fx, Xsort] = ecdf(X);</span><br><span class="line">[fy, Ysort] = ecdf(Y);</span><br><span class="line"><span class="comment">% 调用spline函数，利用样条插值法求原始样本点处的经验分布函数值</span></span><br><span class="line">U = spline(Xsort(<span class="number">2</span>:<span class="keyword">end</span>),fx(<span class="number">2</span>:<span class="keyword">end</span>),X);</span><br><span class="line">V = spline(Ysort(<span class="number">2</span>:<span class="keyword">end</span>),fy(<span class="number">2</span>:<span class="keyword">end</span>),Y);</span><br><span class="line"><span class="comment">% 定义经验Copula函数C(u,v)</span></span><br><span class="line">C = @(u,v)<span class="built_in">mean</span>((U &lt;= u).*(V &lt;= v));</span><br><span class="line"><span class="comment">% 为作图的需要，产生新的网格数据</span></span><br><span class="line">[Udata,Vdata] = <span class="built_in">meshgrid</span>(<span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">31</span>));</span><br><span class="line"><span class="comment">% 通过循环计算经验Copula函数在新产生的网格点处的函数值</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(Udata)</span><br><span class="line">    CopulaEmpirical(<span class="built_in">i</span>) = C(Udata(<span class="built_in">i</span>),Vdata(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>;  <span class="comment">% 新建图形窗口</span></span><br><span class="line"><span class="comment">% 绘制经验Copula分布函数图像</span></span><br><span class="line">surf(Udata,Vdata,<span class="built_in">reshape</span>(CopulaEmpirical,<span class="built_in">size</span>(Udata)))</span><br><span class="line">xlabel(<span class="string">'U'</span>);  <span class="comment">% 为X轴加标签</span></span><br><span class="line">ylabel(<span class="string">'V'</span>);  <span class="comment">% 为Y轴加标签</span></span><br><span class="line">zlabel(<span class="string">'Empirical Copula C(u,v)'</span>);  <span class="comment">% 为z轴加标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 通过循环计算经验Copula函数在原始样本点处的函数值</span></span><br><span class="line">CUV = <span class="built_in">zeros</span>(<span class="built_in">size</span>(U(:)));</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">numel</span>(U)</span><br><span class="line">    CUV(<span class="built_in">i</span>) = C(U(<span class="built_in">i</span>),V(<span class="built_in">i</span>));</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>Copula</tag>
        <tag>MATLAB</tag>
      </tags>
  </entry>
  <entry>
    <title>Copula风速建模相关（1）——相关参数</title>
    <url>/2017/02/27/2017-02-27-Copula%E9%A3%8E%E9%80%9F%E5%BB%BA%E6%A8%A1%E7%9B%B8%E5%85%B3%EF%BC%881%EF%BC%89/</url>
    <content><![CDATA[<h1 id="Copula函数的拟合优度校验——与经验Copula函数对比"><a href="#Copula函数的拟合优度校验——与经验Copula函数对比" class="headerlink" title="Copula函数的拟合优度校验——与经验Copula函数对比"></a>Copula函数的拟合优度校验——与经验Copula函数对比</h1><blockquote>
<p><strong>QQ图（Q-QNorm）</strong><br>把数据的分位数与已知分布相比较，从而来判断数据的分布情况。把已知分布的分位数标在纵轴上，样本分位数标在横轴上，从图形上可以了解到分布的信息。图形是直线说明是正态分布。图形中有一段是直线，在两端存在弧度，说明峰度的情况。</p>
<ul>
<li>图形是曲线图，说明不对称。</li>
<li>如果Q-Q图是直线，当该直线成45度角并穿过原点时，说明分布与给定的正态分布完全一样。</li>
<li>如果是成45度角但不穿过原点，说明均值与给定的正态分布不同</li>
<li>如果是直线但不是45度角，说明均值与方差都与给定的分布不同。</li>
<li>如果Q-Q图中间部分是直线，但是右边在直线下面，左边在直线上面，说明分布的峰度大于3，反之说明峰度小于3.<a id="more"></a>
</li>
</ul>
<p><a href="http://m.blog.csdn.net/article/details?id=52794839" target="_blank" rel="noopener"><strong>K-S检验法（Kolmogorov-Smirnov test）</strong></a><br>检验数据是否符合某种分布\<br>Kolmogorov-Smirnov是比较一个频率分布f(x)与理论分布g(x)或者两个观测值分布的检验方法。其原假设H0:两个数据分布一致或者数据符合理论分布。 $D=max| f(x)- g(x)|$ ，当实际观测值D&gt;D(n,α)则拒绝H0，否则则接受H0假设。\<br>KS检验与t-检验之类的其他方法不同是KS检验不需要知道数据的分布情况，可以算是一种非参数检验方法。当然这样方便的代价就是当检验的数据分布符合特定的分布事，KS检验的灵敏度没有相应的检验来的高。在样本量比较小的时候，KS检验最为非参数检验在分析两组数据之间是否不同时相当常用。\<br>PS：t-检验的假设是检验的数据满足正态分布，否则对于小样本不满足正态分布的数据用t-检验就会造成较大的偏差，虽然对于大样本不满足正态分布的数据而言t-检验还是相当精确有效的手段。\<br>本例中使用kstest2函数</p>
</blockquote>
<h1 id="对风电场风速进行处理——双参数威布尔分布"><a href="#对风电场风速进行处理——双参数威布尔分布" class="headerlink" title="对风电场风速进行处理——双参数威布尔分布"></a>对风电场风速进行处理——双参数威布尔分布</h1><p>双参数威布尔函数</p>
<script type="math/tex; mode=display">F_w(x)=1-exp(-({x \over c})^k)</script><p>其概率密度函数为</p>
<script type="math/tex; mode=display">P(x)={k \over c} ({k \over c})^{k-1}exp(-({x \over c})^k)</script><p>式中 $k$ 为形状参数，无量纲； $c$ 为尺度参数，反映风电场的平均风速，单位为 $m/s$ 。</p>
<h1 id="Pearson相关系数"><a href="#Pearson相关系数" class="headerlink" title="Pearson相关系数"></a><a href="http://blog.csdn.net/wsywl/article/details/5727327" target="_blank" rel="noopener">Pearson相关系数</a></h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>皮尔逊相关也称为积差相关（或积矩相关）是英国统计学家皮尔逊于20世纪提出的一种计算直线相关的方法。在本例中主要用于对两组风速曲线的相关性进行表示</p>
<p>假设有两个变量X、Y，那么两变量间的皮尔逊相关系数可通过以下公式计算：</p>
<p>公式一：</p>
<script type="math/tex; mode=display">\rho_{X,Y}={cov(X,Y) \over \sigma_X \sigma_Y}={E((X-\mu_X)(Y-\mu_Y))\over  \sigma_X \sigma_Y}={E(XY)-E(X)E(Y)\over \sqrt{E(X^2)-E^2(X)}\sqrt{E(Y^2)-E^2(Y)}}</script><p>公式二：</p>
<script type="math/tex; mode=display">\rho_{X,Y}={N\sum{XY}-\sum{X} \sum{Y} \over\sqrt{N\sum{X^2}-(\sum{X})^2}\sqrt{N\sum{Y^2}-(\sum{Y})^2}}</script><p>公式三：</p>
<script type="math/tex; mode=display">\rho_{X,Y}={\sum(X-\overline{X})(Y-\overline{Y}) \over\sqrt{\sum(X-\overline{X})^2\sum(Y-\overline{Y})^2}}</script><p>公式四：</p>
<script type="math/tex; mode=display">\rho_{X,Y}={\sum{XY}-{\sum{X}\sum{Y}\over N}\over\sqrt{(\sum{X^2}-{(\sum{X})^2\over N})}\sqrt{(\sum{Y^2}-{(\sum{Y})^2\over N})}}</script><p>以上列出的四个公式等价，其中E是数学期望，cov表示协方差，N表示变量取值的个数。</p>
<h2 id="适用范围"><a href="#适用范围" class="headerlink" title="适用范围"></a>适用范围</h2><p>当两个变量的标准差都不为零时，相关系数才有定义，皮尔逊相关系数适用于：</p>
<ol>
<li><p>两个变量之间是线性关系，都是连续数据。</p>
</li>
<li><p>两个变量的总体是正态分布，或接近正态的单峰分布。</p>
</li>
<li><p>两个变量的观测值是成对的，每对观测值之间相互独立。</p>
</li>
</ol>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>可再生能源</tag>
        <tag>Copula</tag>
        <tag>双参数威布尔函数</tag>
      </tags>
  </entry>
  <entry>
    <title>基于Copula理论的风电场间建模</title>
    <url>/2017/02/21/2017-02-21-%E5%9F%BA%E4%BA%8ECopula%E7%90%86%E8%AE%BA%E7%9A%84%E9%A3%8E%E7%94%B5%E5%9C%BA%E9%97%B4%E5%BB%BA%E6%A8%A1/</url>
    <content><![CDATA[<h1 id="关于研究目的"><a href="#关于研究目的" class="headerlink" title="关于研究目的"></a>关于研究目的</h1><p>由于风电基地的多个风电场地理位置比较靠近，且基本处于同一风带，风速之间具有较强的相关性，使得多个风电场的总体特性不同于单个风电场的特性。</p>
<p>通过Copula理论进行多个风电场风俗的联合概率分布研究。<br><a id="more"></a></p>
<h1 id="Copula理论"><a href="#Copula理论" class="headerlink" title="Copula理论"></a>Copula理论</h1><h2 id="关于Copula函数"><a href="#关于Copula函数" class="headerlink" title="关于Copula函数"></a>关于Copula函数</h2><p>Copula函数在网络中所能检索到的信息</p>
<blockquote>
<p><strong><a href="http://baike.baidu.com/link?url=qvRvG5X9bS0pqQzhZ7WtPKjmalr9UxgsV8kHdMbNFxPePq4CemrnaHF3c6-9g8Ihdw_9RyfSHJtHnw0uyLeGKCZv2In40VEqDCbmQrvQ5Zk4sbjreZggZCwwgpedrK8j" target="_blank" rel="noopener">Copula函数</a>百度</strong><br>Copula函数描述的是变量间的相关性，实际上是一类将联合分布函数与它们各自的边缘分布函数连接在一起的函数，因此也有人将它称为连接函数。相关理论的提出可以追溯到1959年，SKlar通过定理形式将多元分布与Copula函数联系起来。\<br>20世纪90年代后期相关理论和方法在国外开始得到迅速发展并应用到金融，保险等领域的相关分析，投资组合分析和风险管理等多个方面。\<br>定义:(Nelsen.2006) N 元Copula函数是指具有以下性质的函数（下记为C）：\<br>（1）定义域为[0,1]×[0,1]×。。。×[0,1] （共为N个域相乘）；\<br>（2）C具有零基面（grounded）且是N维递增的；\<br>（3）C的边缘分布Cn，n=1,2,,,,N,满足Cn(xn)=C(1,…,1,xn,1,,,1)=xn，其中xn∈[0,1],n=1,2,,,N \</p>
<p>CopulaWIKI</p>
</blockquote>
<p><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_1.Png" target="_blank" rel="noopener">1</a><br><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_2.Png" target="_blank" rel="noopener">2</a><br><a href="http://oag5ozkgs.bkt.clouddn.com/02211106461%E8%80%A6%E5%90%88%28%E6%A6%82%E7%8E%87%29-%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%EF%BC%8C%E8%87%AA%E7%94%B1%E7%9A%84%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6_3.Png" target="_blank" rel="noopener">3</a></p>
<p><strong>要点：</strong></p>
<ul>
<li>边缘分布与联合分布的概念</li>
<li>关于风速的概率分布问题</li>
</ul>
]]></content>
      <categories>
        <category>毕业设计</category>
      </categories>
      <tags>
        <tag>可再生能源</tag>
        <tag>Copula</tag>
      </tags>
  </entry>
  <entry>
    <title>Java第四次课</title>
    <url>/2016/10/23/2016-10-23-javaclass4/</url>
    <content><![CDATA[<h2 id="1-基础面板搭建"><a href="#1-基础面板搭建" class="headerlink" title="1. 基础面板搭建"></a>1. 基础面板搭建</h2><a id="more"></a>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> mygame;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/28.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CartoonApp</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CartoonApp</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CartoonPaint</span> <span class="keyword">extends</span> <span class="title">JPanel</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String [] args)</span></span>&#123;</span><br><span class="line">        CartoonApp ca = <span class="keyword">new</span> CartoonApp();</span><br><span class="line">        ca.setTitle(<span class="string">"我的第一个动画程序"</span>);</span><br><span class="line">        ca.setBounds(<span class="number">300</span>,<span class="number">200</span>,<span class="number">400</span>,<span class="number">450</span>);</span><br><span class="line">        ca.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        ca.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-变量定义"><a href="#2-变量定义" class="headerlink" title="2. 变量定义"></a>2. 变量定义</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JPanel [] pnl = &#123;<span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout()),</span><br><span class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout()),</span><br><span class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout()),</span><br><span class="line">                    <span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout())&#125;;</span><br><span class="line">    String [] str = &#123;<span class="string">"North"</span>, <span class="string">"Center"</span>, <span class="string">"South"</span>&#125;;</span><br><span class="line">    JLabel lblTitle = <span class="keyword">new</span> JLabel(<span class="string">"我的第一个动画程序"</span>);</span><br><span class="line">    JButton [] btn = &#123;<span class="keyword">new</span> JButton(<span class="string">"start"</span>), <span class="keyword">new</span> JButton(<span class="string">"pause"</span>),</span><br><span class="line">                        <span class="keyword">new</span> JButton(<span class="string">"resume"</span>), <span class="keyword">new</span> JButton(<span class="string">"exit"</span>)&#125;;</span><br><span class="line">    <span class="keyword">int</span> x,y,z;</span><br><span class="line">    Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line">    Color [] c = &#123;Color.red, Color.green, Color.blue,Color.pink, Color.yellow&#125;;</span><br><span class="line">    CartoonPaint cp = <span class="keyword">new</span> CartoonPaint();</span><br></pre></td></tr></table></figure>
<h2 id="3-基本图形绘制"><a href="#3-基本图形绘制" class="headerlink" title="3.基本图形绘制"></a>3.基本图形绘制</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CartoonPaint</span> <span class="keyword">extends</span> <span class="title">JPanel</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paintComponent</span><span class="params">(Graphics g)</span></span>&#123;</span><br><span class="line">            g.setColor(c[<span class="number">0</span>]);</span><br><span class="line">            g.drawOval(<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">            g.fillOval(<span class="number">120</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">            g.drawRect(<span class="number">230</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">            g.fillRect(<span class="number">340</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">int</span> [] x1 = &#123;<span class="number">100</span>, <span class="number">50</span>,<span class="number">150</span>&#125;;</span><br><span class="line">            <span class="keyword">int</span> [] y1 = &#123;<span class="number">50</span>,<span class="number">150</span>, <span class="number">150</span>&#125;;</span><br><span class="line">            g.drawPolygon(<span class="keyword">new</span> Polygon(x1,y1,x1.length));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-异常"><a href="#4-异常" class="headerlink" title="4. 异常"></a>4. 异常</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">0</span>])&#123;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">1</span>])&#123;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">2</span>])&#123;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ae.getSource()==btn[<span class="number">3</span>])&#123;</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,ex.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
  </entry>
  <entry>
    <title>Java 第二次课</title>
    <url>/2016/10/23/2016-10-23-javaclass2/</url>
    <content><![CDATA[<h1 id="封装继承多态"><a href="#封装继承多态" class="headerlink" title="封装继承多态"></a>封装继承多态</h1><a id="more"></a>
<h2 id="1-父类"><a href="#1-父类" class="headerlink" title="1. 父类"></a>1. 父类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String r_id;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> speed;</span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span>&#123;</span><br><span class="line">        r_id = JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"r_id = "</span>,</span><br><span class="line">                <span class="string">"请输入ID"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">        speed = Integer.parseInt( JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"speed = "</span>,</span><br><span class="line">                <span class="string">"请输入速度"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line">        <span class="comment">/*temp = Double.parseDouble(JOptionPane.showInputDialog(null,</span></span><br><span class="line"><span class="comment">                "temp = ",</span></span><br><span class="line"><span class="comment">                "请输入温度",</span></span><br><span class="line"><span class="comment">                JOptionPane.QUESTION_MESSAGE</span></span><br><span class="line"><span class="comment">        ));*/</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (speed&gt;<span class="number">120</span>)&#123;</span><br><span class="line">            speed = <span class="number">115</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您超速了"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您的速度正常"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"r_id = "</span>+r_id+<span class="string">"\n"</span>+<span class="string">"speed = "</span>+speed +<span class="string">"\n"</span> <span class="comment">/*+ "temp = "+temp+"\n"*/</span>+ judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-子类"><a href="#2-子类" class="headerlink" title="2. 子类"></a>2. 子类</h2><h3 id="2-1-子类1（WarRobot）"><a href="#2-1-子类1（WarRobot）" class="headerlink" title="2.1 子类1（WarRobot）"></a>2.1 子类1（WarRobot）</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weapon_count;</span><br><span class="line">    <span class="comment">//private String r_id;</span></span><br><span class="line">    <span class="comment">//private int speed;</span></span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WarRobot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        weapon_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"weapon_count = "</span>,</span><br><span class="line">                <span class="string">"请输入武器数量"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (weapon_count &gt; <span class="number">10</span>) &#123;</span><br><span class="line">            speed = <span class="number">200</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是战神"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是菜鸟"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"r_id = "</span> + r_id + <span class="string">"\n"</span> + <span class="string">"speed = "</span> + speed + <span class="string">"\n"</span> + <span class="string">"weapon_count = "</span> + weapon_count + <span class="string">"\n"</span> + judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"战斗机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-子类2（HomeRobot）"><a href="#2-2-子类2（HomeRobot）" class="headerlink" title="2.2 子类2（HomeRobot）"></a>2.2 子类2（HomeRobot）</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> skill_count;</span><br><span class="line">    <span class="comment">//protected String r_id;</span></span><br><span class="line">    <span class="comment">//protected int speed;</span></span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeRobot</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        skill_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"skill_count = "</span>,</span><br><span class="line">                <span class="string">"请输入技能数"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (skill_count&gt;<span class="number">5</span>)&#123;</span><br><span class="line">           <span class="comment">// speed = 115;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"你是家务大师"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是家务菜鸟"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.output();</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"skill_count = "</span>+skill_count+<span class="string">"\n"</span>+ judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-UML类图"><a href="#2-3-UML类图" class="headerlink" title="2.3 UML类图"></a>2.3 UML类图</h3><p><img src="https://github.com/fatelancer/robot_class/blob/master/src/Class_1/uml.png" alt=""></p>
<h1 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h1><h2 id="1-父类抽象类"><a href="#1-父类抽象类" class="headerlink" title="1. 父类抽象类"></a>1. 父类抽象类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String r_id;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> speed;</span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Robot</span><span class="params">()</span></span>&#123;</span><br><span class="line">        r_id = JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"r_id = "</span>,</span><br><span class="line">                <span class="string">"请输入ID"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">        speed = Integer.parseInt( JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"speed = "</span>,</span><br><span class="line">                <span class="string">"请输入速度"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line">        <span class="comment">/*temp = Double.parseDouble(JOptionPane.showInputDialog(null,</span></span><br><span class="line"><span class="comment">                "temp = ",</span></span><br><span class="line"><span class="comment">                "请输入温度",</span></span><br><span class="line"><span class="comment">                JOptionPane.QUESTION_MESSAGE</span></span><br><span class="line"><span class="comment">        ));*/</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (speed&gt;<span class="number">120</span>)&#123;</span><br><span class="line">            speed = <span class="number">115</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您超速了"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您的速度正常"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"r_id = "</span>+r_id+<span class="string">"\n"</span>+<span class="string">"speed = "</span>+speed +<span class="string">"\n"</span> <span class="comment">/*+ "temp = "+temp+"\n"*/</span>+ judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="keyword">abstract</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-子类-1"><a href="#2-子类-1" class="headerlink" title="2.子类"></a>2.子类</h2><h3 id="2-1-子类1"><a href="#2-1-子类1" class="headerlink" title="2.1 子类1"></a>2.1 子类1</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> weapon_count;</span><br><span class="line">    <span class="comment">//private String r_id;</span></span><br><span class="line">    <span class="comment">//private int speed;</span></span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WarRobot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        weapon_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"weapon_count = "</span>,</span><br><span class="line">                <span class="string">"请输入武器数量"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (weapon_count &gt; <span class="number">10</span>) &#123;</span><br><span class="line">            speed = <span class="number">200</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是战神"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是菜鸟"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"r_id = "</span> + r_id + <span class="string">"\n"</span> + <span class="string">"speed = "</span> + speed + <span class="string">"\n"</span> + <span class="string">"weapon_count = "</span> + weapon_count + <span class="string">"\n"</span> + judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"战斗机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我像风一样的奔跑"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-子类2（HomeRobot）-1"><a href="#2-2-子类2（HomeRobot）-1" class="headerlink" title="2.2 子类2（HomeRobot）"></a>2.2 子类2（HomeRobot）</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> skill_count;</span><br><span class="line">    <span class="comment">//protected String r_id;</span></span><br><span class="line">    <span class="comment">//protected int speed;</span></span><br><span class="line">    <span class="comment">//private double temp;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HomeRobot</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        skill_count = Integer.parseInt(JOptionPane.showInputDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"skill_count = "</span>,</span><br><span class="line">                <span class="string">"请输入技能数"</span>,</span><br><span class="line">                JOptionPane.QUESTION_MESSAGE</span><br><span class="line">        ));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (skill_count&gt;<span class="number">5</span>)&#123;</span><br><span class="line">           <span class="comment">// speed = 115;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"你是家务大师"</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//speed = 40;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">"您是家务菜鸟"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.output();</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,<span class="comment">//父容器</span></span><br><span class="line">                <span class="string">"skill_count = "</span>+skill_count+<span class="string">"\n"</span>+ judge() + <span class="string">"\n"</span>,</span><br><span class="line">                <span class="string">"机器人信息"</span>,</span><br><span class="line">                JOptionPane.INFORMATION_MESSAGE</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"我像仙女一样在飘"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-运行程序"><a href="#3-运行程序" class="headerlink" title="3. 运行程序"></a>3. 运行程序</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Class_1;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainProg</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span> <span class="params">(String [] args)</span></span>&#123;<span class="comment">// 命令行运行输入的参数</span></span><br><span class="line">        Robot r1;<span class="comment">//为超类Robot新建一个引用</span></span><br><span class="line"></span><br><span class="line">        WarRobot wr = <span class="keyword">new</span> WarRobot();</span><br><span class="line">        wr.output();</span><br><span class="line"></span><br><span class="line">        HomeRobot hr = <span class="keyword">new</span> HomeRobot();</span><br><span class="line">        hr.output();</span><br><span class="line">		<span class="comment">//将超类Robot的引用r1指向子类WarRobot的对象wr</span></span><br><span class="line">		r1 = wr;</span><br><span class="line">		r1.run();</span><br><span class="line"></span><br><span class="line">		r1 = hr;</span><br><span class="line">		r1.run();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//Robot r1 = new WarRobot();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h1><h2 id="1-接口"><a href="#1-接口" class="headerlink" title="1. 接口"></a>1. 接口</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Robot</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> SPEED=<span class="number">100</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">walk</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MusicRobot</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> PLAY_KINDS=<span class="number">10</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WarRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> WEAPON_COUNT=<span class="number">15</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">war</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HomeRobot</span> <span class="keyword">extends</span> <span class="title">Robot</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> SKILL_COUNT=<span class="number">8</span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-子类-2"><a href="#2-子类-2" class="headerlink" title="2. 子类"></a>2. 子类</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperRobot</span> <span class="keyword">implements</span> <span class="title">HomeRobot</span>,<span class="title">WarRobot</span>,<span class="title">MusicRobot</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> SuperAbility;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SuperRobot</span><span class="params">(String i,<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">		id=i;</span><br><span class="line">		SuperAbility=s;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (SuperAbility&gt;<span class="number">120</span>)&#123;</span><br><span class="line">			System.out.println(<span class="string">"您太厉害了"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			System.out.println(<span class="string">"您还需要继续修炼"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"I can cook!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">walk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"I can walk!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">war</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"I can war!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		System.out.println(<span class="string">"I can play instruments!"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"id="</span>+id+<span class="string">"\nSuperAbility="</span>+SuperAbility);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-执行程序"><a href="#3-执行程序" class="headerlink" title="3. 执行程序"></a>3. 执行程序</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Program;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainProgram</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		SuperRobot r=<span class="keyword">new</span> SuperRobot(<span class="string">"r001"</span>,<span class="number">10</span>);</span><br><span class="line">		r.judge();</span><br><span class="line">		r.walk();</span><br><span class="line">		r.war();</span><br><span class="line">		r.cook();</span><br><span class="line">		r.play();</span><br><span class="line">		r.output();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-UML图"><a href="#4-UML图" class="headerlink" title="4. UML图"></a>4. UML图</h2><p><img src="https://github.com/fatelancer/robot_class/blob/master/src/Program/diagram.png" alt=""></p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
  </entry>
  <entry>
    <title>Java第三次课</title>
    <url>/2016/10/23/2016-10-23-javaclass3/</url>
    <content><![CDATA[<h1 id="GUI设计"><a href="#GUI设计" class="headerlink" title="GUI设计"></a>GUI设计</h1><a id="more"></a>
<h2 id="1-框架"><a href="#1-框架" class="headerlink" title="1. 框架"></a>1. 框架</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> AreaCalculate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by fatel on 2016/5/14.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleArea</span> <span class="keyword">extends</span> <span class="title">JFrame</span> <span class="keyword">implements</span> <span class="title">ActionListener</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CircleArea</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String [] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-主界面"><a href="#2-主界面" class="headerlink" title="2. 主界面"></a>2. 主界面</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">CircleArea ca = <span class="keyword">new</span> CircleArea();</span><br><span class="line">ca.setTitle(<span class="string">"圆面积的计算"</span>);</span><br><span class="line">ca.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">280</span>,<span class="number">180</span>);</span><br><span class="line">ca.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">ca.setVisible(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>
<h2 id="3-搭建面板"><a href="#3-搭建面板" class="headerlink" title="3. 搭建面板"></a>3. 搭建面板</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JPanel p0 = <span class="keyword">new</span> JPanel();</span><br><span class="line">JPanel p1 = <span class="keyword">new</span> JPanel();</span><br><span class="line">JPanel p2 = <span class="keyword">new</span> JPanel();</span><br><span class="line">JPanel p3 = <span class="keyword">new</span> JPanel();</span><br><span class="line"></span><br><span class="line">JLabel l0 = <span class="keyword">new</span> JLabel(<span class="string">"圆面积计算系统"</span>, JLabel.CENTER);</span><br><span class="line">JLabel l1 = <span class="keyword">new</span> JLabel(<span class="string">"请输入圆的半径："</span>, JLabel.CENTER);</span><br><span class="line">JLabel l2 = <span class="keyword">new</span> JLabel(<span class="string">"圆的面积是："</span>, JLabel.CENTER);</span><br><span class="line"></span><br><span class="line">JTextField t1 = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</span><br><span class="line">JTextField t2 = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">JButton b1 = <span class="keyword">new</span> JButton(<span class="string">"计算"</span>);</span><br><span class="line">JButton b2 = <span class="keyword">new</span> JButton(<span class="string">"清空"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="4-面板布局"><a href="#4-面板布局" class="headerlink" title="4. 面板布局"></a>4. 面板布局</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">p1.setLayout(fl);</span><br><span class="line">p1.setBackground(Color.yellow);</span><br><span class="line">p1.add(l0);</span><br><span class="line"></span><br><span class="line">p2.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">5</span>));</span><br><span class="line">p2.setBackground(Color.green);</span><br><span class="line">p2.add(l1);</span><br><span class="line">p2.add(t1);</span><br><span class="line">p2.add(l2);</span><br><span class="line">t2.setEditable(<span class="keyword">false</span>);<span class="comment">//t2不可编辑</span></span><br><span class="line">p2.add(t2);</span><br><span class="line"></span><br><span class="line">p3.setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>));</span><br><span class="line">p3.setBackground(Color.pink);</span><br><span class="line">b1.addActionListener(<span class="keyword">this</span>);</span><br><span class="line">b2.addActionListener(<span class="keyword">this</span>);<span class="comment">//添加监听器</span></span><br><span class="line">p3.add(b1);</span><br><span class="line">p3.add(b2);</span><br><span class="line"></span><br><span class="line">p0.add(<span class="string">"North"</span>, p1);</span><br><span class="line">p0.add(<span class="string">"Center"</span>, p2);</span><br><span class="line">p0.add(<span class="string">"South"</span>, p3);</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.setContentPane(p0);</span><br></pre></td></tr></table></figure>
<h2 id="5-事件处理"><a href="#5-事件处理" class="headerlink" title="5. 事件处理"></a>5. 事件处理</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ae.getSource()==b1)&#123;</span><br><span class="line">        t2.setText(<span class="string">""</span>+<span class="number">3.1415926</span>*Double.parseDouble(t1.getText())*Double.parseDouble(t1.getText()));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        t1.setText(<span class="string">""</span>);</span><br><span class="line">        t2.setText(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-代码优化"><a href="#6-代码优化" class="headerlink" title="6. 代码优化"></a>6. 代码优化</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JPanel []p = <span class="keyword">new</span> JPanel[<span class="number">4</span>];</span><br><span class="line">Color [] c = &#123;Color.red, Color.yellow, Color.green, Color.pink&#125;;</span><br><span class="line">LayoutManager [] lm = &#123; <span class="keyword">new</span> BorderLayout(<span class="number">5</span>,<span class="number">5</span>),</span><br><span class="line">                        <span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>),</span><br><span class="line">                        <span class="keyword">new</span> GridLayout(<span class="number">2</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">5</span>),</span><br><span class="line">                        <span class="keyword">new</span> FlowLayout(FlowLayout.CENTER, <span class="number">5</span>, <span class="number">5</span>)&#125;;</span><br><span class="line">String [] str = &#123;<span class="string">"圆面积计算系统"</span>, <span class="string">"请输入圆的半径："</span>, <span class="string">"圆的面积是："</span>&#125;;</span><br><span class="line"></span><br><span class="line">JLabel [] l = <span class="keyword">new</span> JLabel[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">JTextField [] t = <span class="keyword">new</span> JTextField [<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">String [] str1 = &#123;<span class="string">"计算"</span>, <span class="string">"清空"</span>&#125;;</span><br><span class="line"></span><br><span class="line">JButton [] b = <span class="keyword">new</span> JButton[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CircleArea</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; p.length;i++)&#123;</span><br><span class="line">        p[i] = <span class="keyword">new</span> JPanel(lm[i]);</span><br><span class="line">        p[i].setBackground(c[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; l.length;i++)&#123;</span><br><span class="line">        l[i] = <span class="keyword">new</span> JLabel(str[i], JLabel.CENTER);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; t.length;i++)&#123;</span><br><span class="line">        t[i] = <span class="keyword">new</span> JTextField(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; b.length;i++)&#123;</span><br><span class="line">        b[i] = <span class="keyword">new</span> JButton(str1[i]);</span><br><span class="line">        b[i].addActionListener(<span class="keyword">this</span>);</span><br><span class="line">        p[<span class="number">3</span>].add(b[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p[<span class="number">1</span>].add(l[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    p[<span class="number">2</span>].add(l[<span class="number">1</span>]);</span><br><span class="line">    p[<span class="number">2</span>].add(t[<span class="number">0</span>]);</span><br><span class="line">    p[<span class="number">2</span>].add(l[<span class="number">2</span>]);</span><br><span class="line">    t[<span class="number">1</span>].setEditable(<span class="keyword">false</span>);</span><br><span class="line">    p[<span class="number">2</span>].add(t[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    p[<span class="number">0</span>].add(<span class="string">"North"</span>, p[<span class="number">1</span>]);</span><br><span class="line">    p[<span class="number">0</span>].add(<span class="string">"Center"</span>, p[<span class="number">2</span>]);</span><br><span class="line">    p[<span class="number">0</span>].add(<span class="string">"South"</span>, p[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setContentPane(p[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-异常处理"><a href="#7-异常处理" class="headerlink" title="7. 异常处理"></a>7. 异常处理</h2><h3 id="7-1-throw"><a href="#7-1-throw" class="headerlink" title="7.1 throw"></a>7.1 throw</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ae.getSource()==b[<span class="number">0</span>])&#123;</span><br><span class="line">        area=String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span>*Double.parseDouble(t[<span class="number">0</span>].getText())*Double.parseDouble(t[<span class="number">0</span>].getText()));</span><br><span class="line">        t[<span class="number">1</span>].setText(area);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        t[<span class="number">0</span>].setText(<span class="string">""</span>);</span><br><span class="line">        t[<span class="number">1</span>].setText(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-2-try-catch"><a href="#7-2-try-catch" class="headerlink" title="7.2 try catch"></a>7.2 try catch</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ae.getSource()==b[<span class="number">0</span>])&#123;</span><br><span class="line">            area=String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span>*Double.parseDouble(t[<span class="number">0</span>].getText())*Double.parseDouble(t[<span class="number">0</span>].getText()));</span><br><span class="line">            t[<span class="number">1</span>].setText(area);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t[<span class="number">0</span>].setText(<span class="string">""</span>);</span><br><span class="line">            t[<span class="number">1</span>].setText(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (NumberFormatException nfe)&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</span><br><span class="line">                nfe.getMessage(),<span class="string">"异常消息"</span>,JOptionPane.ERROR_MESSAGE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-3-异常类"><a href="#7-3-异常类" class="headerlink" title="7.3 异常类"></a>7.3 异常类</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent ae)</span> <span class="keyword">throws</span> NumberFormatException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ae.getSource() == b[<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[<span class="number">0</span>].getText().equals(<span class="string">""</span>))&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> MyException(<span class="string">"半径不能为空，请重新输入！！！"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                area = String.format(<span class="string">"%5f"</span>, <span class="number">3.1415926</span> * Double.parseDouble(t[<span class="number">0</span>].getText()) * Double.parseDouble(t[<span class="number">0</span>].getText()));</span><br><span class="line">                t[<span class="number">1</span>].setText(area);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            t[<span class="number">0</span>].setText(<span class="string">""</span>);</span><br><span class="line">            t[<span class="number">1</span>].setText(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (MyException me) &#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</span><br><span class="line">                me.outExceMessage(), <span class="string">"异常消息"</span>, JOptionPane.ERROR_MESSAGE);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (NumberFormatException nfe)&#123;</span><br><span class="line">        JOptionPane.showMessageDialog(<span class="keyword">null</span>,</span><br><span class="line">                <span class="string">"输入不能为非数字，请重新输入"</span>, <span class="string">"异常消息"</span>, JOptionPane.ERROR_MESSAGE);</span><br><span class="line">        t[<span class="number">0</span>].setText(<span class="string">""</span>);</span><br><span class="line">        t[<span class="number">1</span>].setText(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyException</span> <span class="keyword">extends</span> <span class="title">NumberFormatException</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        str = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">outExceMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//类中类</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
  </entry>
  <entry>
    <title>可延迟负荷控制</title>
    <url>/2016/07/06/2016-07-06-%E5%8F%AF%E5%BB%B6%E8%BF%9F%E8%B4%9F%E8%8D%B7%E6%8E%A7%E5%88%B6/</url>
    <content><![CDATA[<h1 id="Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation"><a href="#Notes-of-Real-time-deferrable-load-control-handling-the-uncertainties-of-renewable-generation" class="headerlink" title="Notes of Real-time deferrable load control: handling the uncertainties of renewable generation"></a>Notes of <a href="http://conferences.sigcomm.org/eenergy/2013/papers/p10.pdf" target="_blank" rel="noopener">Real-time deferrable load control: handling the uncertainties of renewable generation</a></h1><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><ul>
<li>趋势：传统的煤炭、核能等发电能源逐渐被可再生能源所取代</li>
<li>可再生能源的不规律、不可预测性给控制带来了很多麻烦</li>
<li>需求响应：引导用户的动态电力负载需求管理与电力供应情况相匹配，可以弥补可再生能源的不确定性造成的影响</li>
<li><a href="http://fatelancer.top/2016/07/05/flexibility/#more" target="_blank" rel="noopener">deferrable load</a>：可以推迟一段时间再执行，可以通过推迟负荷时间来与可再生能源的供给匹配</li>
<li>要点：分散式直接负荷控制<a id="more"></a>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2></li>
</ul>
<p>提供了一个考虑未来时间段的负载与可再生能源状态预测的实时分布式可延迟负载控制算法</p>
<h1 id="建模"><a href="#建模" class="headerlink" title="建模"></a>建模</h1><p>给可延迟负载排了时间表</p>
<p>一个有限时间域里的离散时间模型（一天，十分钟为间隔）</p>
<h2 id="可再生能源与非可延迟负载"><a href="#可再生能源与非可延迟负载" class="headerlink" title="可再生能源与非可延迟负载"></a>可再生能源与非可延迟负载</h2><p>非可延时负载在低聚程度上很难有效预测<br>将可再生能源发电机与非可延时类负载聚合到一个进程——基础负载<br>是非可延迟负载与可再生能源之间的误差<br><strong>滤波器？</strong></p>
]]></content>
      <categories>
        <category>电气工程</category>
      </categories>
      <tags>
        <tag>deferrable load</tag>
        <tag>需求响应</tag>
        <tag>可再生能源</tag>
        <tag>柔性建模</tag>
        <tag>real-time</tag>
      </tags>
  </entry>
  <entry>
    <title>关于柔性建模</title>
    <url>/2016/07/05/2016-07-05-flexibility/</url>
    <content><![CDATA[<h1 id="智能电网柔性成分运行建模方法研究"><a href="#智能电网柔性成分运行建模方法研究" class="headerlink" title="智能电网柔性成分运行建模方法研究"></a>智能电网柔性成分运行建模方法研究</h1><p>研究可调负荷和储能的运行特性，并建立其运行模型；研究柔性成分与可再生能源联合运行方式；仿真模拟可调负荷和储能运行的减排效果，验证所建模型有效性。<br><a id="more"></a></p>
<ul>
<li>存在大量的DER（分布式能源），其潜在的供需调节能力尚未被完全开发和利用：<ul>
<li>电――化学类：钠硫电站、电动汽车、充换电站、气电转换。</li>
<li>电――热转换类: 空调、地暖、电热水器、蓄热、蓄冷、蓄冰等，调节特性受热力/耗散方程的约束。</li>
<li>纯电类需求响应：通过工作时间的调整响应电力波动，实现供需两侧之间的缓冲调节功能（类储能功能）。e.g:洗衣机、洗碗机、etc.</li>
</ul>
</li>
<li>基本描述：参与方申报可承受功率曲线范围、服务的最早开始时间和能量水平、最晚结束（完成）时间和能量水平、可承受价格范围、最大可中断次数等。云服务器端进行在线优化、实时结算和价格发布。</li>
<li>实现虚拟储能网的关键技术――1、设备间的统一通讯标准和规约、即插即识别即用、智能家居；2、电力传输网络的建模，阻塞与网损管理；3、有效的电价信号、激励机制和商业模式；4、对设备和其拥有者信息的有效保护。</li>
<li>研究内容：1、DER的统一建模；2、电力传输网络的建模；3、信息安全；4、电价设计；5、实施效果的检验与仿真；6、现场测试。</li>
<li>项目成效及应用前景：1、调峰效果；2、延缓输配电系统投资的效果（线路、变压器、线路）；3、运行效益（网损、运维、检修灵活性）；4、促进随机间歇性可再生能源消纳与碳减排效果；5、社会效益。</li>
</ul>
]]></content>
      <categories>
        <category>电气工程</category>
      </categories>
      <tags>
        <tag>柔性建模</tag>
        <tag>配电网</tag>
        <tag>优化</tag>
      </tags>
  </entry>
  <entry>
    <title>notes</title>
    <url>/2016/07/05/notes/</url>
    <content><![CDATA[<p> Notes about <a href="http://ieor.berkeley.edu/~oren/pubs/No113.pdf" target="_blank" rel="noopener">Large-scale integration of deferrable demand and renewable energy sources</a></p>
<h1 id="ABSTRACT"><a href="#ABSTRACT" class="headerlink" title="ABSTRACT"></a>ABSTRACT</h1><blockquote>
<ul>
<li><a href="http://s3.amazonaws.com/academia.edu.documents/42998787/A_Stochastic_Unit-commitment_Model_for_t20160223-1673-5tjopb.pdf?AWSAccessKeyId=AKIAJ56TQJRTWSMTNPEA&amp;Expires=1467280071&amp;Signature=12zFdv9seJSAEfV1OBP2emAFj9I%3D&amp;response-content-disposition=inline%3B%20filename%3DA_stochastic_unit-commitment_model_for_t.pdf" target="_blank" rel="noopener">stochastic unit commitment model</a> 随机机组组合模型  <strong>？</strong></li>
<li>[ ]deferrable demand in power system 电力系统中的可暂缓需求<strong>（可调性需求？）</strong></li>
<li>[x]reserve requirements 储能需求</li>
<li>[ ]the benefits of demand flexibility 需求弹性收益 <strong>？</strong></li>
<li><p>[x]three demand response paradigms 三个需求响应的样例</p>
<blockquote>
<ul>
<li>[ ]the centralized co-optimization of generation 发电的集中联合优化 <strong>？</strong></li>
<li>[x]demand by the system operator, demand bids 来自于系统操作人员和订单的需求</li>
<li>[ ]the coupling of renewable resources with deferrable loads 可再生能源与可调性负载的耦合 <strong>？</strong></li>
</ul>
</blockquote>
</li>
<li><p>[ ]motivate coupling as an alternative for overcoming the drawbacks of the two alternative demand response options 将耦合作为克服另外两个需求响应缺点的替代选项</p>
</li>
<li>[x]a dynamic programming algorithm for coordinating deferrable demand with renewable supply 一个用于协调可调性需求与可再生能源供给的动态算法</li>
<li>[ ]simulation results for a model of the <a href="https://www.wecc.biz/Pages/home.aspx" target="_blank" rel="noopener">Western Electricity Coordinating Council</a> 关于<a href="https://en.wikipedia.org/wiki/Western_Electricity_Coordinating_Council" target="_blank" rel="noopener">西部电力协调理事会</a>的模型仿真结果</li>
<li>[ ]load management 负载管理</li>
<li>[ ]power generation scheduling 电力发电规划</li>
<li>[ ]wind power generation 风力发电</li>
</ul>
</blockquote>
<hr>
<a id="more"></a>
<h1 id="INTRODUCTION"><a href="#INTRODUCTION" class="headerlink" title="INTRODUCTION"></a>INTRODUCTION</h1><blockquote>
<ul>
<li>high variability, unpredictable fluctuation, a limited control of output<br>与传统发电方式相比，可再生能源的关键缺陷在于它的高变化性，波动不可预测和输出仅在有限范围内可控</li>
<li>demand response<br>需求响应对于大规模的可再生能源是很有好处的</li>
<li>represent the balancing operations of the remaining grid by using a unit commitment model<br>用一个机组组合模型来表示当前电网的平衡措施来评估可再生能源与需求响应的影响</li>
<li>doesn’t model the deferrable nature of various of various demand response or account for the uncertainty that is introduced by the large-scale integration of renewable resources<br>以往这个领域的研究没有就变化的需求响应的可调性特征建模，也没有考虑由大规模可再生能源导致的不确定性</li>
<li>economic dispatch model<br>经济调度模型</li>
<li>explore the direct coupling of deferrable consumers with renewable resources into a virtual resource through a contractual agreement based on a strike price that limits the impact of the coupled system on the rest of the network<br>探索了在限制耦合系统对于网络其他部分的影响的成交价下将可调性负载与可再生能源直接耦合接入虚拟。。。（不是很懂）</li>
</ul>
</blockquote>
<h2 id="Literature-Review"><a href="#Literature-Review" class="headerlink" title="Literature Review"></a>Literature Review</h2><blockquote>
<ul>
<li>high investment cost of backup reserves<br>后备储能设施的投入来保证系统的可靠操作</li>
<li>quantifying reserve requirements as well as the impacts of renewable integration on operating costs<br>定量储藏要求和可再生能源对于运行损耗的影响</li>
<li>impact of renewable supply uncertainty on power system operations (focus)<br>可再生能源供应的不确定性对电力系统操作的影响</li>
<li>the potential benefits of demand response integration<br>一体化需求响应的潜在好处 <strong>？</strong></li>
<li>demand function<br>需求函数</li>
<li>However, many flexible consumption tasks are best characterized as deferrable, in the sense that consumers need a certain amount of energy within a certain time window. As such, deferrable demand behaves much like a hydro or storage resource from the view point of the system operator. Electric vehicle charging, agricultural pumping, pre-cooling, and residential consumption such as laundry fit this characterization.<br><strong>为什么更像一个水电或者储存？农业泵，洗衣机为什么相似？</strong></li>
<li>real-time pricing at the retail level<br>需要实时电价</li>
<li>volatility of wholesale electricity prices<br>批发电价的波动性</li>
<li>the <a href="https://en.wikipedia.org/wiki/Non-convexity_(economics" target="_blank" rel="noopener">non-convex</a>) costs of system operations<br>实时电价由于系统运行中的非凸成本（有绝对的需求时）不能表达出需求响应的经济价值      <strong>为什么是非凸的？</strong></li>
<li>excessive startup and minimum load costs<br>上述问题会导致过多的启动和最小负载成本</li>
<li>the system operator dispatches the system at a bulk scale and cannot control individual retail loads<br>只能在大规模上，不能分布式</li>
<li>concerns about defining market products that correspond to the types of services that loads can actually offer, which raises the need for reform in existing electricity markets<br>需要对现有市场进行改革</li>
</ul>
</blockquote>
<h2 id="Paper-Contributions"><a href="#Paper-Contributions" class="headerlink" title="Paper Contributions"></a>Paper Contributions</h2><blockquote>
<ul>
<li><strong>a stochastic unit commitment model that can be used in order to quantify the benefits of deferrable demand in mitigating the increased operating costs and day-ahead reserve requirements resulting from the random fluctuation of renewable energy supply</strong><br>一个可以用来量化可延缓需求在减少增长的运行损耗和由于可再生能源的随机波动导致的提前一天的存储需求</li>
<li>The use of stochastic planning models for simulating long-term market equilibrium in order to quantify generation investment in the face of long-term uncertainty<br>用随机规划模型来模拟长期市场均衡以用来量化面对长期不确定性情况下的发电投资</li>
<li>used in order to simulate the two-stage operation of day-ahead and real-time electricity markets<br>用来模拟提前一天的二阶操作和实时的电力市场</li>
<li>computational challenges</li>
<li>using an appropriate scenario selection technique to discretize the uncertainty space of the <a href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=4806110" target="_blank" rel="noopener">problem</a></li>
<li><strong>extend existing models by simultaneously modeling the inter-temporal dependency of deferrable demand and renewable supply uncertainty</strong><br>跨时间段的依赖关系和可再生能源供给的随机性</li>
<li>present a contractual alternative for coupling the operations of renewable resources with deferrable demand that attempts to overcome the implementation barriers associated with centralized load dispatch and real-time pricing of retail loads, and compare the relative performance of each demand response paradigm in terms of system operating costs<br>展现了一个（（具备试图克服执行障碍和集中负载调度的可调需求的可再生资源的操作）与（基于零售负载的实时电价的耦合））的基于合同的替代选项，并且比较了在系统运行损耗中各个不同的需求响应模式的表现</li>
</ul>
</blockquote>
<hr>
<h1 id="MODEL-OVERVIEW"><a href="#MODEL-OVERVIEW" class="headerlink" title="MODEL OVERVIEW"></a>MODEL OVERVIEW</h1><blockquote>
<ul>
<li>Uncertainty in the model is driven by renewable supply and demand.</li>
<li>Demand resources in the system are categorized as inflexible (firm) consumers with stochastic consumption patterns and deferrable consumers that require a fixed amount of energy within the day and adapt their instantaneous consumption patterns to the prevailing system conditions.<br>把需求分为了两类，一类是固定用户，消耗模式随机，另一类是可调用户，需求固定，消耗模式适配到系统即时状态</li>
<li>The decision support module in the upper portion of the figure simulates day-ahead market operations and is used for determining day-ahead reserve requirements when deferrable demand contributes to absorbing the variability of renewable energy supply</li>
<li>The evaluation module in the lower portion of the figure uses the reserves committed by the day-ahead model in order to compare the real-time operating costs of the system under the three demand response paradigms that are discussed in the introduction of the paper.</li>
</ul>
</blockquote>
<h2 id="Statistical-Models"><a href="#Statistical-Models" class="headerlink" title="Statistical Models"></a>Statistical Models</h2><blockquote>
<ul>
<li>We use a second order autoregressive model for modeling demand and load.<br><a href="http://baike.baidu.com/link?url=0DvVl_b1tAPmWB1whlIPgAen-oIVPTw8beF-jQWMYxU5ajNrdJ_5a5x67zbcw3XoMMPr6oWcc_I-AKD76T-Ev_" target="_blank" rel="noopener">二阶自回归模型</a>用来模拟需求和负载</li>
<li>固定需求与可再生能源产出是相互独立的（assumption）</li>
<li>employ a data set published by NREL which provides time series of wind speed at various geographic locations over a year</li>
<li><a href="https://en.wikipedia.org/wiki/Walker_circulation#Yule-Walker_equations" target="_blank" rel="noopener">Yule-Walker equations</a><br><img src="./1467355871705.png" alt="Probability distribution function of inflexible demand.|center|500x0"><br>Probability distribution function of inflexible demand</li>
<li>In the present analysis we use a single-area wind model and ignore transmission constraints in order to focus on the impact of demand response.<br>在现在的分析中，我们使用了单个区域的风力模型并且为了集中于需求响应忽略了传递约束 （没做多个区域和考虑传递约束的）</li>
<li>The problem of balancing the schedules of coupled resources with the rest of the system while respecting transmission constraints would be addressed by the system operator and would be reflected in locational marginal prices from the point of view of aggregators.<br>在考虑传递约束的情况下，平衡耦合资源规划与系统其他部分的问题会有系统操作员来解决，并且从聚合的角度来看 <strong>？</strong>，这个结果会反映在节点边际电价上</li>
<li>the aggregator can hedge by buying financial transmission rights<br><strong>？</strong> 购买输电权。。对冲</li>
</ul>
</blockquote>
<h2 id="Stochastic-Unit-Commitment"><a href="#Stochastic-Unit-Commitment" class="headerlink" title="Stochastic Unit Commitment"></a>Stochastic Unit Commitment</h2><blockquote>
<ul>
<li>assumes that the system operator co-optimizes the dispatch of flexible loads and generation resources<br>假设系统操作员可以同时协调控制柔性负载与发电资源</li>
<li>two-stage decision model where the first stage represents day-ahead unit commitment and the second stage represents real-time economic dispatch in the hour-ahead market, in hourly intervals, subsequent to the realization of uncertainty<br>一个第一阶段表示日超前机组组合模型第二阶段表示由于不确定性的实现因而以一小时为间隔的时超前市场上的实时经济调度的二阶决策模型</li>
<li>操作员每小时能够计算出模型结果是基础</li>
</ul>
</blockquote>
<p><img src="/images/1.png" alt=""></p>
<blockquote>
<p><script type="math/tex">S</script>　　a discrete set of scenarios</p>
<p><script type="math/tex">G</script>　　set of gengrators</p>
<p><script type="math/tex">G_s</script>　　set of slow generators which commitment decisions are fixed in the day-ahead time frame <script type="math/tex">G_s\in G</script>, another part are fast generators that can adjust their commitment schedule in the second stage</p>
<p><script type="math/tex">w_{gt}</script>　　First-stage decisions</p>
<p><script type="math/tex">z_{gt}</script>　the binary unit commitment and startup decisions for slow generators</p>
<p><script type="math/tex">u_{gst}</script>　　the unit commitment of all generators</p>
<p><script type="math/tex">v_{gst}</script>　startup of all generators</p>
<p><script type="math/tex">p_{gst}</script>　　power output of all generators</p>
<p><script type="math/tex">e_{st}</script>　　The dispatch of deferrable loads (a second-stage decision variable)</p>
<p><script type="math/tex">S_{g}</script>　　startup cost for each generator</p>
<p><script type="math/tex">K_g</script>　　minimun load costs for each generator</p>
<p><script type="math/tex">C_g</script>　　constant fuel costs for each generator</p>
<p><script type="math/tex">D_{st}</script>　　net demand (the net of firm demand minus renewable power supply, represents the source of uncertainty)</p>
<p><script type="math/tex">\mathcal{D}</script>　　includes generator capacity constraints, ramping constraints, and minimum up and down times, where bold fonts indicate vectors.</p>
<ul>
<li>The objective function of (1) minimizes operating costs.</li>
<li>Power balance is enforced in (2).</li>
<li>The constraint of (3) requires that deferrable loads be supplied an amount of energy within a given time window.</li>
<li>(4) enforces a limit of on the consumption (e.g., charge) rate of deferrable loads.</li>
<li>The non-anticipativity constraints on first-stage decisions is enforced in (5).</li>
<li><strong>all generators, including slow units, can adjust their production level in the second stage</strong></li>
<li>The solution of the stochastic unit commitment model is described in detail by <a href="https://perso.uclouvain.be/anthony.papavasiliou/public_html/uctestV3.pdf" target="_blank" rel="noopener">Papavasiliou [37]</a></li>
</ul>
</blockquote>
<hr>
<blockquote>
<p>About scenario selection algorithm</p>
<ul>
<li>scenarios are selected according to their effect on expected cost and weighed such that their selection does not bias the objective function of the stochastic unit commitment formulation<br>场景是根据他们各自对于期望损耗的效果来权衡保证选择与随机机组组合模型的目标函数无关</li>
<li>The decomposition algorithm which is employed relies on a Lagrangian relaxation scheme for scenario decomposition.<br>分解算法基于<a href="http://baike.baidu.com/link?url=vzPK82hLesPPe4MA_lGK1bcpHJDPaelhQf4B3T_geYEJM1_WCUh7oQPo4r34y1it7ZDY56U_fE3Kh1FhlYGai_" target="_blank" rel="noopener">拉格朗日松弛算法</a></li>
<li>The centralized stochastic unit commitment model presented in this section presumes the ability of the system operator to centrally monitor and control individual loads.</li>
</ul>
</blockquote>
]]></content>
      <categories>
        <category>电气工程</category>
      </categories>
      <tags>
        <tag>可再生能源</tag>
        <tag>柔性建模</tag>
        <tag>deferrable</tag>
        <tag>机组组合</tag>
      </tags>
  </entry>
</search>
